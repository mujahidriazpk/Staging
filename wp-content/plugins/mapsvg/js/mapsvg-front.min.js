var MapSVG={};window.MapSVG=MapSVG,MapSVG.templatesLoaded={},MapSVG.urls=mapsvg_paths,"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),Math.hypot=Math.hypot||function(){for(var t=0,a=arguments.length,e=0;e<a;e++){if(arguments[e]===1/0||arguments[e]===-1/0)return 1/0;t+=arguments[e]*arguments[e]}return Math.sqrt(t)},SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(t){return t.getScreenCTM().inverse().multiply(this.getScreenCTM())},function($,window,MapSVG,Math){MapSVG.ResizeSensor=function(t,a){var e=this;e.element=t,e.callback=a;var o=parseInt(getComputedStyle(t));isNaN(o)&&(o=0),o--,e.expand=document.createElement("div"),e.expand.style.position="absolute",e.expand.style.left="0px",e.expand.style.top="0px",e.expand.style.right="0px",e.expand.style.bottom="0px",e.expand.style.overflow="hidden",e.expand.style.zIndex=o,e.expand.style.visibility="hidden";var i=document.createElement("div");i.style.position="absolute",i.style.left="0px",i.style.top="0px",i.style.width="10000000px",i.style.height="10000000px",e.expand.appendChild(i),e.shrink=document.createElement("div"),e.shrink.style.position="absolute",e.shrink.style.left="0px",e.shrink.style.top="0px",e.shrink.style.right="0px",e.shrink.style.bottom="0px",e.shrink.style.overflow="hidden",e.shrink.style.zIndex=o,e.shrink.style.visibility="hidden";var s=document.createElement("div");s.style.position="absolute",s.style.left="0px",s.style.top="0px",s.style.width="200%",s.style.height="200%",e.shrink.appendChild(s),e.element.appendChild(e.expand),e.element.appendChild(e.shrink);var n=t.getBoundingClientRect();e.currentWidth=n.width,e.currentHeight=n.height,e.setScroll(),e.expand.addEventListener("scroll",function(){e.onScroll()}),e.shrink.addEventListener("scroll",function(){e.onScroll()})},MapSVG.ResizeSensor.prototype.onScroll=function(){var t=this,a=t.element.getBoundingClientRect(),e=a.width,o=a.height;e==t.currentWidth&&o==t.currentHeight||(t.currentWidth=e,t.currentHeight=o,t.callback()),this.setScroll()},MapSVG.ResizeSensor.prototype.setScroll=function(){this.expand.scrollLeft=1e7,this.expand.scrollTop=1e7,this.shrink.scrollLeft=1e7,this.shrink.scrollTop=1e7},MapSVG.ResizeSensor.prototype.destroy=function(){this.expand.remove(),this.shrink.remove()},MapSVG.userAgent=navigator.userAgent.toLowerCase(),MapSVG.touchDevice=-1<MapSVG.userAgent.indexOf("ipad")||-1<MapSVG.userAgent.indexOf("iphone")||-1<MapSVG.userAgent.indexOf("ipod")||-1<MapSVG.userAgent.indexOf("android"),MapSVG.ios=-1<MapSVG.userAgent.indexOf("ipad")||-1<MapSVG.userAgent.indexOf("iphone")||-1<MapSVG.userAgent.indexOf("ipod"),MapSVG.android=MapSVG.userAgent.indexOf("android"),MapSVG.isPhone=window.matchMedia("only screen and (max-width: 812px)").matches,MapSVG.browser={},MapSVG.browser.ie=(-1<MapSVG.userAgent.indexOf("msie")||-1<MapSVG.userAgent.indexOf("trident")||-1<MapSVG.userAgent.indexOf("edge"))&&{},MapSVG.browser.firefox=-1<MapSVG.userAgent.indexOf("firefox"),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),MapSVG.mouseCoords=function(t){return t.clientX?{x:t.clientX+$(document).scrollLeft(),y:t.clientY+$(document).scrollTop()}:t.pageX?{x:t.pageX,y:t.pageY}:MapSVG.touchDevice?(t=t.originalEvent||t).touches&&t.touches[0]?{x:t.touches[0].pageX,y:t.touches[0].pageY}:{x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY}:void 0},MapSVG.get=function(t){return jQuery(".mapsvg").eq(t).mapSvg()},MapSVG.getById=function(t){for(var a=jQuery(".mapsvg").length,e=0;e<a;e++){var o=MapSVG.get(e);if(o.id==t)return o}},MapSVG.extend=function(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t},MapSVG.ucfirst=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},MapSVG.parseBoolean=function(t){switch(String(t).toLowerCase()){case"on":case"true":case"1":case"yes":case"y":return!0;case"off":case"false":case"0":case"no":case"n":return!1;default:return}},MapSVG.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},MapSVG.safeURL=function(t){return 0!=t.indexOf("http://")&&0!=t.indexOf("https://")||(t="//"+t.split("://").pop()),t.replace(/^.*\/\/[^\/]+/,"")},MapSVG.convertToText=function(t){var a=[];if(null==t)return String(t);if("object"==typeof t&&null==t.join){for(o in t)if(t.hasOwnProperty(o)){var e=-1===o.search(/[^a-zA-Z]+/)?o:'"'+o.replace(/\"/g,'\\"')+'"';a.push(e+": "+MapSVG.convertToText(t[o]))}return"{"+a.join(",")+"}"}if("object"==typeof t&&null!=t.join){var o;for(o in t)a.push(MapSVG.convertToText(t[o]));return"["+a.join(",")+"]"}if("function"==typeof t)a.push(t.toString().replace("function anonymous","function"));else{var i=JSON.stringify(t);a.push(i)}return a.join(",")},MapSVG.Controller=function(t){if(this.container=t.container,this.mapsvg=t.mapsvg,this.template=t.template,this.scrollable=void 0===t.scrollable||t.scrollable,this.withToolbar=void 0===t.withToolbar||t.withToolbar,this.autoresize=MapSVG.parseBoolean(t.autoresize),this.templates={toolbar:Handlebars.compile(this.getToolbarTemplate()),main:this.getMainTemplate()},this.data=t.data,this.width=t.width,this.color=t.color,this.events={},t.events)for(var a in t.events)"function"==typeof t.events[a]&&(this.events[a]=t.events[a]);this._init()},MapSVG.Controller.prototype.viewDidLoad=function(){this.updateScroll(),this.autoresize&&(this.adjustHeight(),this.resizeSensor.setScroll())},MapSVG.Controller.prototype.viewDidAppear=function(){},MapSVG.Controller.prototype.viewDidDisappear=function(){},MapSVG.Controller.prototype._viewDidLoad=function(){this.updateScroll()},MapSVG.Controller.prototype.updateScroll=function(){if(this.scrollable){var t=this;this.contentWrap.nanoScroller({preventPageScrolling:!0,iOSNativeScrolling:!0}),setTimeout(function(){t.contentWrap.nanoScroller({preventPageScrolling:!0,iOSNativeScrolling:!0})},300)}},MapSVG.Controller.prototype.adjustHeight=function(){var t=this;t.container.height(t.container.find(".mapsvg-auto-height").outerHeight()+(t.toolbarView?t.toolbarView.outerHeight():0))},MapSVG.Controller.prototype.init=function(){},MapSVG.Controller.prototype._init=function(){this.render(),this.init()},MapSVG.Controller.prototype.getToolbarTemplate=function(){return""},MapSVG.Controller.prototype.getMainTemplate=function(){return this.template},MapSVG.Controller.prototype.render=function(){var t=this;this.view=$("<div />").attr("id","mapsvg-controller-"+this.name).addClass("mapsvg-controller-view"),this.contentWrap=$("<div />").addClass("mapsvg-controller-view-wrap"),this.contentWrap2=$("<div />"),this.contentSizer=$("<div />").addClass("mapsvg-auto-height"),this.contentView=$("<div />").addClass("mapsvg-controller-view-content"),this.contentSizer.append(this.contentView),this.scrollable&&(this.contentWrap.addClass("nano"),this.contentWrap2.addClass("nano-content")),this.contentWrap.append(this.contentWrap2),this.contentWrap2.append(this.contentSizer),this.withToolbar&&this.templates.toolbar&&(this.toolbarView=$("<div />").addClass("mapsvg-controller-view-toolbar"),this.view.append(this.toolbarView)),this.view.append(this.contentWrap),this.container.append(this.view),this.container.data("controller",this),this.width&&this.view.css({width:this.width}),this.color&&this.view.css({"background-color":this.color}),t.viewReadyToFill(),this.redraw(),setTimeout(function(){t._viewDidLoad(),t.viewDidLoad(),t.setEventHandlersCommon(),t.setEventHandlers()},1)},MapSVG.Controller.prototype.viewReadyToFill=function(){var t=this;t.autoresize&&(t.resizeSensor=new MapSVG.ResizeSensor(this.contentSizer[0],function(){t.adjustHeight(),t.updateScroll(),t.events.resize&&t.events.resize.call(t,t.mapsvg)}))},MapSVG.Controller.prototype.redraw=function(){this.contentView.html(this.templates.main(this.data)),this.withToolbar&&this.templates.toolbar&&this.toolbarView.html(this.templates.toolbar(this.data)),this.updateTopShift(),this.noPadding&&this.contentView.css({padding:0}),this.updateScroll()},MapSVG.Controller.prototype.updateTopShift=function(){var t=this;this.withToolbar&&(t.contentWrap.css({top:t.toolbarView.outerHeight(!0)+"px"}),setTimeout(function(){t.contentWrap.css({top:t.toolbarView.outerHeight(!0)+"px"})},100),setTimeout(function(){t.contentWrap.css({top:t.toolbarView.outerHeight(!0)+"px"})},200),setTimeout(function(){t.contentWrap.css({top:t.toolbarView.outerHeight(!0)+"px"})},500))},MapSVG.Controller.prototype.setEventHandlersCommon=function(){},MapSVG.Controller.prototype.setEventHandlers=function(){},MapSVG.Controller.prototype.destroy=function(){this.view.empty().remove(),this.resizeSensor&&this.resizeSensor.destroy()},MapSVG.DirectoryController=function(t){this.database=t.database,this.noPadding=!0,this.position=t.position,this.search=t.search,this.filters=t.filters,MapSVG.Controller.call(this,t)},MapSVG.extend(MapSVG.DirectoryController,MapSVG.Controller),MapSVG.DirectoryController.prototype.getToolbarTemplate=function(){return'<div class="mapsvg-directory-filter-wrap filter-wrap"></div>',"</div>","</div>",'<div class="mapsvg-directory-search-wrap"><div class="mapsvg-directory-filter-wrap filter-wrap"></div></div></div>'},MapSVG.DirectoryController.prototype.viewDidLoad=function(){this.menuBtn=$('<div class="mapsvg-button-menu"><i class="mapsvg-icon-menu"></i> '+this.mapsvg.getData().options.mobileView.labelList+"</div>"),this.mapBtn=$('<div class="mapsvg-button-map"><i class="mapsvg-icon-map"></i> '+this.mapsvg.getData().options.mobileView.labelMap+"</div>"),MapSVG.isPhone&&("map"==this.mapsvg.getData().options.menu.showFirst?this.toggle(!1):this.toggle(!0)),this.mobileButtons=$('<div class="mapsvg-mobile-buttons"></div>'),this.mobileButtons.append(this.menuBtn,this.mapBtn),!1!==this.mapsvg.getData().options.menu.on&&this.mobileButtons.appendTo(this.mapsvg.getData().$wrapAll),this.events&&this.events.shown&&this.events.shown.call(this.view)},MapSVG.DirectoryController.prototype.setEventHandlers=function(){var _this=this,_data=_this.mapsvg.getData();$(window).on("resize",function(){_this.updateTopShift()}),this.menuBtn.on("click",function(){_this.toggle(!0)}),this.mapBtn.on("click",function(){_this.toggle(!1)}),this.view.on("click.menu.mapsvg",".mapsvg-directory-item",function(e){e.preventDefault();var objID=$(this).data("object-id"),regions,marker,detailsViewObject,eventObject,skipPopover;if(_this.deselectItems(),_this.selectItems(objID),MapSVG.isPhone&&_this.mapsvg.getData().options.menu.showMapOnClick&&_this.toggle(!1),"regions"==_this.mapsvg.getData().options.menu.source?(regions=[_this.mapsvg.getRegion(objID)],eventObject=regions[0],detailsViewObject=regions[0]):(detailsViewObject=_this.database.getLoadedObject(objID),eventObject=detailsViewObject,detailsViewObject.regions&&(regions=detailsViewObject.regions.map(function(t){return _this.mapsvg.getRegion(t.id)}))),detailsViewObject.location&&detailsViewObject.location.marker&&(marker=detailsViewObject.location.marker),_this.mapsvg.getData().options.actions.directoryItem.click.showDetails&&_this.mapsvg.loadDetailsView(detailsViewObject),regions&&0<regions.length&&(_this.mapsvg.getData().options.actions.directoryItem.click.zoom&&_this.mapsvg.zoomTo(regions,_this.mapsvg.getData().options.actions.directoryItem.click.zoomToLevel),1<regions.length&&_this.mapsvg.setMultiSelect(!0),regions.forEach(function(t){var a=t.getCenter();if(e.clientX=a[0],e.clientY=a[1],_this.mapsvg.getData().options.actions.directoryItem.click.selectRegion&&_this.mapsvg.selectRegion(t,!0),_this.mapsvg.getData().options.actions.directoryItem.click.showRegionPopover&&_this.mapsvg.showPopover(t),_this.mapsvg.getData().options.actions.directoryItem.click.fireRegionOnClick){var o=_this.mapsvg.getData().events;o&&o["click.region"]&&o&&o["click.region"].call(t,e,_this.mapsvg)}}),1<regions.length&&_this.mapsvg.setMultiSelect(!1,!1)),marker&&(_this.mapsvg.getData().options.actions.directoryItem.click.showMarkerPopover&&_this.mapsvg.showPopover(detailsViewObject),_this.mapsvg.getData().options.actions.directoryItem.click.fireMarkerOnClick)){var events=_this.mapsvg.getData().events;events&&events["click.marker"]&&events&&events["click.marker"].call(marker,e,_this.mapsvg)}_this.events.click&&_this.events.click.call($(this),e,eventObject,_this.mapsvg);var actions=_this.mapsvg.getData().options.actions;if(actions.directoryItem.click.goToLink){var linkParts=actions.directoryItem.click.linkField.split("."),url;if(1<linkParts.length){var obj=linkParts.shift(),attr="."+linkParts.join(".");if("Region"==obj?regions[0]&&regions[0].data&&(url=eval("regions[0].data"+attr)):detailsViewObject&&(url=eval("detailsViewObject"+attr)),url)if(actions.directoryItem.click.newTab){var win=window.open(url,"_blank");win.focus()}else window.location.href=url}}if(actions.directoryItem.click.showAnotherMap){if(_data.editMode)return alert('"Show another map" functionality is disabled in the preview'),!0;var linkParts=actions.directoryItem.click.showAnotherMapField.split("."),url;if(1<linkParts.length){var obj=linkParts.shift(),attr="."+linkParts.join("."),map_id;if("Region"==obj?regions[0]&&regions[0].data&&(map_id=eval("regions[0].data"+attr)):detailsViewObject&&(map_id=eval("detailsViewObject"+attr)),map_id){var container=MapSVG.parseBoolean(actions.directoryItem.click.showAnotherMapSameContainer)?_data.$map:$("#"+actions.directoryItem.click.showAnotherMapContainerId);jQuery.get(ajaxurl,{action:"mapsvg_get",id:map_id},function(data){container.find("svg").length&&container.mapSvg().destroy(),eval("var options = "+data),container.mapSvg(options)})}}}}).on("mouseover.menu.mapsvg",".mapsvg-directory-item",function(a){var t,e,o,i=$(this).data("object-id");"regions"==_this.mapsvg.getData().options.menu.source?(o=(t=[_this.mapsvg.getRegion(i)])[0],e=t[0]):(o=e=_this.database.getLoadedObject(i)).regions&&(t=e.regions.map(function(t){return _this.mapsvg.getRegion(t.id)})),t&&t.length&&(_this.mapsvg.highlightRegions(t),t.forEach(function(t){t&&!t.disabled&&_this.mapsvg.getData().options.mouseOver&&_this.mapsvg.getData().options.mouseOver.call(t,a,_this)})),_this.events.mouseover&&_this.events.mouseover.call($(this),a,o,_this.mapsvg)}).on("mouseout.menu.mapsvg",".mapsvg-directory-item",function(a){var t,e,o,i=$(this).data("object-id");"regions"==_this.mapsvg.getData().options.menu.source?(o=(t=[_this.mapsvg.getRegion(i)])[0],e=t[0]):(o=e=_this.database.getLoadedObject(i)).regions&&(t=e.regions.map(function(t){return _this.mapsvg.getRegion(t.id)})),t&&t.length&&(_this.mapsvg.unhighlightRegions(t),t.forEach(function(t){t&&!t.disabled&&_this.mapsvg.getData().options.mouseOut&&_this.mapsvg.getData().options.mouseOut.call(t,a,_this)})),_this.events.mouseout&&_this.events.mouseout.call($(this),a,o,_this.mapsvg)}).on("click.menu.mapsvg",".mapsvg-filter-delete",function(t){var a=$(this).data("filter");_this.database.query.filters[a]=null,delete _this.database.query.filters[a],_this.mapsvg.deselectAllRegions(),_this.mapsvg.loadDataObjects()})},MapSVG.DirectoryController.prototype.highlightItems=function(t){var a=this;"object"!=typeof t&&(t=[t]),t.forEach(function(t){a.view.find("#mapsvg-directory-item-"+t).addClass("hover")})},MapSVG.DirectoryController.prototype.unhighlightItems=function(){this.view.find(".mapsvg-directory-item").removeClass("hover")},MapSVG.DirectoryController.prototype.selectItems=function(t){var a=this;"object"!=typeof t&&(t=[t]),t.forEach(function(t){a.view.find("#mapsvg-directory-item-"+t).addClass("selected")})},MapSVG.DirectoryController.prototype.deselectItems=function(){this.view.find(".mapsvg-directory-item").removeClass("selected")},MapSVG.DirectoryController.prototype.addFilter=function(t){this.database.getSchema()},MapSVG.DirectoryController.prototype.loadItemsToDirectory=function(){var t,o=this;if(t=this.database.getLoaded(),"regions"==this.database.table){var i={};o.mapsvg.getData().options.menu.filterout.field&&(i.field=o.mapsvg.getData().options.menu.filterout.field,i.val=o.mapsvg.getData().options.menu.filterout.val),t=t.filter(function(t){var a=!0,e=o.mapsvg.getData().options.regionStatuses;return e[t.status]&&(a=!e[t.status].disabled),a&&i.field&&(a=t[i.field]!=i.val),a})}this.contentView.html(this.templates.main({items:t})),0==t.length&&this.contentView.html('<div class="mapsvg-no-results">'+this.mapsvg.getData().options.menu.noResultsText+"</div>"),this.setFilters(),this.updateScroll()},MapSVG.DirectoryController.prototype.getRegion=function(t){var a;if("regions"==this.mapsvg.getData().options.menu.source)a=this.mapsvg.getRegion(t);else{var e=this.database.getLoadedObject(t);e.region_id&&(a=this.mapsvg.getRegion(e.region_id))}return a},MapSVG.DirectoryController.prototype.setFilters=function(){this.updateTopShift()},MapSVG.DirectoryController.prototype.toggle=function(t){var a=this;t?(this.container.parent().show(),a.mapsvg.getData().$mapContainer.hide(),this.menuBtn.addClass("active"),this.mapBtn.removeClass("active")):(this.container.parent().hide(),a.mapsvg.getData().$mapContainer.show(),this.menuBtn.removeClass("active"),this.mapBtn.addClass("active")),this.container.parent().is(":visible")?MapSVG.isPhone&&this.container.height()<parseInt(this.mapsvg.getData().options.menu.minHeight)&&(a.mapsvg.getData().$wrap.css("height",parseInt(this.mapsvg.getData().options.menu.minHeight)+"px"),a.updateScroll()):MapSVG.isPhone&&(a.mapsvg.getData().$wrap.css("height","auto"),a.updateScroll()),this.updateTopShift()},MapSVG.DirectoryController.prototype.addPagination=function(t){this.contentView.append('<div class="mapsvg-pagination-container"></div>'),this.contentView.find(".mapsvg-pagination-container").html(t)},MapSVG.DetailsController=function(t){MapSVG.Controller.call(this,t),this.modal=t.modal},MapSVG.extend(MapSVG.DetailsController,MapSVG.Controller),MapSVG.DetailsController.prototype.getToolbarTemplate=function(){return this.withToolbar?'<div class="mapsvg-popover-close mapsvg-details-close"></div>':""},MapSVG.DetailsController.prototype.init=function(){},MapSVG.DetailsController.prototype.viewDidLoad=function(){this.events&&this.events.shown&&this.events.shown.call(this,this.mapsvg),this.modal&&(this.mobileCloseBtn=$('<button class="mapsvg-mobile-modal-close mapsvg-btn">'+this.mapsvg.getData().options.mobileView.labelClose+"</button>"),this.view.append(this.mobileCloseBtn))},MapSVG.DetailsController.prototype.setEventHandlers=function(){var a=this;this.view.on("click",".mapsvg-popover-close, .mapsvg-mobile-modal-close",function(t){t.stopPropagation(),a.destroy(),a.events&&a.events.closed&&a.events.closed.call(a,a.mapsvg)})},MapSVG.FiltersController=function(t){MapSVG.DetailsController.call(this,t)},MapSVG.extend(MapSVG.FiltersController,MapSVG.DetailsController),MapSVG.PopoverController=function(t){t.autoresize=!0,MapSVG.Controller.call(this,t),this.point=t.point,this.yShift=t.yShift,this.mapObject=t.mapObject,this.id=this.mapObject.id+"_"+Math.random(),this.container.data("popover-id",this.id)},MapSVG.extend(MapSVG.PopoverController,MapSVG.Controller),MapSVG.PopoverController.prototype.setPoint=function(t){this.point=t},MapSVG.PopoverController.prototype.getToolbarTemplate=function(){return this.withToolbar?'<div class="mapsvg-popover-close"></div>':""},MapSVG.PopoverController.prototype.init=function(){},MapSVG.PopoverController.prototype.viewDidLoad=function(){MapSVG.Controller.prototype.viewDidLoad.call(this);var t=this;MapSVG.isPhone&&t.mapsvg.getData().options.popovers.mobileFullscreen&&!this.mobileCloseBtn&&(this.mobileCloseBtn=$('<button class="mapsvg-mobile-modal-close mapsvg-btn">'+t.mapsvg.getData().options.mobileView.labelClose+"</button>"),this.view.append(this.mobileCloseBtn)),this.adjustPosition(),this.container.toggleClass("mapsvg-popover-animate",!0),this.container.toggleClass("mapsvg-popover-visible",!0),t.adjustHeight(),t.updateScroll(),this.resizeSensor.setScroll(),this.events&&this.events.shown&&this.events.shown.call(t,t.mapsvg)},MapSVG.PopoverController.prototype.adjustHeight=function(){this.container.height(this.container.find(".mapsvg-auto-height").outerHeight()+(this.toolbarView?this.toolbarView.outerHeight():0))},MapSVG.PopoverController.prototype.adjustPosition=function(){var t=this,a=t.mapsvg.convertSVGToPixel([t.point.x,t.point.y]);a[1]-=t.yShift,t.container.css({transform:"translateX(-50%) translate("+a[0]+"px,"+a[1]+"px)"})},MapSVG.PopoverController.prototype.setEventHandlers=function(){var a=this;$("body").off(".popover.mapsvg"),this.view.on("click touchend",".mapsvg-popover-close, .mapsvg-mobile-modal-close",function(t){t.stopImmediatePropagation(),a.close()}),$("body").one("mouseup.popover.mapsvg touchend.popover.mapsvg ",function(t){setTimeout(function(){a.mapsvg.getData().isScrolling||$(t.target).closest(".mapsvg-popover").length||$(t.target).hasClass("mapsvg-btn-zoom")||a.close()},50)})},MapSVG.PopoverController.prototype.close=function(){var t=this;this.container.data("popover-id")==this.id&&t.container.is(":visible")&&(t.destroy(),t.mapObject instanceof MapSVG.Region&&t.mapsvg.deselectRegion(t.mapObject),t.events&&t.events.closed&&t.events.closed.call(t,t.mapsvg))},MapSVG.PopoverController.prototype.destroy=function(){this.container.toggleClass("mapsvg-popover-animate",!1),this.container.toggleClass("mapsvg-popover-visible",!1),MapSVG.Controller.prototype.destroy.call(this)},MapSVG.PopoverController.prototype.show=function(){this.container.toggleClass("mapsvg-popover-animate",!0),this.container.toggleClass("mapsvg-popover-visible",!0)}}(jQuery,window,MapSVG,Math),function($){var mapSVG={};function MapObject(t,a){this.id="",this.objects=[],this.events={},this.data={},this.node=t,this.mapsvg=a,this.nodeType=t[0].tagName}function Region(t,a,e,o){var i;MapObject.call(this,t),this.globalOptions=a,this.mapsvg=o,this.id=this.node.attr("id"),this.id&&a.regionPrefix&&this.setId(this.id.replace(a.regionPrefix,"")),this.id_no_spaces=this.id.replace(" ","_"),this.title=this.node.attr("title"),this.node[0].setAttribute("class",(this.node.attr("class")||"")+" mapsvg-region"),this.style={fill:this.getComputedStyle("fill")},this.style.stroke=this.getComputedStyle("stroke")||"",i=this.node.data("stroke-width")?this.node.data("stroke-width"):"1"==(i=(i=this.getComputedStyle("stroke-width"))?i.replace("px",""):"1")?1.2:parseFloat(i),this.style["stroke-width"]=i,this.node.data("stroke-width",i);var s=a.regions&&a.regions[this.id]?a.regions[this.id]:null;this.disabled=this.getDisabledState(),this.disabled&&this.attr("class",this.attr("class")+" mapsvg-disabled"),this.default_attr={},this.selected_attr={};var n=!(this.hover_attr={});s&&s.selected&&(n=!0,delete s.selected),s&&this.update(s),this.setFill(),n&&this.setSelected(!0),this.saveState()}function Marker(t){this.location=t.location,(this.location.marker=this).mapsvg=t.mapsvg,t.object&&this.setObject(t.object),this.positioned=!1,this.imagePath=t.location.markerImageUrl;var a=$('<img src="'+this.imagePath+'" />').addClass("mapsvg-marker");if(MapObject.call(this,a,this.mapsvg),this.setId(this.mapsvg.markerId()),MapSVG.isNumber(this.location.lat)&&MapSVG.isNumber(this.location.lng)){var e=this.mapsvg.convertGeoToSVG([this.location.lat,this.location.lng]);this.x=e[0],this.y=e[1]}else{if(!MapSVG.isNumber(this.location.x)||!MapSVG.isNumber(this.location.y))return!1;this.x=parseFloat(this.location.x),this.y=parseFloat(this.location.y)}this.setImage(this.imagePath),this.adjustPosition(),this.mapsvg.markerAdd(this),this.positioned=!0}function LocationAddress(t){for(var a in t)this[a]=t[a]}function Location(t,a){this.img=t.img,this.lat=void 0!==t.lat?parseFloat(t.lat):void 0,this.lng=void 0!==t.lng?parseFloat(t.lng):void 0,this.x=void 0!==t.x?parseFloat(t.x):void 0,this.y=void 0!==t.y?parseFloat(t.y):void 0,this.address=new LocationAddress(t.address)}MapObject.prototype.isMarker=function(){return this instanceof MapSVG.Marker},MapObject.prototype.isRegion=function(){return this instanceof MapSVG.Region},MapObject.prototype.setData=function(t){for(var a in t)this.data[a]=t[a]},MapObject.prototype.getBBox=function(){var t=this.mapsvg.getData(),a=this instanceof Marker?{x:this.x,y:this.y,width:this.default.width/t.scale,height:this.default.height/t.scale}:this.node[0].getBBox();if(a=$.extend(!0,{},a),!(this instanceof Marker)){var e=this.node[0].getTransformToElement(this.mapsvg.getData().$svg[0]),o=a.x+a.width,i=a.y+a.height,s=this.mapsvg.getData().$svg[0].createSVGPoint();s.x=a.x,s.y=a.y,s=s.matrixTransform(e),a.x=s.x,a.y=s.y,s.x=o,s.y=i,s=s.matrixTransform(e),a.width=s.x-a.x,a.height=s.y-a.y}return[a.x,a.y,a.width,a.height]},MapObject.prototype.getGeoBounds=function(){var t=this.getBBox();return{sw:this.mapsvg.convertSVGToGeo(t[0],t[1]+t[3]),ne:this.mapsvg.convertSVGToGeo(t[0]+t[2],t[1])}},MapObject.prototype.getComputedStyle=function(a,t){var e,o;if(e=(t=t||this.node[0]).getAttribute(a))return e;if(o=t.getAttribute("style")){var i=o.split(";").filter(function(t){if((t=t.trim()).split(":")[0]==a)return!0});if(i.length)return i[0].split(":").pop().trim()}var s=$(t).parent(),n=s.length?s[0].tagName:null;return n&&"svg"!=n?this.getComputedStyle(a,s[0]):void 0},MapObject.prototype.getStyle=function(a){var t,e;if(t=this.attr(a))return t;if(e=this.attr("style")){var o=e.split(";").filter(function(t){if(0===(t=t.trim()).indexOf(a))return t});return o.length?o[0].split(":").pop().trim():void 0}return""},MapObject.prototype.getCenter=function(){var t=this.node[0].getBoundingClientRect().left,a=this.node[0].getBoundingClientRect().top;return[t+this.node[0].getBoundingClientRect().width/2,a+this.node[0].getBoundingClientRect().height/2]},MapObject.prototype.getCenterSVG=function(){var t=this.getBBox();return{x:t[0]+t[2]/2,y:t[1]+t[3]/2}},MapObject.prototype.getCenterLatLng=function(t){t=t||0;var a=this.getBBox(),e=a[0]+a[2]/2,o=a[1]+a[3]/2-t,i=this.mapsvg.convertSVGToGeo(e,o);return{lat:i[0],lng:i[1]}},MapObject.prototype.setTooltip=function(t){this.tooltip=t||void 0},MapObject.prototype.setPopover=function(t){this.popover=t||void 0},MapObject.prototype.attr=function(t,a){var e=this.node[0];if("object"==typeof t)$.each(t,function(t,a){"string"!=typeof a&&"number"!=typeof a||e.setAttribute(t,a)});else if("string"!=typeof t||"string"!=typeof a&&"number"!=typeof a){if(null==a)return e.getAttribute(t)}else e.setAttribute(t,a)},MapObject.prototype.setId=function(t){if(!t)return!1;this.id=t,this.node[0].setAttribute("id",t)},MapObject.prototype.on=function(t,a){this.events[t]||(this.events[t]=[]),this.events[t].push(a)},MapObject.prototype.off=function(t,a){for(var e in this.events)this.events[e]&&0<this.events[e].length&&0===e.indexOf(t)&&t.length<=e&&(this.events[e]=[])},MapObject.prototype.trigger=function(t){var a=this;for(var e in this.events){if(this.events[e]&&0<this.events[e].length)0===e.explode(".")[0].indexOf(t)&&this.events[e].forEach(function(t){t&&t.call(a)})}},MapSVG.extend(Region,MapObject),Region.prototype.saveState=function(){this.initialState=JSON.stringify(this.getOptions())},Region.prototype.getBBox=function(){this.mapsvg.getData();var t=this.node[0].getBBox();t=$.extend(!0,{},t);var a=this.node[0].getTransformToElement(this.mapsvg.getData().$svg[0]),e=t.x+t.width,o=t.y+t.height,i=this.mapsvg.getData().$svg[0].createSVGPoint();return i.x=t.x,i.y=t.y,i=i.matrixTransform(a),t.x=i.x,t.y=i.y,i.x=e,i.y=o,i=i.matrixTransform(a),t.width=i.x-t.x,t.height=i.y-t.y,[t.x,t.y,t.width,t.height]},Region.prototype.changed=function(){return JSON.stringify(this.getOptions())!=this.initialState},Region.prototype.edit=function(t){this.nodeOriginal=this.node.clone()},Region.prototype.editCommit=function(){this.nodeOriginal=null},Region.prototype.editCancel=function(){this.nodeOriginal.appendTo(_this.mapsvg.getData().$svg),this.node=this.nodeOriginal,this.nodeOriginal=null},Region.prototype.getOptions=function(t){this.globalOptions.regions[this.id];var e={id:this.id,id_no_spaces:this.id_no_spaces,title:this.title,fill:this.globalOptions.regions[this.id]&&this.globalOptions.regions[this.id].fill,tooltip:this.tooltip,popover:this.popover,href:this.href,target:this.target,data:this.data,gaugeValue:this.gaugeValue};if(t&&(e.disabled=this.disabled,e.dataCounter=this.data&&this.data.length||0),$.each(e,function(t,a){null==a&&delete e[t]}),this.customAttrs){var a=this;this.customAttrs.forEach(function(t){e[t]=a[t]})}return e},Region.prototype.forTemplate=function(){var t={id:this.id,title:this.title,objects:this.objects,data:this.data};for(var a in this.data)"title"!=a&&"id"!=a&&(t[a]=this.data[a]);return t},Region.prototype.update=function(t){for(var a in t){var e="set"+MapSVG.ucfirst(a);e in this?this[e](t[a]):(this[a]=t[a],this.customAttrs=this.customAttrs||[],this.customAttrs.push(a))}},Region.prototype.setId=function(t){this.id=t,this.node.prop("id",t)},Region.prototype.setTitle=function(t){this.title=t},Region.prototype.setStyle=function(t){$.extend(!0,this.style,t),this.setFill()},Region.prototype.getChoroplethColor=function(){var t=this.globalOptions.gauge,a=(parseFloat(this.data[this.globalOptions.regionChoroplethField])-t.min)/t.maxAdjusted;return{r:Math.round(t.colors.diffRGB.r*a+t.colors.lowRGB.r),g:Math.round(t.colors.diffRGB.g*a+t.colors.lowRGB.g),b:Math.round(t.colors.diffRGB.b*a+t.colors.lowRGB.b),a:Math.round(t.colors.diffRGB.a*a+t.colors.lowRGB.a)}},Region.prototype.setFill=function(t){if(this.globalOptions.colorsIgnore)this.node.css(this.style);else{if(t){var a={};a[this.id]={fill:t},$.extend(!0,this.globalOptions,{regions:a})}else!t&&void 0!==t&&this.globalOptions.regions&&this.globalOptions.regions[this.id]&&this.globalOptions.regions[this.id].fill&&delete this.globalOptions.regions[this.id].fill;if(this.globalOptions.gauge.on&&this.data&&this.data[this.globalOptions.regionChoroplethField]){var e=this.getChoroplethColor();this.default_attr.fill="rgba("+e.r+","+e.g+","+e.b+","+e.a+")"}else void 0!==this.status&&this.mapsvg.regionsDatabase&&this.mapsvg.regionsDatabase.getSchemaFieldByType("status")&&this.mapsvg.regionsDatabase.getSchemaFieldByType("status").optionsDict&&this.mapsvg.regionsDatabase.getSchemaFieldByType("status").optionsDict[this.status]&&this.mapsvg.regionsDatabase.getSchemaFieldByType("status").optionsDict[this.status].color?this.default_attr.fill=this.mapsvg.regionsDatabase.getSchemaFieldByType("status").optionsDict[this.status].color:this.globalOptions.regions[this.id]&&this.globalOptions.regions[this.id].fill?this.default_attr.fill=this.globalOptions.regions[this.id].fill:this.globalOptions.colors.base?this.default_attr.fill=this.globalOptions.colors.base:"none"!=this.style.fill?this.default_attr.fill=this.style.fill?this.style.fill:this.globalOptions.colors.baseDefault:this.default_attr.fill="none";if(MapSVG.isNumber(this.globalOptions.colors.selected)?this.selected_attr.fill=MapSVG.tinycolor(this.default_attr.fill).lighten(parseFloat(this.globalOptions.colors.selected)).toRgbString():this.selected_attr.fill=this.globalOptions.colors.selected,MapSVG.isNumber(this.globalOptions.colors.hover)?this.hover_attr.fill=MapSVG.tinycolor(this.default_attr.fill).lighten(parseFloat(this.globalOptions.colors.hover)).toRgbString():this.hover_attr.fill=this.globalOptions.colors.hover,this.node.css("fill",this.default_attr.fill),this.fill=this.default_attr.fill,"none"!=this.style.stroke&&null!=this.globalOptions.colors.stroke)this.node.css("stroke",this.globalOptions.colors.stroke);else{var o=null==this.style.stroke?"":this.style.stroke;this.node.css("stroke",o)}this.selected&&this.setSelected()}},Region.prototype.setDisabled=function(t,a){t=void 0!==t?MapSVG.parseBoolean(t):this.getDisabledState();var e=this.disabled;(this.disabled=t)?this.attr("class",this.attr("class")+" mapsvg-disabled"):this.attr("class",this.attr("class").replace(" mapsvg-disabled","")),this.disabled!=e&&this.mapsvg.deselectRegion(this),!a&&this.setFill()},Region.prototype.setStatus=function(t){var a;(a=this.globalOptions.regionStatuses&&this.globalOptions.regionStatuses[t])?(this.status=t,this.data.status=t,this.setDisabled(a.disabled,!0)):(this.status=void 0,this.data.status=void 0,this.setDisabled(!1,!0)),this.setFill()},Region.prototype.setSelected=function(t){this.mapsvg.selectRegion(this)},Region.prototype.setGaugeValue=function(t){this.gaugeValue=$.isNumeric(t)?parseFloat(t):void 0},Region.prototype.getDisabledState=function(t){var a=this.globalOptions.regions[this.id];return!t&&a&&void 0!==a.disabled?a.disabled:!(!this.globalOptions.disableAll&&"none"!=this.style.fill&&"labels"!=this.id&&"Labels"!=this.id)},Region.prototype.highlight=function(){this.node.css({fill:this.hover_attr.fill})},Region.prototype.unhighlight=function(){this.node.css({fill:this.default_attr.fill})},Region.prototype.select=function(){this.node.css({fill:this.selected_attr.fill}),this.selected=!0},Region.prototype.deselect=function(){this.node.css({fill:this.default_attr.fill}),this.selected=!1},MapSVG.extend(Marker,MapObject),Marker.prototype.setId=function(t){MapObject.prototype.setId.call(this,t),this.mapsvg.updateMarkersDict()},Marker.prototype.getBBox=function(){var t=this.mapsvg.getData(),a={x:this.x,y:this.y,width:this.width/t.scale,height:this.height/t.scale};return[(a=$.extend(!0,{},a)).x,a.y,a.width,a.height]},Marker.prototype.getOptions=function(){var e={id:this.id,src:this.src,x:this.x,y:this.y,geoCoords:this.geoCoords};return $.each(e,function(t,a){null==a&&delete e[t]}),e},Marker.prototype.update=function(t,a){for(var e in t){var o="set"+MapSVG.ucfirst(e);o in this&&this[o](t[e],a)}},Marker.prototype.setImage=function(t,a){if(!t)return!1;t=MapSVG.safeURL(t),a=a||this.mapScale;var e=new Image,o=this;this.src=t,e.onload=function(){o.width=this.width,o.height=this.height,"src"!==o.node[0].getAttribute("src")&&o.node[0].setAttribute("src",t)},e.src=t,this.location&&this.location.setImage(t)},Marker.prototype.setXy=function(t){this.x=t[0],this.y=t[1],this.xy=[this.x,this.y],this.location&&(this.location.x=this.x,this.location.y=this.y),this.mapsvg.getData().mapIsGeo&&(this.geoCoords=this.mapsvg.convertSVGToGeo(t[0],t[1]),this.location&&this.location.setLatLng({lat:this.geoCoords[0],lng:this.geoCoords[1]})),this.adjustPosition(),this.onChange&&this.onChange.call(this)},Marker.prototype.moveToClick=function(t){var a=this.mapsvg.getData(),e={};t[0]=t[0]+a.viewBox[0],t[1]=t[1]+a.viewBox[1],a.mapIsGeo&&(this.geoCoords=this.mapsvg.convertSVGToGeo(t[0],t[1])),e.xy=t,this.update(e)},Marker.prototype.adjustPosition=function(t){var a=this.mapsvg.convertSVGToPixel([this.x,this.y]);this.node.css({transform:"translate(-50%,-100%) translate("+a[0]+"px,"+a[1]+"px)"})},Marker.prototype.setGeoCoords=function(t){if("string"==typeof t&&(t=t.trim().split(","),t=[parseFloat(t[0]),parseFloat(t[1])]),"object"==typeof t&&2==t.length&&$.isNumeric(t[0])&&$.isNumeric(t[1])){var a=this.mapsvg.convertGeoToSVG(t);this.setXy(a)}},Marker.getDefaultCoords=function(t,a,e,o,i){return t=parseFloat(t),a=parseFloat(a),e=parseFloat(e),o=parseFloat(o),[t,a]},Marker.prototype.drag=function(i,s,n,r){var l=this;this.ox=this.x,this.oy=this.y,$("body").on("mousemove.drag.mapsvg",function(t){t.preventDefault(),l.mapsvg.getData().$map.addClass("no-transitions");var a=MapSVG.mouseCoords(t),e=a.x-i.x,o=a.y-i.y;l.setXy([l.ox+e/s,l.oy+o/s])}),$("body").on("mouseup.drag.mapsvg",function(t){t.preventDefault(),l.undrag();var a=MapSVG.mouseCoords(t),e=a.x-i.x,o=a.y-i.y;l.setXy([l.ox+e/s,l.oy+o/s]),n.call(l),l.ox==l.x&&l.oy==l.y&&r.call(l)})},Marker.prototype.undrag=function(){$("body").off(".drag.mapsvg"),this.mapsvg.getData().$map.removeClass("no-transitions")},Marker.prototype.delete=function(){this.node.empty().remove(),this.mapsvg.markerDelete(this)},Marker.prototype.setObject=function(t){this.object=t,this.objects=[t]},MapSVG.MapObject=MapObject,MapSVG.Region=Region,MapSVG.Marker=Marker,LocationAddress.prototype.__defineGetter__("state",function(){return"US"===this.country_short?this.administrative_area_level_1:null}),LocationAddress.prototype.__defineGetter__("state_short",function(){return"US"===this.country_short?this.administrative_area_level_1_short:null}),LocationAddress.prototype.__defineGetter__("county",function(){return"US"===this.country_short?this.administrative_area_level_2:null}),LocationAddress.prototype.__defineGetter__("zip",function(){return this.postal_code}),Location.prototype.setImage=function(t){var a=t.split("/").pop();-1!==t.indexOf("uploads")&&(a="uploads/"+a),this.img=a},Location.prototype.setLatLng=function(t){this.lat=t.lat,this.lng=t.lng},Location.prototype.__defineGetter__("markerImageUrl",function(){return this.img&&0===this.img.indexOf("uploads/")?MapSVG.urls.uploads+"markers/"+this.img.replace("uploads/",""):MapSVG.urls.root+"markers/"+(this.img||"_pin_default.png")}),Location.prototype.toJSON=function(){return{img:this.img,lat:this.lat,lng:this.lng,x:this.x,y:this.y,address:this.address}},MapSVG.Location=Location;var instances={},globalID=0,defaults={markerLastID:0,regionLastID:0,dataLastID:1,disableAll:!1,width:null,height:null,lockAspectRatio:!1,padding:{top:0,left:0,right:0,bottom:0},maxWidth:null,maxHeight:null,minWidth:null,minHeight:null,loadingText:"Loading map...",colorsIgnore:!1,colors:{baseDefault:"#000000",background:"#eeeeee",selected:40,hover:20,directory:"#fafafa",detailsView:"",status:{}},regions:{},markers:[],viewBox:[],cursor:"default",onClick:null,mouseOver:null,mouseOut:null,menuOnClick:null,beforeLoad:null,afterLoad:null,zoom:{on:!1,limit:[0,10],delta:2,buttons:{on:!0,location:"right"},mousewheel:!0},scroll:{on:!1,limit:!1,background:!1,spacebar:!1},responsive:!0,tooltips:{on:!1,position:"bottom-right",template:""},popovers:{on:!1,position:"top",template:"",centerOn:!0,width:300,maxWidth:50,maxHeight:50},multiSelect:!1,regionStatuses:{1:{label:"Enabled",value:"1",color:"",disabled:!1},0:{label:"Disabled",value:"0",color:"",disabled:!0}},events:{afterLoad:null,beforeLoad:null,databaseLoaded:null,"click.region":null,"mouseover.region":null,"mouseout.region":null,"click.marker":null,"mouseover.marker":null,"mouseout.marker":null,"click.directoryItem":null,"mouseover.directoryItem":null,"mouseout.directoryItem":null,"shown.popover":null,"shown.detailsView":null,"closed.popover":null,"closed.detailsView":null},templates:{popoverRegion:"",popoverMarker:"",tooltipRegion:"",tooltipMarker:"",directoryItem:"",detailsView:"",detailsViewRegion:""},gauge:{on:!1,labels:{low:"low",high:"high"},colors:{lowRGB:null,highRGB:null,low:"#550000",high:"#ee0000"},min:0,max:0},filters:{on:!1,source:"database",location:"leftSidebar",modalLocation:"map",width:"200px",hide:!1,buttonText:"Filters"},menu:{on:!1,location:"leftSidebar",search:!1,customContainer:!1,containerId:"",searchPlaceholder:"Search...",searchFallback:!1,source:"database",width:"200px",showFirst:"map",showMapOnClick:!0,minHeight:"400px",position:"left",sortBy:"id",sortDirection:"desc",clickActions:{region:"default",marker:"default",directoryItem:{triggerClick:!0,showPopover:!1,showDetails:!0}},detailsViewLocation:"overDirectory",noResultsText:"No results found",filterout:{field:"",cond:"=",val:""}},database:{pagination:{on:!0,perpage:30,next:"Next",prev:"Prev.",showIn:"directory"},loadOnStart:!0,table:""},actions:{region:{click:{showDetails:!1,showDetailsFor:"region",filterDirectory:!1,loadObjects:!1,showPopover:!1,showPopoverFor:"region",goToLink:!1},touch:{showPopover:!1}},marker:{click:{showDetails:!1,showPopover:!1,goToLink:!1},touch:{showPopover:!1}},directoryItem:{click:{showDetails:!0,showPopover:!1,goToLink:!1,selectRegion:!0,fireRegionOnClick:!0}}},detailsView:{location:"top",containerId:"",width:"100%"},mobileView:{labelMap:"Map",labelList:"List",labelClose:"Close"},googleMaps:{on:!1,apiKey:"",loaded:!1,center:"auto",type:"roadmap",minZoom:1,style:"default",styleJSON:[]},groups:[],floors:[],layersControl:{on:!1,position:"top-left",label:"Show on map",expanded:!0,maxHeight:"100%"},floorsControl:{on:!1,position:"top-left",label:"Floors",expanded:!1,maxHeight:"100%"},containers:{leftSidebar:{on:!1,width:"250px"},rightSidebar:{on:!1,width:"250px"},header:{on:!1,height:"auto"},footer:{on:!1,height:"auto"}},svgFileVersion:1},markerOptions={src:MapSVG.urls.root+"markers/pin1_red.png"};mapSVG=function(elem,options){var _data;this.methods={prototypes:{MapObject:MapObject,Region:Region,Marker:Marker},setMarkersClickAsLink:function(){this.database.loadSchema().done(function(t){t&&t.forEach(function(t){"marker"==t.type&&(_data.markerIsLink=MapSVG.parseBoolean(t.isLink),_data.markerUrlField=t.urlField)})})},setGroups:function(){_data.groups=_data.options.groups,_data.groups.forEach(function(a){a.objects.forEach(function(t){_data.$svg.find("#"+t.value).toggle(a.visible)})})},setLayersControl:function(t){t&&$.extend(!0,_data.options.layersControl,t),_data.options.layersControl.on?(_data.$layersControl||(_data.$layersControl=$('<div class="mapsvg-layers-control"></div>'),_data.$layersControlLabel=$('<div class="mapsvg-layers-label"></div>').appendTo(_data.$layersControl),_data.$layersControlListWrap=$('<div class="mapsvg-layers-list-wrap"></div>').appendTo(_data.$layersControl),_data.$layersControlListNano=$('<div class="nano"></div>').appendTo(_data.$layersControlListWrap),_data.$layersControlList=$('<div class="mapsvg-layers-list nano-content"></div>').appendTo(_data.$layersControlListNano),_data.$layersControl.appendTo(_data.$wrap)),_data.$layersControlLabel.html(_data.options.layersControl.label),_data.$layersControlList.empty(),_data.$layersControl.removeClass("mapsvg-top-left mapsvg-top-right mapsvg-bottom-left mapsvg-bottom-right"),_data.$layersControl.addClass("mapsvg-"+_data.options.layersControl.position),_data.options.menu.on&&!_data.options.menu.customContainer&&-1!==_data.options.layersControl.position.indexOf("left")&&_data.$layersControl.css("left",_data.options.menu.width),_data.$layersControl.css({"max-height":_data.options.layersControl.maxHeight}),_data.options.groups.forEach(function(t){$('<div class="mapsvg-layers-item" data-group-id="'+t.id+'"><input type="checkbox" class="ios8-switch ios8-switch-sm" '+(t.visible?"checked":"")+" /><label>"+t.title+"</label> </div>").appendTo(_data.$layersControlList)}),_data.$layersControlListNano.nanoScroller({preventPageScrolling:!0,iOSNativeScrolling:!0}),_data.$layersControl.off(),_data.$layersControl.on("click",".mapsvg-layers-item",function(){var a=$(this).data("group-id"),t=$(this).find("input");t.prop("checked",!t.prop("checked")),_data.options.groups.forEach(function(t){t.id==a&&(t.visible=!t.visible)}),_this.setGroups()}),_data.$layersControlLabel.on("click",function(){_data.$layersControl.toggleClass("closed")}),_data.$layersControl.toggleClass("closed",!_data.options.layersControl.expanded)):_data.$layersControl&&_data.$layersControl.hide()},setFloorsControl:function(t){t&&$.extend(!0,_data.options.floorsControl,t),_data.options.floorsControl.on?(_data.$floorsControl||(_data.$floorsControl=$('<div class="mapsvg-floors-control"></div>'),_data.$floorsControlLabel=$('<div class="mapsvg-floors-label"></div>').appendTo(_data.$floorsControl),_data.$floorsControlListWrap=$('<div class="mapsvg-floors-list-wrap"></div>').appendTo(_data.$floorsControl),_data.$floorsControlListNano=$('<div class="nano"></div>').appendTo(_data.$floorsControlListWrap),_data.$floorsControlList=$('<div class="mapsvg-floors-list nano-content"></div>').appendTo(_data.$floorsControlListNano),_data.$floorsControl.appendTo(_data.$map)),_data.$floorsControlLabel.html(_data.options.floorsControl.label),_data.$floorsControlList.empty(),_data.$floorsControl.removeClass("mapsvg-top-left mapsvg-top-right mapsvg-bottom-left mapsvg-bottom-right"),_data.$floorsControl.addClass("mapsvg-"+_data.options.floorsControl.position),_data.$floorsControl.css({"max-height":_data.options.floorsControl.maxHeight}),_data.options.floors.forEach(function(t){$('<div class="mapsvg-floors-item" data-floor-id="'+t.object_id+'"><label>'+t.title+"</label> </div>").appendTo(_data.$floorsControlList)}),_data.$floorsControlListNano.nanoScroller({preventPageScrolling:!0,iOSNativeScrolling:!0}),_data.$floorsControl.off(),_data.$floorsControl.on("click",".mapsvg-floors-item",function(){var t=$(this).data("floor-id");_this.setFloor(t)}),_data.$floorsControlLabel.on("click",function(){_data.$floorsControl.toggleClass("closed")}),_data.$floorsControl.toggleClass("closed",!_data.options.floorsControl.expanded)):_data.$floorsControl&&_data.$floorsControl.hide()},setFloor:function(t){_data.$floorsControl.find(".mapsvg-floors-item").toggleClass("active",!1),_data.$floorsControl.find('[data-floor-id="'+t+'"]').toggleClass("active",!0),_data.options.floors.forEach(function(t){_data.$svg.find("#"+t.object_id).hide()});var a=_data.$svg.find("#"+t);a.show();var e=(a=new MapObject(a,_this)).getBBox();_data._viewBox=e,_this.setViewBox(_data._viewBox),_data.zoomLevels=null,_data.zoomLevel=1,_this.setZoom(),a=null},getGroupSelectOptions:function(){var a,t=[],e=[],o=[];return _data.$svg.find("g").each(function(t){(a=$(this)[0].getAttribute("id"))&&e.push({label:a,value:a})}),t.push({title:"SVG Layers / Groups",options:e}),_data.$svg.find("path,ellipse,circle,polyline,polygon,rectangle,img,text").each(function(t){(a=$(this)[0].getAttribute("id"))&&o.push({label:a,value:a})}),t.push({title:"Other SVG objects",options:o}),t},loadDataObjects:function(t){return this.database.getAll(t)},loadDirectory:function(){if("database"===_data.options.menu.source&&!this.database.loaded)return!1;_data.options.menu.on&&_data.controllers.directory.loadItemsToDirectory(),this.setPagination()},setPagination:function(){_data.$pagerMap&&_data.$pagerMap.empty().remove(),_data.$pagerDir&&_data.$pagerDir.empty().remove(),_data.options.database.pagination.on&&0!==_data.options.database.pagination.perpage&&(_data.$directory.toggleClass("mapsvg-with-pagination",-1!==["directory","both"].indexOf(_data.options.database.pagination.showIn)),_data.$map.toggleClass("mapsvg-with-pagination",-1!==["map","both"].indexOf(_data.options.database.pagination.showIn)),_data.options.menu.on&&(_data.$pagerDir=_this.getPagination(),_data.controllers.directory.addPagination(_data.$pagerDir)),_data.$pagerMap=_this.getPagination(),_data.$map.append(_data.$pagerMap))},getPagination:function(a){var t=$('<nav class="mapsvg-pagination"><ul class="pager">\x3c!--<li class="mapsvg-first"><a href="#">First</a></li>--\x3e<li class="mapsvg-prev"><a href="#">&larr; '+_data.options.database.pagination.prev+" "+_data.options.database.pagination.perpage+'</a></li><li class="mapsvg-next"><a href="#">'+_data.options.database.pagination.next+" "+_data.options.database.pagination.perpage+' &rarr;</a></li>\x3c!--<li class="mapsvg-last"><a href="#">Last</a></li>--\x3e</ul></nav>');return _this.database.onFirstPage()&&_this.database.onLastPage()?t.hide():(t.find(".mapsvg-prev").removeClass("disabled"),t.find(".mapsvg-first").removeClass("disabled"),t.find(".mapsvg-last").removeClass("disabled"),t.find(".mapsvg-next").removeClass("disabled"),_this.database.onLastPage()&&t.find(".mapsvg-next").addClass("disabled")&&t.find(".mapsvg-last").addClass("disabled"),_this.database.onFirstPage()&&t.find(".mapsvg-prev").addClass("disabled")&&t.find(".mapsvg-first").addClass("disabled")),t.on("click",".mapsvg-next:not(.disabled)",function(t){t.preventDefault(),_this.database.onLastPage()||_this.database.getAll({page:_this.database.page+1}).done(function(){a&&a()})}).on("click",".mapsvg-prev:not(.disabled)",function(t){t.preventDefault(),_this.database.onFirstPage()||_this.database.getAll({page:_this.database.page-1}).done(function(){a&&a()})}).on("click",".mapsvg-first:not(.disabled)",function(t){t.preventDefault(),_this.database.onFirstPage()||_this.database.getAll({page:1}).done(function(){a&&a()})}).on("click",".mapsvg-last:not(.disabled)",function(t){t.preventDefault(),_this.database.onLastPage()||_this.database.getAll({lastpage:!0}).done(function(){a&&a()})}),t},deleteMarkers:function(){for(;_data.markers.length;)_data.markers[0].delete&&_data.markers[0].delete()},addLocations:function(){var a=this,t=this.database.getLoaded(),e=this.database.getSchemaFieldByType("location");if(!e)return!1;(e=e.name)&&(a.deleteMarkers(),t&&t.forEach(function(t){if(t[e]&&!(t[e]instanceof Location)&&(t[e]=new Location(t[e]),t[e].lat&&t[e].lng||t[e].x&&t[e].y))new Marker({location:t[e],object:t,mapsvg:a})}))},getCssUrl:function(){return MapSVG.urls.root+"css/mapsvg.css"},isGeo:function(){return _data.mapIsGeo},functionFromString:function(t){var a,e=!1,o=t.trim();if(-1==o.indexOf("{")||0!==o.indexOf("function")||-1==o.indexOf("("))return{error:"MapSVG user function error: no function body."};var i=o.substring(o.indexOf("{")+1,o.lastIndexOf("}")),s=o.substring(o.indexOf("(")+1,o.indexOf(")"));try{a=new Function(s,i)}catch(t){e=t}return e||a},getOptions:function(a,t,e){var o=$.extend(!0,{},_data.options);return $.extend(!0,o,e),o.viewBox=_data._viewBox,o.filtersSchema=_this.filtersSchema.getSchema(),delete o.markers,a?(o.regions=[],_data.regions.forEach(function(t){o.regions.push(t.getOptions(a))}),o.markers=_data.options.markers,o.svgFilename=o.source.split("/").pop(),o.svgFiles=MapSVG.svgFiles):(_data.regions.forEach(function(t){t.changed()&&(o.regions[t.id]=t.getOptions())}),0<_data.markers.length&&(o.markers=[]),_data.markers.forEach(function(t){t.attached||o.markers.push(t.getOptions())})),t&&$.each(o,function(t,a){JSON.stringify(a)==JSON.stringify(defaults[t])&&delete o[t]}),delete o.backend,o},on:function(t,a){this.lastChangeTime=Date.now(),_data.events[t]||(_data.events[t]=[]),_data.events[t].push(a)},off:function(t,a){for(var e in _data.events)_data.events[e]&&0<_data.events[e].length&&0===e.indexOf(t)&&t.length<=e&&(_data.events[e]=[])},trigger:function(t){var a=this;for(var e in _data.events){if(_data.events[e]&&0<_data.events[e].length)0===e.split(".")[0].indexOf(t)&&_data.events[e].forEach(function(t){try{t&&t.call(a)}catch(t){console.log(t)}})}$(window).trigger(t,a)},setEvents:function(t){for(var a in _data.events=_data.events||{},t){if("string"==typeof t[a]){var e=""!=t[a]?this.functionFromString(t[a]):null;!e||e.error||e instanceof TypeError||e instanceof SyntaxError?_data.events[a]=null:_data.events[a]=e}else"function"==typeof t[a]&&(_data.events[a]=t[a]);if(-1!==a.indexOf("directory")){var o=a.split(".")[0];_data.controllers&&_data.controllers.directory&&(_data.controllers.directory.events[o]=_data.events[a])}}$.extend(!0,_data.options.events,t)},setActions:function(t){$.extend(!0,_data.options.actions,t)},setDetailsView:function(t){if(t=t||_data.options.detailsView,$.extend(!0,_data.options.detailsView,t),"top"===_data.options.detailsView.location&&"left"===_data.options.menu.position?_data.options.detailsView.location="leftSidebar":"top"===_data.options.detailsView.location&&"right"===_data.options.menu.position&&(_data.options.detailsView.location="rightSidebar"),"near"===_data.options.detailsView.location&&(_data.options.detailsView.location="map"),_data.$details||(_data.$details=$('<div class="mapsvg-details-container"></div>')),_data.$details.toggleClass("mapsvg-details-container-relative",!_this.shouldBeScrollable(_data.options.detailsView.location)),"custom"===_data.options.detailsView.location)$("#"+_data.options.detailsView.containerId).append(_data.$details);else{if(MapSVG.isPhone)$("body").append(_data.$details);else{var a="$"+_data.options.detailsView.location;_data[a].append(_data.$details)}_data.options.detailsView.margin&&_data.$details.css("margin",_data.options.detailsView.margin)}},setMobileView:function(t){$.extend(!0,_data.options.mobileView,t)},deleteDataField:function(a){_data.options.data.forEach(function(t){delete t[a]})},addZeroDataField:function(a){_data.options.data.forEach(function(t){t[a]=""})},attachDataToRegions:function(){_data.regions.forEach(function(t){t.objects=[]}),_this.database.getLoaded().forEach(function(e,t){e.regions&&e.regions.length&&"object"==typeof e.regions&&e.regions.forEach(function(t){var a=_this.getRegion(t.id);a&&a.objects.push(e)})})},setTemplates:function(t){for(var a in _data.templates=_data.templates||{},t)if(null!=a){_data.options.templates[a]=t[a];var e=_data.options.templates[a];"directoryItem"==a&&(e='{{#each items}}<div id="mapsvg-directory-item-{{id}}" class="mapsvg-directory-item" data-object-id="{{id}}">'+e+"</div>{{/each}}",a="directory"),_data.templates[a]=Handlebars.compile(e),_data.editMode&&"directory"==a&&_data.controllers&&_data.controllers.directory&&(_data.controllers.directory.templates.main=_data.templates[a],this.loadDirectory())}},setRegionStatus:function(t,a){(a=_this.regionsDatabase.getSchemaField("status").optionsDict[a]).disabled?t.setDisabled(!0):t.setDisabled(!1),a.color?t.setFill(a.color):t.setFill()},update:function(t){for(var a in t)if("regions"==a)$.each(t.regions,function(t,a){var e=_this.getRegion(t);e&&e.update(a),null!=a.gaugeValue&&(_this.updateGaugeMinMax(),_this.regionsRedrawColors()),null!=a.disabled&&(_this.deselectRegion(e),_data.options.regions[t]=_data.options.regions[t]||{},_data.options.regions[t].disabled=e.disabled)});else if("markers"==a)$.each(t.markers,function(t,a){var e=_this.getMarker(t);e&&e.update(a)});else{var e="set"+MapSVG.ucfirst(a);_this.hasOwnProperty(e)?this[e](t[a]):_data.options[a]=t[a]}},setTitle:function(t){t&&(_data.options.title=t)},setExtension:function(t){t?_data.options.extension=t:delete _data.options.extension},setDisableLinks:function(t){(t=MapSVG.parseBoolean(t))?_data.$map.on("click.a.mapsvg","a",function(t){t.preventDefault()}):_data.$map.off("click.a.mapsvg"),_data.disableLinks=t},setLoadingText:function(t){_data.options.loadingText=t},setLockAspectRatio:function(t){_data.options.lockAspectRatio=MapSVG.parseBoolean(t)},setOnClick:function(t){_data.options.onClick=t||void 0},setMouseOver:function(t){_data.options.mouseOver=t||void 0},setMouseOut:function(t){_data.options.mouseOut=t||void 0},setBeforeLoad:function(t){_data.options.beforeLoad=t||void 0},setAfterLoad:function(t){_data.options.afterLoad=t||void 0},setPopoverShown:function(t){_data.options.popoverShown=t||void 0},setMarkerEditHandler:function(t){_data.markerEditHandler=t},setRegionChoroplethField:function(t){_data.options.regionChoroplethField=t,_this.redrawGauge()},setRegionEditHandler:function(t){_data.regionEditHandler=t},setDisableAll:function(t){t=MapSVG.parseBoolean(t),$.extend(!0,_data.options,{disableAll:t}),_data.$map.toggleClass("mapsvg-disabled-regions",t)},setRegionStatuses:function(t){_data.options.regionStatuses=t;var a={};for(var e in _data.options.regionStatuses)a[e]=_data.options.regionStatuses[e].color.length?_data.options.regionStatuses[e].color:void 0;_this.setColors({status:a})},setColorsIgnore:function(t){_data.options.colorsIgnore=MapSVG.parseBoolean(t),_this.regionsRedrawColors()},setColors:function(t){$.extend(!0,_data.options,{colors:t}),t&&t.status&&(_data.options.colors.status=t.status),$.each(_data.options.colors,function(t,a){null!==a&&""!=a||delete _data.options.colors[t]}),_data.options.colors.background&&_data.$map.css({background:_data.options.colors.background}),_data.options.colors.hover&&(_data.options.colors.hover=_data.options.colors.hover==""+parseInt(_data.options.colors.hover)?parseInt(_data.options.colors.hover):_data.options.colors.hover),_data.options.colors.selected&&(_data.options.colors.selected=_data.options.colors.selected==""+parseInt(_data.options.colors.selected)?parseInt(_data.options.colors.selected):_data.options.colors.selected),_data.$leftSidebar.css({background:_data.options.colors.leftSidebar}),_data.$rightSidebar.css({background:_data.options.colors.rightSidebar}),_data.$header.css({background:_data.options.colors.header}),_data.$footer.css({background:_data.options.colors.footer}),_data.$details&&void 0!==_data.options.colors.detailsView&&_data.$details.css({"background-color":_data.options.colors.detailsView}),_data.$directory&&void 0!==_data.options.colors.directory&&_data.$directory.css({"background-color":_data.options.colors.directory}),_data.$filtersModal&&void 0!==_data.options.colors.modalFilters&&_data.$filtersModal.css({"background-color":_data.options.colors.modalFilters}),_data.$filters&&_data.options.colors.directorySearch?_data.$filters.css({"background-color":_data.options.colors.directorySearch,padding:"10px"}):_data.$filters&&_data.$filters.css({"background-color":"",padding:""}),_this.regionsRedrawColors()},setTooltips:function(t){void 0!==t.on&&(t.on=MapSVG.parseBoolean(t.on)),$.extend(!0,_data.options,{tooltips:t}),_data.tooltip=_data.tooltip||{posOriginal:{},posShifted:{},posShiftedPrev:{},mirror:{}},_data.tooltip.posOriginal={},_data.tooltip.posShifted={},_data.tooltip.posShiftedPrev={},_data.tooltip.mirror={},_data.tooltip.container?_data.tooltip.container[0].className=_data.tooltip.container[0].className.replace(/(^|\s)mapsvg-tt-\S+/g,""):(_data.tooltip.container=$("<div />").addClass("mapsvg-tooltip"),_data.$map.append(_data.tooltip.container));var a=_data.options.tooltips.position.split("-");-1==a[0].indexOf("top")&&-1==a[0].indexOf("bottom")||(_data.tooltip.posOriginal.topbottom=a[0]),-1==a[0].indexOf("left")&&-1==a[0].indexOf("right")||(_data.tooltip.posOriginal.leftright=a[0]),a[1]&&(_data.tooltip.posOriginal.leftright=a[1]);var e="mousemove.tooltip.mapsvg-"+_data.$map.attr("id");_data.tooltip.container.addClass("mapsvg-tt-"+_data.options.tooltips.position),$("body").off(e).on(e,function(t){MapSVG.mouse=MapSVG.mouseCoords(t),_data.tooltip.container[0].style.left=t.clientX+$(window).scrollLeft()-_data.$map.offset().left+"px",_data.tooltip.container[0].style.top=t.clientY+$(window).scrollTop()-_data.$map.offset().top+"px";var a={x:t.clientX+$(window).scrollLeft(),y:t.clientY+$(window).scrollTop()},e=_data.tooltip.container[0].getBoundingClientRect(),o=_data.$wrap[0].getBoundingClientRect();if(e={top:e.top+$(window).scrollTop(),bottom:e.bottom+$(window).scrollTop(),left:e.left+$(window).scrollLeft(),right:e.right+$(window).scrollLeft(),width:e.width,height:e.height},o={top:o.top+$(window).scrollTop(),bottom:o.bottom+$(window).scrollTop(),left:o.left+$(window).scrollLeft(),right:o.right+$(window).scrollLeft(),width:o.width,height:o.height},!(a.x>o.right||a.y>o.bottom||a.x<o.left||a.y<o.top)){_data.tooltip.mirror.top||_data.tooltip.mirror.bottom?_data.tooltip.mirror.top&&a.y>_data.tooltip.mirror.top?(_data.tooltip.mirror.top=!1,delete _data.tooltip.posShifted.topbottom):_data.tooltip.mirror.bottom&&a.y<_data.tooltip.mirror.bottom&&(_data.tooltip.mirror.bottom=!1,delete _data.tooltip.posShifted.topbottom):e.bottom<o.top+e.height?(_data.tooltip.posShifted.topbottom="bottom",_data.tooltip.mirror.top=a.y):e.top>o.bottom-e.height&&(_data.tooltip.posShifted.topbottom="top",_data.tooltip.mirror.bottom=a.y),_data.tooltip.mirror.right||_data.tooltip.mirror.left?_data.tooltip.mirror.left&&a.x>_data.tooltip.mirror.left?(_data.tooltip.mirror.left=!1,delete _data.tooltip.posShifted.leftright):_data.tooltip.mirror.right&&a.x<_data.tooltip.mirror.right&&(_data.tooltip.mirror.right=!1,delete _data.tooltip.posShifted.leftright):e.right<o.left+e.width?(_data.tooltip.posShifted.leftright="right",_data.tooltip.mirror.left=a.x):e.left>o.right-e.width&&(_data.tooltip.posShifted.leftright="left",_data.tooltip.mirror.right=a.x);var i=$.extend({},_data.tooltip.posOriginal,_data.tooltip.posShifted),s=[];i.topbottom&&s.push(i.topbottom),i.leftright&&s.push(i.leftright),i=s.join("-"),_data.tooltip.posShifted.topbottom==_data.tooltip.posOriginal.topbottom&&_data.tooltip.posShifted.leftright==_data.tooltip.posOriginal.leftright||(_data.tooltip.container[0].className=_data.tooltip.container[0].className.replace(/(^|\s)mapsvg-tt-\S+/g,""),_data.tooltip.container.addClass("mapsvg-tt-"+i),_data.tooltip.posShiftedPrev=i)}})},setPopovers:function(t){void 0!==t.on&&(t.on=MapSVG.parseBoolean(t.on)),$.extend(_data.options.popovers,t),_data.$popover||(_data.$popover=$("<div />").addClass("mapsvg-popover"),_data.layers.popovers.append(_data.$popover)),_data.$popover.css({width:_data.options.popovers.width+("auto"==_data.options.popovers.width?"":"px"),"max-width":_data.options.popovers.maxWidth+"%","max-height":_data.options.popovers.maxHeight*_data.$wrap.outerHeight()/100+"px"}),_data.options.popovers.mobileFullscreen&&MapSVG.isPhone&&($("body").toggleClass("mapsvg-fullscreen-popovers",!0),_data.$popover.appendTo("body"))},setRegionPrefix:function(t){_data.options.regionPrefix=t},setInitialViewBox:function(t){"string"==typeof t&&(t=t.trim().split(" ")),_data._viewBox=[parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])],_data.options.googleMaps.on&&(_data.options.googleMaps.center=_data.googleMaps.map.getCenter().toJSON(),_data.options.googleMaps.zoom=_data.googleMaps.map.getZoom()),_data.zoomLevel=0},setViewBoxOnStart:function(){_data.viewBoxFull=_data.svgDefault.viewBox,_data.viewBoxFake=_data.viewBox,_data.whRatioFull=_data.viewBoxFull[2]/_data.viewBox[2],_data.$svg[0].setAttribute("viewBox",_data.viewBoxFull.join(" ")),_data.vbstart=1},setViewBox:function(t,a){"string"==typeof t&&(t=t.trim().split(" "));var e=t&&4==t.length?t:_data.svgDefault.viewBox,o=parseFloat(e[2])!=_data.viewBox[2]||parseFloat(e[3])!=_data.viewBox[3];_data.viewBox=[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])],_data.whRatio=_data.viewBox[2]/_data.viewBox[3],!_data.vbstart&&_this.setViewBoxOnStart(),t||(_data._viewBox=_data.viewBox,_data._scale=1);var i=_data.options.padding;return i.top&&(_data.viewBox[1]-=i.top,_data.viewBox[3]+=i.top),i.right&&(_data.viewBox[2]+=i.right),i.bottom&&(_data.viewBox[3]+=i.bottom),i.left&&(_data.viewBox[0]-=i.left,_data.viewBox[2]+=i.left),_data.scale=_this.getScale(),_data.superScale=_data.whRatioFull*_data.svgDefault.viewBox[2]/_data.viewBox[2],_data.scroll=_data.scroll||{},_data.scroll.tx=(_data.svgDefault.viewBox[0]-_data.viewBox[0])*_data.scale,_data.scroll.ty=(_data.svgDefault.viewBox[1]-_data.viewBox[1])*_data.scale,_data.$scrollpane.css({transform:"translate("+_data.scroll.tx+"px,"+_data.scroll.ty+"px)"}),_data.$svg.css({transform:"scale("+_data.superScale+")"}),o&&!a&&_this.updateSize(),o&&_this.trigger("zoom"),!0},setViewBoxReal:function(t){_data.viewBoxFull=t,_data.viewBoxFake=t,_data.whRatioFull=_data.viewBoxFull[2]/_data.viewBox[2],_data.viewBox=t,_data.svgDefault.viewBox=_data.viewBox,_data.viewBoxFull=t,_data.viewBoxFake=_data.viewBox,_data.whRatioFull=_data.viewBoxFull[2]/_data.viewBox[2],_data.$svg[0].setAttribute("viewBox",_data.viewBoxFull.join(" ")),_data.scale=_this.getScale();var a=-t[0]*_data.scale,e=-t[1]*_data.scale;_data.$layers.css({transform:"translate("+a+"px,"+e+"px)"}),_data.zoomLevel=0,_this.setViewBox(t)},setViewBoxByGoogleMapBounds:function(){var t=_data.googleMaps.map.getBounds();if(t){var a=t.toJSON();if(-180==a.west&&180==a.east)_data.googleMaps.map.getCenter().toJSON();var e=[t.getNorthEast().lat(),t.getNorthEast().lng()],o=[t.getSouthWest().lat(),t.getSouthWest().lng()],i=_this.convertGeoToSVG(e),s=_this.convertGeoToSVG(o);if(i[0]<s[0]){var n=_data.svgDefault.viewBox[2]/_data.mapLonDelta*360;s[0]=-(n-s[0])}var r=i[0]-s[0],l=s[1]-i[1];_this.setViewBox([s[0],i[1],r,l])}},redraw:function(){if(MapSVG.browser.ie&&(_data.whRatio2=_data.svgDefault.viewBox[2]/_data.svgDefault.viewBox[3],_data.$svg.height(_data.$map.outerWidth()/_data.whRatio2)),_data.options.googleMaps.on&&_data.googleMaps.map){var t=_data.googleMaps.map.getCenter();google.maps.event.trigger(_data.googleMaps.map,"resize"),_data.googleMaps.map.setCenter(t)}else _this.setViewBox(_data.viewBox);_data.$popover&&_data.$popover.css({"max-height":_data.options.popovers.maxHeight*_data.$wrap.outerHeight()/100+"px"}),_this.updateSize()},setPadding:function(t){for(var a in t=t||_data.options.padding)t[a]=t[a]?parseInt(t[a]):0;$.extend(_data.options.padding,t),_this.setViewBox(),_this.trigger("sizeChange")},setSize:function(t,a,e){return _data.options.width=parseFloat(t),_data.options.height=parseFloat(a),_data.options.responsive=null!=e&&null!=e?MapSVG.parseBoolean(e):_data.options.responsive,_data.options.width||_data.options.height?!_data.options.width&&_data.options.height?_data.options.width=parseInt(_data.options.height*_data.svgDefault.width/_data.svgDefault.height):_data.options.width&&!_data.options.height&&(_data.options.height=parseInt(_data.options.width*_data.svgDefault.height/_data.svgDefault.width)):(_data.options.width=_data.svgDefault.width,_data.options.height=_data.svgDefault.height),_data.whRatio=_data.options.width/_data.options.height,_data.scale=_this.getScale(),_this.setResponsive(e),_data.markers&&_this.markersAdjustPosition(),[_data.options.width,_data.options.height]},setResponsive:function(t,a){t=null!=t?MapSVG.parseBoolean(t):_data.options.responsive,_data.$map.css({width:"100%",height:"0","padding-bottom":100*_data.viewBox[3]/_data.viewBox[2]+"%"}),t?_data.$wrap.css({width:"100%",height:"auto"}):_data.$wrap.css({width:_data.options.width+"px",height:_data.options.height+"px"}),$.extend(!0,_data.options,{responsive:t}),_data.resizeSensor||(_data.resizeSensor=new MapSVG.ResizeSensor(_data.$map[0],function(){console.log("map redraw"),_this.redraw()})),_this.redraw()},setScroll:function(t,a){null!=t.on&&(t.on=MapSVG.parseBoolean(t.on)),null!=t.limit&&(t.limit=MapSVG.parseBoolean(t.limit)),$.extend(!0,_data.options,{scroll:t}),!a&&_this.setEventHandlers()},setZoom:function(t){if(null!=(t=t||{}).on&&(t.on=MapSVG.parseBoolean(t.on)),null!=t.mousewheel&&(t.mousewheel=MapSVG.parseBoolean(t.mousewheel)),t.delta=2,t.limit&&("string"==typeof t.limit&&(t.limit=t.limit.split(";")),t.limit=[parseInt(t.limit[0]),parseInt(t.limit[1])]),!_data.zoomLevels){_data.zoomLevels={};for(var a=1,e=0;e<=20;e++)_data.zoomLevels[e+""]={_scale:a,viewBox:[0,0,_data._viewBox[2]/a,_data._viewBox[3]/a]},a*=_data.options.zoom.delta;a=1;for(e=0;-20<=e;e--)_data.zoomLevels[e+""]={_scale:a,viewBox:[0,0,_data._viewBox[2]/a,_data._viewBox[3]/a]},a/=_data.options.zoom.delta}$.extend(!0,_data.options,{zoom:t}),_data.$map.off("mousewheel.mapsvg"),_data.options.zoom.on&&_data.options.zoom.mousewheel&&(MapSVG.browser.firefox&&(_data.firefoxScroll={insideIframe:!1},_data.$map.on("mouseenter",function(){_data.firefoxScroll.insideIframe=!0,_data.firefoxScroll.scrollX=window.scrollX,_data.firefoxScroll.scrollY=window.scrollY}).on("mouseleave",function(){_data.firefoxScroll.insideIframe=!1}),$(document).scroll(function(){_data.firefoxScroll.insideIframe&&window.scrollTo(_data.firefoxScroll.scrollX,_data.firefoxScroll.scrollY)})),_data.$map.on("mousewheel.mapsvg",function(t,a,e,o){if(!$(t.target).hasClass("mapsvg-popover")&&!$(t.target).closest(".mapsvg-popover").length){t.preventDefault();var i=0<a?1:-1,s=MapSVG.mouseCoords(t);s.x=s.x-_data.$svg.offset().left,s.y=s.y-_data.$svg.offset().top;var n=_this.convertPixelToSVG([s.x,s.y]);return 0<i?_this.zoomIn(n):_this.zoomOut(n),!1}})),_this.setZoomButtons(),_data.canZoom=!0},setZoomButtons:function(){var t=_data.options.zoom.buttons.location||"hide";if(!_data.zoomButtons){var a=$("<div />").addClass("mapsvg-buttons");a.zoomIn=$("<div />").addClass("mapsvg-btn-zoom in");var e=MapSVG.touchDevice?"touchend":"click";a.zoomIn.on(e,function(t){t.stopPropagation(),_this.zoomIn()}),a.zoomOut=$("<div />").addClass("mapsvg-btn-zoom out"),a.zoomOut.on(e,function(t){t.stopPropagation(),_this.zoomOut()}),a.append(a.zoomIn).append(a.zoomOut),_data.zoomButtons=a,_data.$map.append(_data.zoomButtons)}_data.zoomButtons.removeClass("left"),_data.zoomButtons.removeClass("right"),"right"==t&&_data.zoomButtons.addClass("right")||"left"==t&&_data.zoomButtons.addClass("left"),_data.options.zoom.on&&"hide"!=t?_data.zoomButtons.show():_data.zoomButtons.hide()},setCursor:function(t){t="pointer"==t?"pointer":"default","pointer"==(_data.options.cursor=t)?_data.$map.addClass("mapsvg-cursor-pointer"):_data.$map.removeClass("mapsvg-cursor-pointer")},setPreloaderText:function(t){_data.options.loadingText=t},setMultiSelect:function(t,a){_data.options.multiSelect=MapSVG.parseBoolean(t),!1!==a&&_this.deselectAllRegions()},setGauge:function(t){null!=(t=t||_data.options.gauge).on&&(t.on=MapSVG.parseBoolean(t.on)),$.extend(!0,_data.options,{gauge:t});var a=!1;if(!_data.$gauge){_data.$gauge={},_data.$gauge.gradient=$("<td>&nbsp;</td>").addClass("mapsvg-gauge-gradient"),_this.setGaugeGradientCSS(),_data.$gauge.container=$("<div />").addClass("mapsvg-gauge").hide(),_data.$gauge.table=$("<table />");var e=$("<tr />");_data.$gauge.labelLow=$("<td>"+_data.options.gauge.labels.low+"</td>"),_data.$gauge.labelHigh=$("<td>"+_data.options.gauge.labels.high+"</td>"),e.append(_data.$gauge.labelLow),e.append(_data.$gauge.gradient),e.append(_data.$gauge.labelHigh),_data.$gauge.table.append(e),_data.$gauge.container.append(_data.$gauge.table),_data.$map.append(_data.$gauge.container)}!_data.options.gauge.on&&_data.$gauge.container.is(":visible")?(_data.$gauge.container.hide(),a=!0):_data.options.gauge.on&&!_data.$gauge.container.is(":visible")&&(_data.$gauge.container.show(),a=!0,_this.regionsDatabase.on("change",function(){_this.redrawGauge()})),t.colors&&(_data.options.gauge.colors.lowRGB=MapSVG.tinycolor(_data.options.gauge.colors.low).toRgb(),_data.options.gauge.colors.highRGB=MapSVG.tinycolor(_data.options.gauge.colors.high).toRgb(),_data.options.gauge.colors.diffRGB={r:_data.options.gauge.colors.highRGB.r-_data.options.gauge.colors.lowRGB.r,g:_data.options.gauge.colors.highRGB.g-_data.options.gauge.colors.lowRGB.g,b:_data.options.gauge.colors.highRGB.b-_data.options.gauge.colors.lowRGB.b,a:_data.options.gauge.colors.highRGB.a-_data.options.gauge.colors.lowRGB.a},a=!0,_data.$gauge&&_this.setGaugeGradientCSS()),t.labels&&(_data.$gauge.labelLow.html(_data.options.gauge.labels.low),_data.$gauge.labelHigh.html(_data.options.gauge.labels.high)),a&&_this.redrawGauge()},redrawGauge:function(){_this.updateGaugeMinMax(),_this.regionsRedrawColors()},updateGaugeMinMax:function(){_data.options.gauge.min=0,_data.options.gauge.max=!1;var e=[];_data.regions.forEach(function(t){var a=t.data&&t.data[_data.options.regionChoroplethField];null!=a&&parseFloat(e.push(a))}),0<e.length&&(_data.options.gauge.min=1==e.length?0:Math.min.apply(null,e),_data.options.gauge.max=Math.max.apply(null,e),_data.options.gauge.maxAdjusted=_data.options.gauge.max-_data.options.gauge.min)},setGaugeGradientCSS:function(){_data.$gauge.gradient.css({background:_data.options.gauge.colors.low,background:"-moz-linear-gradient(left, "+_data.options.gauge.colors.low+" 1%,"+_data.options.gauge.colors.high+" 100%)",background:"-webkit-gradient(linear, left top, right top, color-stop(1%,"+_data.options.gauge.colors.low+"), color-stop(100%,"+_data.options.gauge.colors.high+"))",background:"-webkit-linear-gradient(left, "+_data.options.gauge.colors.low+" 1%,"+_data.options.gauge.colors.high+" 100%)",background:"-o-linear-gradient(left, "+_data.options.gauge.colors.low+" 1%,"+_data.options.gauge.colors.high+" 100% 100%)",background:"-ms-linear-gradient(left,  "+_data.options.gauge.colors.low+" 1%,"+_data.options.gauge.colors.high+" 100% 100%)",background:"linear-gradient(to right,"+_data.options.gauge.colors.low+" 1%,"+_data.options.gauge.colors.high+" 100%)",filter:'progid:DXImageTransform.Microsoft.gradient( startColorstr="'+_data.options.gauge.colors.low+'", endColorstr="'+_data.options.gauge.colors.high+'",GradientType=1 )'})},setCss:function(t){_data.options.css=t},setFilters:function(t){var a=this;null!=(t=t||_data.options.filters).on&&(t.on=MapSVG.parseBoolean(t.on)),null!=t.hide&&(t.hide=MapSVG.parseBoolean(t.hide)),$.extend(!0,_data.options,{filters:t});if(-1===["leftSidebar","rightSidebar","header","footer","custom","mapContainer"].indexOf(_data.options.filters.location)&&(_data.options.filters.location="leftSidebar"),_data.options.filters.on){if(a.formBuilder&&a.formBuilder.destroy(),_data.$filters||(_data.$filters=$('<div class="mapsvg-filters-wrap"></div>')),_data.$filters.empty(),_data.$filters.show(),_data.options.colors.directorySearch&&_data.$filters.css({"background-color":_data.options.colors.directorySearch,padding:"10px"}),"custom"===_data.options.filters.location)_data.$filters.removeClass("mapsvg-filter-container-custom").addClass("mapsvg-filter-container-custom"),$("#"+_data.options.filters.containerId).length?$("#"+_data.options.filters.containerId).append(_data.$filters):(_data.$filters.hide(),console.error("MapSVG: filter container #"+_data.options.filters.containerId+" does not exists"));else if(MapSVG.isPhone)_data.$header.append(_data.$filters),a.setContainers({header:{on:!0}});else{var e="$"+(MapSVG.isPhone?"header":_data.options.filters.location);_data.options.menu.on&&_data.controllers.directory&&_data.options.menu.location===_data.options.filters.location?_data.controllers.directory.view.find(".mapsvg-directory-filter-wrap").append(_data.$filters):_data[e].append(_data.$filters)}if(a.loadFiltersController(_data.$filters,!1),_data.options.filters&&_data.options.filters.on||a.database.query.filters&&0<Object.keys(a.database.query.filters).length)for(var o in a.database.query.filters){var i=a.database.query.filters[o],s=o,n=a.mapsvg.filtersSchema.getField(s);a.mapsvg.getData().options.filters.on&&n?filters.find('[data-parameter-name="'+s+'"]').val(i):("regions"==o?(s="",i=a.mapsvg.getRegion(i).title||i):s=n.label,"distance"!==o&&filters.append('<div class="mapsvg-filter-tag">'+(s?s+": ":"")+i+' <span class="mapsvg-filter-delete" data-filter="'+o+'"></span></div>'))}}_data.options.menu.on&&_data.controllers.directory&&_data.options.menu.location===_data.options.filters.location&&_data.controllers.directory.updateTopShift()},setContainers:function(t){for(var a in _data.containersCreated||(_data.$wrapAll=$('<div class="mapsvg-wrap-all"></div>'),_data.$wrap=$('<div class="mapsvg-wrap"></div>'),_data.$containers={},_data.$mapContainer=$('<div class="mapsvg-map-container"></div>'),_data.$leftSidebar=$('<div class="mapsvg-sidebar mapsvg-top-container mapsvg-sidebar-left"></div>'),_data.$rightSidebar=$('<div class="mapsvg-sidebar mapsvg-top-container mapsvg-sidebar-right"></div>'),_data.$header=$('<div class="mapsvg-header mapsvg-top-container"></div>'),_data.$footer=$('<div class="mapsvg-footer mapsvg-top-container"></div>'),_data.$wrapAll.insertBefore(_data.$map),_data.$wrapAll.append(_data.$header),_data.$wrapAll.append(_data.$wrap),_data.$wrapAll.append(_data.$footer),_data.$mapContainer.append(_data.$map),_data.$wrap.append(_data.$leftSidebar),_data.$wrap.append(_data.$mapContainer),_data.$wrap.append(_data.$rightSidebar),_data.containersCreated=!0),t=t||_data.options){t[a].on=MapSVG.parseBoolean(t[a].on),$contName="$"+a;var e=(!MapSVG.isPhone||-1===["leftSidebar","rightSidebar"].indexOf(a))&&t[a].on;_data[$contName].toggle(e),t[a].width&&(-1===t[a].width.indexOf("px")&&-1===t[a].width.indexOf("%")&&"auto"!==t[a].width&&(t[a].width=t[a].width+"px"),_data[$contName].css({"flex-basis":t[a].width})),t[a].height&&(-1===t[a].height.indexOf("px")&&-1===t[a].height.indexOf("%")&&"auto"!==t[a].height&&(t[a].height=t[a].height+"px"),_data[$contName].css({"flex-basis":t[a].height,height:t[a].height}))}$.extend(!0,_data.options,{containers:t}),this.setDetailsView()},setDirectory:function(t){return _this.setMenu(t)},shouldBeScrollable:function(t){switch(t){case"mapContainer":case"leftSidebar":case"rightSidebar":return!0;case"custom":return!1;case"header":case"footer":return!(!_data.options.containers[t].height||"auto"===_data.options.containers[t].height||"100%"===_data.options.containers[t].height);default:return!1}},setMenu:function(t){var a=this;if(null!=(t=t||_data.options.menu).on&&(t.on=MapSVG.parseBoolean(t.on)),null!=t.search&&(t.search=MapSVG.parseBoolean(t.search)),null!=t.showMapOnClick&&(t.showMapOnClick=MapSVG.parseBoolean(t.showMapOnClick)),null!=t.searchFallback&&(t.searchFallback=MapSVG.parseBoolean(t.searchFallback)),null!=t.customContainer&&(t.customContainer=MapSVG.parseBoolean(t.customContainer)),$.extend(!0,_data.options,{menu:t}),_data.controllers=_data.controllers||{},_data.$directory||(_data.$directory=$('<div class="mapsvg-directory"></div>')),_data.$directory.toggleClass("flex",a.shouldBeScrollable(_data.options.menu.location)),_data.options.menu.on){if(_data.controllers.directory){if(_data.controllers.directory.database="regions"===_data.options.menu.source?a.regionsDatabase:a.database,_data.controllers.directory.database.sortBy=_data.options.menu.sortBy,_data.controllers.directory.database.sortDir=_data.options.menu.sortDirection,t.filterout){var e={};e[_data.options.menu.filterout.field]=_data.options.menu.filterout.val,_data.controllers.directory.database.query.setFilterOut(e)}_data.controllers.directory.scrollable=a.shouldBeScrollable(_data.options.menu.location)}else _data.controllers.directory=new MapSVG.DirectoryController({container:_data.$directory,data:a.getData(),template:_data.templates.directory,mapsvg:a,filters:a.filters,database:"regions"===_data.options.menu.source?a.regionsDatabase:a.database,scrollable:a.shouldBeScrollable(_data.options.menu.location),events:{click:_data.events["click.directoryItem"],mouseover:_data.events["mouseover.directoryItem"],mouseout:_data.events["mouseout.directoryItem"]}});(MapSVG.isPhone?_data.$leftSidebar:"custom"!==_data.options.menu.location?_data["$"+_data.options.menu.location]:$("#"+_data.options.menu.containerId)).append(_data.$directory),_data.options.colors.directory&&_data.$directory.css({"background-color":_data.options.colors.directory}),a.setFilters(),("regions"===_data.options.menu.source||"database"===_data.options.menu.source&&a.database.loaded)&&(_data.editMode&&(t.sortBy||t.sortDirection||t.filterout)&&_data.controllers.directory.database.getAll(),a.loadDirectory())}else _data.controllers.directory&&_data.controllers.directory.destroy(),_data.controllers.directory=null},setDatabase:function(t){if((t=t||_data.options.database).pagination&&(null!=t.pagination.on&&(t.pagination.on=MapSVG.parseBoolean(t.pagination.on)),null!=t.pagination.perpage&&(t.pagination.perpage=parseInt(t.pagination.perpage))),$.extend(!0,_data.options,{database:t}),t.pagination)if(void 0!==t.pagination.on||t.pagination.perpage){var a={perpage:_data.options.database.pagination.on?_data.options.database.pagination.perpage:0};_this.database.getAll(a)}else _this.setPagination()},setGoogleMaps:function(t){var d=this;if(null!=(t=t||_data.options.googleMaps).on&&(t.on=MapSVG.parseBoolean(t.on)),_data.googleMaps||(_data.googleMaps={loaded:!1,initialized:!1,map:null}),$.extend(!0,_data.options,{googleMaps:t}),_data.options.googleMaps.on)if(_data.$map.toggleClass("mapsvg-with-google-map",!0),MapSVG.googleMapsApiLoaded)if(_data.googleMaps.map)_data.$map.toggleClass("mapsvg-with-google-map",!0),_data.$googleMaps&&_data.$googleMaps.show(),t.type&&_data.googleMaps.map.setMapTypeId(t.type);else{function a(t,a){this.bounds_=t,this.map_=a,this.setMap(a),this.prevCoords={sw:{x:0,y:0},sw2:{x:0,y:0},ne:{x:0,y:0},ne2:{x:0,y:0}}}_data.$googleMaps=$('<div class="mapsvg-layer mapsvg-layer-gm" id="mapsvg-google-maps-'+d.id+'"></div>').prependTo(_data.$map),_data.$googleMaps.css({position:"absolute",top:0,left:0,bottom:0,right:0,"z-index":"0"}),_data.googleMaps.map=new google.maps.Map(_data.$googleMaps[0],{mapTypeId:t.type,fullscreenControl:!1,keyboardShortcuts:!1,mapTypeControl:!1,scaleControl:!1,scrollwheel:!1,streetViewControl:!1,zoomControl:!1,styles:t.styleJSON}),(a.prototype=new google.maps.OverlayView).onAdd=function(){var t=document.createElement("div");t.style.borderStyle="none",t.style.borderWidth="0px",t.style.position="absolute",this.div_=t,this.getPanes().overlayLayer.appendChild(t)},a.prototype.draw=function(){if(!_data.isScrolling){var t=this.getProjection(),a=this.bounds_.getSouthWest(),e=this.bounds_.getNorthEast(),o={};o.sw=t.fromLatLngToDivPixel(a),o.ne=t.fromLatLngToDivPixel(e),o.sw2=t.fromLatLngToContainerPixel(a),o.ne2=t.fromLatLngToContainerPixel(e);var i=t.getWorldWidth();for(var s in this.prevCoords.sw&&o.ne.x<o.sw.x&&(Math.abs(this.prevCoords.sw.x-o.sw.x)>Math.abs(this.prevCoords.ne.x-o.ne.x)?o.sw.x=o.sw.x-i:o.ne.x=o.ne.x+i,Math.abs(this.prevCoords.sw2.x-o.sw2.x)>Math.abs(this.prevCoords.ne2.x-o.ne2.x)?o.sw2.x=o.sw2.x-i:o.ne2.x=o.ne2.x+i),this.prevCoords);var n=((this.prevCoords=o).ne2.x-o.sw2.x)/_data.svgDefault.viewBox[2],r=[_data.svgDefault.viewBox[0]-o.sw2.x/n,_data.svgDefault.viewBox[1]-o.ne2.y/n,_data.$map.width()/n,_data.$map.outerHeight()/n];d.setViewBox(r);var l=this.div_;l.style.left=o.sw.x+"px",l.style.top=o.ne.y+"px",l.style.width=o.ne.x-o.sw.x+"px",l.style.height=o.sw.y-o.ne.y+"px"}};var e=new google.maps.LatLng(_data.geoViewBox.bottomLat,_data.geoViewBox.leftLon),o=new google.maps.LatLng(_data.geoViewBox.topLat,_data.geoViewBox.rightLon),i=new google.maps.LatLngBounds(e,o);if(_data.googleMaps.overlay=new a(i,_data.googleMaps.map),_data.options.googleMaps.center&&_data.options.googleMaps.zoom)_data.googleMaps.map.setZoom(_data.options.googleMaps.zoom),_data.googleMaps.map.setCenter(_data.options.googleMaps.center);else{e=new google.maps.LatLng(_data.geoViewBox.bottomLat,_data.geoViewBox.leftLon),o=new google.maps.LatLng(_data.geoViewBox.topLat,_data.geoViewBox.rightLon),i=new google.maps.LatLngBounds(e,o);_data.googleMaps.map.fitBounds(i)}_data.options.googleMaps.initialized=!0,_data.googleMaps.map.addListener("idle",function(){_data.isZooming=!1}),google.maps.event.addListenerOnce(_data.googleMaps.map,"idle",function(){setTimeout(function(){_data.$map.addClass("mapsvg-fade-in"),setTimeout(function(){_data.$map.removeClass("mapsvg-google-map-loading"),_data.$map.removeClass("mapsvg-fade-in"),_data.options.googleMaps.center&&_data.options.googleMaps.zoom||(_data.options.googleMaps.center=_data.googleMaps.map.getCenter().toJSON(),_data.options.googleMaps.zoom=_data.googleMaps.map.getZoom()),d.trigger("googleMapsLoaded")},300)},1)})}else d.loadGoogleMapsAPI(function(){d.setGoogleMaps()},function(){d.setGoogleMaps({on:!1})});else _data.$map.toggleClass("mapsvg-with-google-map",!1),_data.$googleMaps&&_data.$googleMaps.hide(),_data.googleMaps.initialized=!1},loadGoogleMapsAPI:function(t,a){window.gm_authFailure=function(){MapSVG.GoogleMapBadApiKey?MapSVG.GoogleMapBadApiKey():alert("Google maps API key is incorrect.")},_data.googleMapsScript=document.createElement("script"),_data.googleMapsScript.onload=function(){MapSVG.googleMapsApiLoaded=!0,"function"==typeof t&&t()};var e="";_data.options.googleMaps.drawingTools&&(e="&libraries=drawing"),_data.googleMapsScript.src="https://maps.googleapis.com/maps/api/js?key="+_data.options.googleMaps.apiKey+e,document.head.appendChild(_data.googleMapsScript)},loadGoogleMapsDrawing:function(t,a){window.gm_authFailure=function(){MapSVG.GoogleMapBadApiKey?MapSVG.GoogleMapBadApiKey():alert("Google maps API key is incorrect.")},_data.googleMapsScript=document.createElement("script"),_data.googleMapsScript.onload=function(){MapSVG.googleMapsApiLoaded=!0,"function"==typeof t&&t()},document.head.appendChild(_data.googleMapsScript)},loadDetailsView:function(t){var a=this;a.popover&&a.popover.close(),a.detailsController&&a.detailsController.destroy(),a.detailsController=new MapSVG.DetailsController({autoresize:!MapSVG.isPhone&&_data.options.detailsView.autoresize,container:_data.$details,template:t instanceof Region?_data.templates.detailsViewRegion:_data.templates.detailsView,mapsvg:a,data:t instanceof Region?t.forTemplate():t,modal:a.shouldBeScrollable(_data.options.detailsView.location),scrollable:a.shouldBeScrollable(_data.options.detailsView.location),withToolbar:!MapSVG.isPhone&&a.shouldBeScrollable(_data.options.detailsView.location),width:_data.options.detailsView.width,events:{shown:function(t){_data.events["shown.detailsView"]&&_data.events["shown.detailsView"].call(this,a),a.trigger("detailsShown")},closed:function(t){a.deselectAllRegions(),_data.controllers&&_data.controllers.directory&&_data.controllers.directory.deselectItems(),_data.events["closed.detailsView"]&&_data.events["closed.detailsView"].call(this,a),a.trigger("detailsClosed")}}})},loadFiltersModal:function(){if("custom"!=_data.options.filters.modalLocation)if(_data.$filtersModal=_data.$filtersModal||$('<div class="mapsvg-details-container mapsvg-filters-wrap"></div>'),this.setColors(),MapSVG.isPhone)$("body").append(_data.$filtersModal);else{var t="$"+_data.options.filters.modalLocation;_data[t].append(_data.$filtersModal)}else _data.$filtersModal=$("#"+_data.options.filters.containerId);this.loadFiltersController(_data.$filtersModal,!0)},loadFiltersController:function(t,e){var a,o;e=void 0!==e&&e,o=MapSVG.isPhone?(a=!0,2<_this.filtersSchema.schema.length):(a=_data.options.menu.on&&_data.controllers.directory&&_data.options.menu.location===_data.options.filters.location,_data.options.filters.hide);var i=!a&&-1!==["leftSidebar","rightSidebar"].indexOf(_data.options.filters.location);new MapSVG.FiltersController({container:t,template:Handlebars.compile('<div class="mapsvg-filters-container"></div>'),mapsvg:_this,data:{},scrollable:i,modal:e,withToolbar:!MapSVG.isPhone&&!0===e,width:t.hasClass("mapsvg-map-container")?_data.options.filters.width:"100%",events:{shown:function(t){var a=this,i=new MapSVG.FormBuilder({container:this.contentView,filtersMode:!0,schema:_this.filtersSchema.getSchema(),modal:e,filtersHide:o,editMode:!1,mapsvg:_this,data:_this.database.query.filters,admin:!1,events:{load:function(){a.updateScroll(),_data.options.filters.hide&&_this.database.on("dataLoaded",function(){})}}});i.view.on("click",".mapsvg-btn-show-filters",function(){_this.loadFiltersModal()});var s="regions"===_data.options.filters.source?_this.regionsDatabase:_this.database;i.view.on("change keyup",'select,input[type="radio"],input',function(){var t={},a=$(this).data("parameter-name");if("distanceAddress"!==$(this).attr("name")){if("distanceLatLng"===$(this).attr("name")||"distanceLength"===$(this).attr("name")){var e={units:i.view.find('[name="distanceUnits"]').val(),latlng:i.view.find('[name="distanceLatLng"]').val(),length:i.view.find('[name="distanceLength"]').val(),address:i.view.find('[name="distanceAddress"]').val()};t.distance=e.units&&e.length&&e.latlng?e:null}else t[a]=$(this).val();s.query.setFilters(t);var o={filters:t};_data.options.menu.searchFallback&&(o.searchFallback=!0),s.getAll(o)}})},closed:function(t){}}})},setMenuMarkers:function(t){if(null!=(t=t||_data.options.menuMarkers).on&&(t.on=MapSVG.parseBoolean(t.on)),$.extend(!0,_data.options,{menuMarkers:t}),_data.menuDatabase="regions"==_data.options.menu.source?_data.regionsDatabase:_data.database,_data.$menuMarkers&&_data.$menuMarkers.off("click.menuMarkers.mapsvg"),_data.options.menuMarkers.on){var a=$("#"+_data.options.menuMarkers.containerId);a.length&&(_data.$menuMarkers||(a.is("ul")?_data.$menuMarkers=a:_data.$menuMarkers=$("<ul />").appendTo(a),_data.$menuMarkers.hasClass("mapsvg-menu-markers")||_data.$menuMarkers.addClass("mapsvg-menu-markers")),0===_data.$menuMarkers.children().length&&_data.markers.sort(function(t,a){return t.id==a.id?0:+(t.id>a.id)||-1}),_data.markers.forEach(function(t,a){_data.$menuMarkers.append(_data.options.menuMarkers.template(t))}),_data.$menuMarkers.on("click.menuMarkers.mapsvg","a",function(t){t.preventDefault();var a=$(this).attr("href").replace("#",""),e=_this.getMarker(a),o=e.getCenter();t={clientX:o[0],clientY:o[1]},_this.regionClickHandler(t,e)}).on("mouseover.menuMarkers.mapsvg","a",function(t){t.preventDefault();var a=$(this).attr("href").replace("#",""),e=_this.getMarker(a);_data.options.mouseOver&&_data.options.mouseOver.call(e,t,_this)}).on("mouseout.menuMarkers.mapsvg","a",function(t){t.preventDefault();var a=$(this).attr("href").replace("#",""),e=_this.getMarker(a);_data.options.mouseOut&&_data.options.mouseOut.call(e,t,_this)}))}},getRegion:function(t){return _data.regions[_data.regionsDict[t]]},getMarker:function(t){return _data.markers[_data.markersDict[t]]},checkId:function(t){return _this.getRegion(t)?{error:"This ID is already being used by a Region"}:!_this.getMarker(t)||{error:"This ID is already being used by another Marker"}},regionsRedrawColors:function(){_data.regions.forEach(function(t){t.setFill()})},destroy:function(){return _data.controllers&&_data.controllers.directory&&_data.controllers.directory.mobileButtons.remove(),_data.$map.empty().insertBefore(_data.$wrap).attr("style","").removeClass("mapsvg mapsvg-responsive"),_data.$wrap.remove(),instances[_data.$map.attr("id")]=void 0,_this},getData:function(){return _data},fitBounds:function(){},getScale:function(){return _data.$map.width()/_data.viewBox[2]||1},updateSize:function(){_data.scale=_this.getScale(),_this.popover&&_this.popover.adjustPosition(),_this.markersAdjustPosition(),_this.mapAdjustStrokes(),_data.directoryWrap&&_data.directoryWrap.height(_data.$wrap.outerHeight())},getViewBox:function(){return _data.viewBox},viewBoxSetBySize:function(t,a){return t=parseFloat(t),a=parseFloat(a),_this.setSize(t,a),_data._viewBox=_this.viewBoxGetBySize(t,a),_this.setViewBox(_data._viewBox),$(window).trigger("resize"),_this.setSize(t,a),_data.viewBox},viewBoxGetBySize:function(t,a){var e=t/a,o=_data.svgDefault.viewBox[2]/_data.svgDefault.viewBox[3],i=$.extend([],_data.svgDefault.viewBox);return e!=o&&(o<e?(i[2]=_data.svgDefault.viewBox[3]*e,i[0]=_data.svgDefault.viewBox[0]-(i[2]-_data.svgDefault.viewBox[2])/2):(i[3]=_data.svgDefault.viewBox[2]/e,i[1]=_data.svgDefault.viewBox[1]-(i[3]-_data.svgDefault.viewBox[3])/2)),i},viewBoxReset:function(t){if(_data.options.googleMaps.on)if(_data.options.googleMaps.center&&_data.options.googleMaps.zoom)_data.googleMaps.map.setZoom(_data.options.googleMaps.zoom),_data.googleMaps.map.setCenter(_data.options.googleMaps.center);else{var a=new google.maps.LatLng(_data.geoViewBox.bottomLat,_data.geoViewBox.leftLon),e=new google.maps.LatLng(_data.geoViewBox.topLat,_data.geoViewBox.rightLon),o=new google.maps.LatLngBounds(a,e);_data.googleMaps.map.fitBounds(o),_data.options.googleMaps.center=_data.googleMaps.map.getCenter().toJSON(),_data.options.googleMaps.zoom=_data.googleMaps.map.getZoom()}else if(t){var i=_data._viewBox||_data.svgDefault.viewBox;_data.zoomLevel=0,_data._scale=1,_this.setViewBox(i)}else _this.setViewBox()},getGeoViewBox:function(){var t=_data.viewBox,a=_this.convertSVGToGeo(t[0],t[1])[1],e=_this.convertSVGToGeo(t[0]+t[2],t[1])[1];return[a,_this.convertSVGToGeo(t[0],t[1])[0],e,_this.convertSVGToGeo(t[0],t[1]+t[3])[0]]},mapAdjustStrokes:function(){_data.$svg.find("path, polygon, circle, ellipse, rect").each(function(t){$(this).data("stroke-width")&&$(this).css("stroke-width",$(this).data("stroke-width")/_data.scale)})},zoomIn:function(t){if(_data.googleMaps.map){if(!_data.isZooming){_data.isZooming=!0;var a=_data.googleMaps.map.getZoom()+1;a=20<a?20:a,_data.googleMaps.map.setZoom(a)}}else _data.canZoom&&(_data.canZoom=!1,setTimeout(function(){_data.canZoom=!0},700),_this.zoom(1,t))},zoomOut:function(t){if(_data.googleMaps.map){if(!_data.isZooming&&_data.googleMaps.map.getZoom()-1>=_data.options.googleMaps.minZoom){_data.isZooming=!0;var a=_data.googleMaps.map.getZoom()-1;a=a<1?1:a,_data.googleMaps.map.setZoom(a)}}else _data.canZoom&&(_data.canZoom=!1,setTimeout(function(){_data.canZoom=!0},700),_this.zoom(-1,t))},touchZoomStart:function(t){_data._scale;_data.scale=_data.scale*zoom_k;_data._scale;_data._scale=_data._scale*zoom_k;var a=_data.viewBox[2],e=_data.viewBox[3],o=[];o[2]=_data._viewBox[2]/_data._scale,o[3]=_data._viewBox[3]/_data._scale,o[0]=_data.viewBox[0]+(a-o[2])/2,o[1]=viewBox[1]+(e-o[3])/2,_this.setViewBox(o)},touchZoomMove:function(){},touchZoomEnd:function(){},zoomTo:function(t,o){if(o=null!=o&&parseInt(o),"string"==typeof t&&(t=_this.getRegion(t)),_data.googleMaps.map)if(t instanceof Marker){var a=_this.convertSVGToGeo(t.x,t.y);_data.googleMaps.map.setZoom(o||1),_data.googleMaps.map.setCenter({lat:a[0],lng:a[1]})}else{var e=t.getGeoBounds(),i=new google.maps.LatLng(e.sw[0],e.sw[1]),s=new google.maps.LatLng(e.ne[0],e.ne[1]);e=new google.maps.LatLngBounds(i,s);_data.googleMaps.map.fitBounds(e)}else{var n=[],r=[];if("object"==typeof t&&void 0!==t.length){var l,d=[(n=t[0].getBBox())[0]],p=[n[1]],c=[f=n[0]+n[2]],g=[v=n[1]+n[3]];if(1<t.length)for(var h=1;h<t.length;h++){l=t[h].getBBox(),d.push(l[0]),p.push(l[1]);var u=l[0]+l[2],_=l[1]+l[3];c.push(u),g.push(_)}d=Math.min.apply(Math,d),p=Math.min.apply(Math,p);var f=Math.max.apply(Math,c)-d,v=Math.max.apply(Math,g)-p;n=[d,p,f,v]}else n=t.getBBox();if(t instanceof Marker){_data.zoomLevel=o||1;var m=_data.zoomLevels[_data.zoomLevel].viewBox;return _this.setViewBox([t.x-m[2]/2,t.y-m[3]/2,m[2],m[3]]),void(_data._scale=_data.zoomLevels[_data.zoomLevel]._scale)}r=[];$.each(_data.zoomLevels,function(t,a){if(r.length)if(n[2]>n[3]&&r[2]>n[2]&&n[2]>a.viewBox[2]){_data.zoomLevel=o||parseInt(t)-1;var e=_data.zoomLevels[_data.zoomLevel].viewBox;_this.setViewBox([n[0]-e[2]/2+n[2]/2,n[1]-e[3]/2+n[3]/2,e[2],e[3]]),_data._scale=_data.zoomLevels[_data.zoomLevel]._scale}else if(n[2]<n[3]&&r[3]>n[3]&&n[3]>a.viewBox[3]){_data.zoomLevel=o||parseInt(t)-1;e=_data.zoomLevels[_data.zoomLevel].viewBox;_this.setViewBox([n[0]-e[2]/2+n[2]/2,n[1]-e[3]/2+n[3]/2,e[2],e[3]]),_data._scale=_data.zoomLevels[_data.zoomLevel]._scale}r=a.viewBox})}},centerOn:function(t,a){if(_data.options.googleMaps.on){a=a?(a+12)/_this.getScale():0,_data.$map.addClass("scrolling");var e=t.getCenterLatLng(a);_data.googleMaps.map.setCenter(e),setTimeout(function(){_data.$map.removeClass("scrolling")},100)}else{a=a?(a+12)/_this.getScale():0;var o=t.getBBox(),i=_data.viewBox;_this.setViewBox([o[0]-i[2]/2+o[2]/2,o[1]-i[3]/2+o[3]/2-a,i[2],i[3]])}},zoom:function(t,a,e){var o=_data.viewBox[2],i=_data.viewBox[3],s=[],n=_data.zoomLevel>=_data.options.zoom.limit[0]&&_data.zoomLevel<=_data.options.zoom.limit[1];if(e)s[2]=_data._viewBox[2]/e,s[3]=_data._viewBox[3]/e;else{var r=0<t?1:-1;if(!_data.zoomLevels[_data.zoomLevel+r])return;if(_data._zoomLevel=_data.zoomLevel,_data._zoomLevel+=r,n&&(_data._zoomLevel>_data.options.zoom.limit[1]||_data._zoomLevel<_data.options.zoom.limit[0]))return!1;_data.zoomLevel=_data._zoomLevel;var l=_data.zoomLevels[_data.zoomLevel];_data._scale=l._scale,s=l.viewBox}var d=[];if(a){var p=0<r?.5:-1;d=[(a[0]-_data.viewBox[0])*p,(a[1]-_data.viewBox[1])*p],s[0]=_data.viewBox[0]+d[0],s[1]=_data.viewBox[1]+d[1]}else d=[(o-s[2])/2,(i-s[3])/2],s[0]=_data.viewBox[0]+d[0],s[1]=_data.viewBox[1]+d[1];_data.options.scroll.limit&&(s[0]<_data.svgDefault.viewBox[0]?s[0]=_data.svgDefault.viewBox[0]:s[0]+s[2]>_data.svgDefault.viewBox[0]+_data.svgDefault.viewBox[2]&&(s[0]=_data.svgDefault.viewBox[0]+_data.svgDefault.viewBox[2]-s[2]),s[1]<_data.svgDefault.viewBox[1]?s[1]=_data.svgDefault.viewBox[1]:s[1]+s[3]>_data.svgDefault.viewBox[1]+_data.svgDefault.viewBox[3]&&(s[1]=_data.svgDefault.viewBox[1]+_data.svgDefault.viewBox[3]-s[3])),_this.setViewBox(s)},markerDelete:function(t){_data.editingMarker&&_data.editingMarker.id==t.id&&(_data.editingMarker=null,delete _data.editingMarker),_data.markers.splice(_data.markersDict[t.id],1),_this.updateMarkersDict(),t=null,0==_data.markers.length&&(_data.options.markerLastID=0)},markerAdd:function(t){_data.layers.markers.append(t.node),_data.markers.push(t),_data.markersDict[t.id]=_data.markers.length-1},markerId:function(){_data.options.markerLastID=_data.options.markerLastID+1;var t="marker_"+_data.options.markerLastID;return _this.getMarker(t)?_this.markerId():t},markersAdjustPosition:function(){_data.markers.forEach(function(t){t.adjustPosition(_data.scale)})},markerMoveStart:function(){this.data("ox",parseFloat(this.attr("x"))),this.data("oy",parseFloat(this.attr("y")))},markerMove:function(t,a){t/=_data.scale,a/=_data.scale,this.attr({x:this.data("ox")+t,y:this.data("oy")+a})},markerMoveEnd:function(){this.data("ox")==this.attr("x")&&this.data("oy")==this.attr("y")&&options.markerEditHandler.call(this)},setEditingMarker:function(t){_data.editingMarker=_this.getMarker(t)},unsetEditingMarker:function(){_data.editingMarker=null},getEditingMarker:function(){return _data.editingMarker},scrollStart:function(t,a){if($(t.target).hasClass("mapsvg-btn-zoom")||$(t.target).closest(".mapsvg-gauge").length)return!1;if(_data.editMarkers.on&&"mapsvg-marker"==$(t.target).hasClass("class"))return!1;if(_data.isScrolling=!0,_data.$map.addClass("scrolling"),t.preventDefault(),MapSVG.touchDevice)var e=t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches[0]?t.originalEvent.touches[0]:t;else e=t;_data.scroll=_data.scroll||{},_data.scroll.vxi=_data.viewBox[0],_data.scroll.vyi=_data.viewBox[1],_data.scroll.x=e.clientX,_data.scroll.y=e.clientY,_data.scroll.dx=0,_data.scroll.dy=0,_data.scroll.vx=0,_data.scroll.vy=0,_data.scroll.gx=e.clientX,_data.scroll.gy=e.clientY,_data.scroll.tx=_data.scroll.tx||0,_data.scroll.ty=_data.scroll.ty||0,0===t.type.indexOf("mouse")&&($(document).on("mousemove.scroll.mapsvg",_this.scrollMove),_data.options.scroll.spacebar?$(document).on("keyup.scroll.mapsvg",function(t){32==t.keyCode&&_this.scrollEnd(t,a)}):$(document).on("mouseup.scroll.mapsvg",function(t){_this.scrollEnd(t,a)}))},scrollMove:function(t){t.preventDefault();var a=t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches[0]?t.originalEvent.touches[0]:t;if(_this.panBy(_data.scroll.gx-a.clientX,_data.scroll.gy-a.clientY)&&_data.googleMaps.map){var e=_data.googleMaps.map.getCenter(),o=_data.googleMaps.overlay.getProjection(),i=o.fromLatLngToDivPixel(e);i.x+=_data.scroll.gx-a.clientX,i.y+=_data.scroll.gy-a.clientY,e=o.fromDivPixelToLatLng(i),_data.googleMaps.map.setCenter(e)}_data.scroll.gx=a.clientX,_data.scroll.gy=a.clientY,_data.scroll.dx=_data.scroll.x-a.clientX,_data.scroll.dy=_data.scroll.y-a.clientY;var s=parseInt(_data.scroll.vxi+_data.scroll.dx/_data.scale),n=parseInt(_data.scroll.vyi+_data.scroll.dy/_data.scale);_data.options.scroll.limit&&(s<_data.svgDefault.viewBox[0]?s=_data.svgDefault.viewBox[0]:_data.viewBox[2]+s>_data.svgDefault.viewBox[0]+_data.svgDefault.viewBox[2]&&(s=_data.svgDefault.viewBox[0]+_data.svgDefault.viewBox[2]-_data.viewBox[2]),n<_data.svgDefault.viewBox[1]?n=_data.svgDefault.viewBox[1]:_data.viewBox[3]+n>_data.svgDefault.viewBox[1]+_data.svgDefault.viewBox[3]&&(n=_data.svgDefault.viewBox[1]+_data.svgDefault.viewBox[3]-_data.viewBox[3])),_data.scroll.vx=s,_data.scroll.vy=n},scrollEnd:function(t,a,e){_data.isScrolling=!1,_data.googleMaps&&_data.googleMaps.overlay&&_data.googleMaps.overlay.draw(),_data.$map.removeClass("scrolling"),$(document).off("keyup.scroll.mapsvg"),$(document).off("mousemove.scroll.mapsvg"),$(document).off("mouseup.scroll.mapsvg"),!0!==e&&Math.abs(_data.scroll.dx)<5&&Math.abs(_data.scroll.dy)<5&&(_data.editMarkers.on?_data.clickAddsMarker&&_this.markerAddClickHandler(t):_data.region_clicked&&_this.regionClickHandler(t,_data.region_clicked)),_data.viewBox[0]=_data.scroll.vx||_data.viewBox[0],_data.viewBox[1]=_data.scroll.vy||_data.viewBox[1]},panBy:function(t,a){var e=_data.scroll.tx-t,o=_data.scroll.ty-a;if(!_data.options.googleMaps.on&&_data.options.scroll.limit){var i=_data.$svg[0].getBoundingClientRect(),s=_data.$map[0].getBoundingClientRect();(i.left-t>s.left||i.right-t<s.right)&&(e=_data.scroll.tx),(i.top-a>s.top||i.bottom-a<s.bottom)&&(o=_data.scroll.ty)}return _data.$scrollpane.css({transform:"translate("+e+"px,"+o+"px)"}),_data.scroll.tx=e,_data.scroll.ty=o,!0},panTo:function(t,a){},scrollRegionClickHandler:function(t,a){_data.region_clicked=a},touchStart:function(t,a){t.preventDefault(),_data.isScrolling&&_this.scrollEnd(t,a,!0);var e=t.originalEvent;_data.options.zoom.on&&e.touches&&2==e.touches.length?(_data.touchZoomStartViewBox=_data.viewBox,_data.touchZoomStartScale=_data.scale,_data.touchZoomEnd=1,_data.scaleDistStart=Math.hypot(e.touches[0].pageX-e.touches[1].pageX,e.touches[0].pageY-e.touches[1].pageY)):e.touches&&1==e.touches.length&&_this.scrollStart(t,a),$(document).on("touchmove.scroll.mapsvg",function(t){t.preventDefault(),_this.touchMove(t,_this)}).on("touchend.scroll.mapsvg",function(t){t.preventDefault(),_this.touchEnd(t,_this)})},touchMove:function(t,a){t.preventDefault();var e=t.originalEvent;if(_data.options.zoom.on&&e.touches&&2==e.touches.length){if(MapSVG.ios||(e.scale=Math.hypot(e.touches[0].pageX-e.touches[1].pageX,e.touches[0].pageY-e.touches[1].pageY)/_data.scaleDistStart),1!=e.scale&&_data.canZoom){var o=1<e.scale?1:-1,i=e.touches[0].pageX>=e.touches[1].pageX?e.touches[0].pageX-(e.touches[0].pageX-e.touches[1].pageX)/2-_data.$svg.offset().left:e.touches[1].pageX-(e.touches[1].pageX-e.touches[0].pageX)/2-_data.$svg.offset().left,s=e.touches[0].pageY>=e.touches[1].pageY?e.touches[0].pageY-(e.touches[0].pageY-e.touches[1].pageY)-_data.$svg.offset().top:e.touches[1].pageY-(e.touches[1].pageY-e.touches[0].pageY)-_data.$svg.offset().top,n=_this.convertPixelToSVG([i,s]);0<o?_this.zoomIn(n):_this.zoomOut(n)}}else _data.isScrolling&&_this.scrollMove(t)},touchEnd:function(t,a){t.preventDefault();t.originalEvent;_data.touchZoomStart?(_data.touchZoomStart=!1,_data.touchZoomEnd=!1):_data.isScrolling&&_this.scrollEnd(t,a),$(document).off("touchmove.scroll.mapsvg"),$(document).off("touchend.scroll.mapsvg")},markersGroupHide:function(t){for(var a in _data.markers[t])_data.markers[t][a].hide()},markersGroupShow:function(t){for(var a in _data.markers[t])_data.markers[t][a].show()},regionsGroupSelect:function(t){for(var a in _data.markers[t])_data.markers[t][a].hide()},regionsGroupUnselect:function(t){for(var a in _data.markers[t])_data.markers[t][a].show()},markersGet:function(){return _data.markers},getSelected:function(){return _data.selected_id},selectRegion:function(t,a){if("string"==typeof t)var e=_this.getRegion(t);else e=t;if(!e)return!1;if(_data.options.multiSelect&&!_data.editRegions.on){if(e.selected){if(_this.deselectRegion(e),!a&&_data.options.menu.on){if("database"==_data.options.menu.source){if(e.objects&&e.objects.length)var o=e.objects.map(function(t){return t.id})}else o=[e.id];_data.controllers.directory.deselectItems(o)}return}}else if(0<_data.selected_id.length&&(_this.deselectAllRegions(),!a&&_data.options.menu.on)){if("database"==_data.options.menu.source){if(e.objects&&e.objects.length)o=e.objects.map(function(t){return t.id})}else o=[e.id];_data.controllers.directory.deselectItems()}if(_data.selected_id.push(e.id),e.select(),!a&&_data.options.menu.on&&_data.controllers&&_data.controllers.directory){if("database"==_data.options.menu.source)if(e.objects&&e.objects.length)o=e.objects.map(function(t){return t.id});else o=[e.id];else o=[e.id];_data.controllers.directory.selectItems(o)}},deselectAllRegions:function(){$.each(_data.selected_id,function(t,a){_this.deselectRegion(_this.getRegion(a))})},deselectRegion:function(t){if(t||(t=_this.getRegion(_data.selected_id[0])),t){t.deselect();var a=$.inArray(t.id,_data.selected_id);_data.selected_id.splice(a,1)}},highlightRegions:function(t){t.forEach(function(t){t.selected||t.disabled||(_data.highlightedRegions.push(t),t.highlight())})},unhighlightRegions:function(){_data.highlightedRegions.forEach(function(t){t.selected||t.disabled||t.unhighlight()}),_data.highlightedRegions=[]},convertMouseToSVG:function(t){var a=MapSVG.mouseCoords(t),e=a.x-_data.$svg.offset().left,o=a.y-_data.$svg.offset().top;return _this.convertPixelToSVG([e,o])},convertSVGToPixel:function(t){var a=_this.getScale();return[(t[0]-_data.svgDefault.viewBox[0])*a,(t[1]-_data.svgDefault.viewBox[1])*a]},convertPixelToSVG:function(t){var a=_this.getScale();return[t[0]/a+_data.svgDefault.viewBox[0],t[1]/a+_data.svgDefault.viewBox[1]]},convertGeoToSVG:function(t){var a=parseFloat(t[0]),e=(parseFloat(t[1])-_data.geoViewBox.leftLon)*(_data.svgDefault.viewBox[2]/_data.mapLonDelta),o=(a=3.14159*a/180,_data.svgDefault.viewBox[2]/_data.mapLonDelta*360/6.28318),i=o/2*Math.log((1+Math.sin(_data.mapLatBottomDegree))/(1-Math.sin(_data.mapLatBottomDegree))),s=_data.svgDefault.viewBox[3]-(o/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))-i);return[e+=_data.svgDefault.viewBox[0],s+=_data.svgDefault.viewBox[1]]},convertSVGToGeo:function(t,a){t-=_data.svgDefault.viewBox[0],a-=_data.svgDefault.viewBox[1];var e=_data.svgDefault.viewBox[2]/_data.mapLonDelta*360/(2*Math.PI),o=e/2*Math.log((1+Math.sin(_data.mapLatBottomDegree))/(1-Math.sin(_data.mapLatBottomDegree))),i=(_data.svgDefault.viewBox[3]+o-a)/e,s=180/Math.PI*(2*Math.atan(Math.exp(i))-Math.PI/2),n=_data.geoViewBox.leftLon+t/_data.svgDefault.viewBox[2]*_data.mapLonDelta;return[s=parseFloat(s.toFixed(6)),n=parseFloat(n.toFixed(6))]},convertGeoBoundsToViewBox:function(t,a){var e=parseFloat(coords[0]),o=(parseFloat(coords[1])-_data.geoViewBox.leftLon)*(_data.svgDefault.viewBox[2]/_data.mapLonDelta),i=(e=3.14159*e/180,_data.svgDefault.viewBox[2]/_data.mapLonDelta*360/6.28318),s=i/2*Math.log((1+Math.sin(_data.mapLatBottomDegree))/(1-Math.sin(_data.mapLatBottomDegree))),n=_data.svgDefault.viewBox[3]-(i/2*Math.log((1+Math.sin(e))/(1-Math.sin(e)))-s);return[o+=_data.svgDefault.viewBox[0],n+=_data.svgDefault.viewBox[1]]},pickGaugeColor:function(t){var a=(t-_data.options.gauge.min)/_data.options.gauge.maxAdjusted;return[Math.round(_data.options.gauge.colors.diffRGB.r*a+_data.options.gauge.colors.lowRGB.r),Math.round(_data.options.gauge.colors.diffRGB.g*a+_data.options.gauge.colors.lowRGB.g),Math.round(_data.options.gauge.colors.diffRGB.b*a+_data.options.gauge.colors.lowRGB.b),Math.round(_data.options.gauge.colors.diffRGB.a*a+_data.options.gauge.colors.lowRGB.a)]},isRegionDisabled:function(t,a){return!(!_data.options.regions[t]||!_data.options.regions[t].disabled&&"none"!=a)||!(null!=_data.options.regions[t]&&!MapSVG.parseBoolean(_data.options.regions[t].disabled)||!_data.options.disableAll&&"none"!=a&&"labels"!=t&&"Labels"!=t)},regionClickHandler:function(e,region,skipPopover){_data.region_clicked=null;var actions=_data.options.actions;if(!_data.eventsPrevent.click){if(_data.editRegions.on)return _this.selectRegion(region.id),void _data.regionEditHandler.call(region);if(region.isRegion()){if(_this.selectRegion(region.id),actions.region.click.zoom&&_this.zoomTo(region,actions.region.click.zoomToLevel),(_data.editMode||_data.options.menu.on)&&actions.region.click.filterDirectory&&_this.database.getAll({filters:{regions:region.id}}),actions.region.click.showDetails&&_this.loadDetailsView(region),actions.region.click.showPopover?actions.region.click.zoom?setTimeout(function(){_this.showPopover(region)},400):_this.showPopover(region):-1!==e.type.indexOf("touch")&&actions.region.touch.showPopover&&(actions.region.click.zoom?setTimeout(function(){_this.showPopover(region)},400):_this.showPopover(region)),actions.region.click.goToLink){var linkParts=actions.region.click.linkField.split("."),url;if(1<linkParts.length){var obj=linkParts.shift(),attr="."+linkParts.join(".");if("Region"==obj?region.data&&(url=eval("region.data"+attr)):region.objects&&region.objects[0]&&(url=eval("region.objects[0]"+attr)),url&&!_data.disableLinks){if(_data.editMode)return alert("Redirect: "+url+"\nLinks are disabled in the preview."),!0;if(actions.region.click.newTab){var win=window.open(url,"_blank");win.focus()}else window.location.href=url}}}if(actions.region.click.showAnotherMap){if(_data.editMode)return alert('"Show another map" functionality is disabled in the preview'),!0;var linkParts=actions.region.click.showAnotherMapField.split("."),url;if(1<linkParts.length){var obj=linkParts.shift(),attr="."+linkParts.join("."),map_id;if("Region"==obj?region.data&&(map_id=eval("region.data"+attr)):region.objects&&region.objects[0]&&(map_id=eval("region.objects[0]"+attr)),map_id){var container=MapSVG.parseBoolean(actions.region.click.showAnotherMapSameContainer)?_data.$map:$("#"+actions.region.click.showAnotherMapContainerId);jQuery.get(ajaxurl,{action:"mapsvg_get",id:map_id},function(data){container.find("svg").length&&container.mapSvg().destroy(),eval("var options = "+data),container.mapSvg(options)})}}}_data.events["click.region"]&&_data.events["click.region"].call(region,e,_this)}else if(region.isMarker()){var passingObject=region.object;if(actions.marker.click.zoom&&_this.zoomTo(region,actions.marker.click.zoomToLevel),(_data.editMode||_data.options.menu.on)&&actions.marker.click.filterDirectory&&_this.database.getAll({filters:{id:region.object.id}}),actions.marker.click.showDetails&&_this.loadDetailsView(passingObject),actions.marker.click.showPopover?actions.marker.click.zoom?setTimeout(function(){_this.showPopover(passingObject)},500):_this.showPopover(passingObject):-1!==e.type.indexOf("touch")&&actions.marker.touch.showPopover&&(actions.marker.click.zoom?setTimeout(function(){_this.showPopover(passingObject)},500):_this.showPopover(passingObject)),actions.marker.click.goToLink){var linkParts=actions.marker.click.linkField.split("."),url;if(1<linkParts.length){var obj=linkParts.shift(),attr="."+linkParts.join(".");if(url=eval("passingObject"+attr),url&&!_data.disableLinks&&_data.editMode)return alert("Redirect: "+url+"\nLinks are disabled in the preview."),!0;if(actions.marker.click.newTab){var win=window.open(url,"_blank");win.focus()}else window.location.href=url}}_data.events["click.marker"]&&_data.events["click.marker"].call(region,e,_this)}}},fileExists:function(t){if("data"==t.substr(0,4))return!0;var a=new XMLHttpRequest;return a.open("HEAD",t,!1),a.send(),404!=a.status},getStyle:function(t,a){if(t.currentStyle)var e=t.currentStyle.margin;else if(window.getComputedStyle)if(window.getComputedStyle.getPropertyValue)e=window.getComputedStyle(t,null).getPropertyValue(a);else e=window.getComputedStyle(t)[a];return e},search:function(a){var e=[];return a=a.toLowerCase(),_data.regions.forEach(function(t){(0===t.id.toLowerCase().indexOf(a)||-1!==t.id.toLowerCase().indexOf("-"+a)||t.title&&0===t.title.toLowerCase().indexOf(a))&&e.push({id:t.id,id_no_spaces:t.id_no_spaces})}),e},searchMarkers:function(a){var e=[];return a=a.toLowerCase(),_data.markers.forEach(function(t){0===t.id.toLowerCase().indexOf(a)&&e.push(t.id)}),e},searchData:function(t,e){var o=[];return e=e.toLowerCase(),_data.options.data.forEach(function(t){for(var a in t)0===(""+t[a]).toLowerCase().indexOf(e)&&-1==o.indexOf(t.id)&&o.push(t.id)}),o},hideMarkersExceptOne:function(a){_data.markers.forEach(function(t){t.id!=a&&t.node.addClass("mapsvg-marker-hidden")})},showMarkers:function(){_data.markers.forEach(function(t){t.node.removeClass("mapsvg-marker-hidden")})},markerAddClickHandler:function(t){if($(t.target).hasClass("mapsvg-marker"))return!1;var a=MapSVG.mouseCoords(t),e=a.x-_data.$svg.offset().left,o=a.y-_data.$svg.offset().top,i=_this.convertPixelToSVG([e,o]),s=_this.convertSVGToGeo(i[0],i[1]);if(!$.isNumeric(e)||!$.isNumeric(o))return!1;var n=new Location({x:i[0],y:i[1],lat:s[0],lng:s[1],img:MapSVG.defaultMarkerImage.split("/").pop()});if(_data.editingMarker)_data.editingMarker.setXy(i);else{var r=new Marker({location:n,mapsvg:this});_data.markerEditHandler&&_data.markerEditHandler.call(r)}},setMarkersEditMode:function(t,a){_data.editMarkers.on=MapSVG.parseBoolean(t),_data.clickAddsMarker=_data.editMarkers.on,_this.setEventHandlers()},setRegionsEditMode:function(t){_data.editRegions.on=MapSVG.parseBoolean(t),_this.deselectAllRegions(),_this.setEventHandlers()},setEditMode:function(t){_data.editMode=t},setDataEditMode:function(t){_data.editData.on=MapSVG.parseBoolean(t),_this.deselectAllRegions(),_this.setEventHandlers()},setMarkers:function(t){$.each(t,function(t,a){_this.markerAdd(a)}),_data.markers.sort(function(t,a){return t.id==a.id?0:+(t.id>a.id)||-1}),_data.markers.forEach(function(t,a){_data.markersDict[t.id]=a})},setEventHandler:function(){},textBr:function(t){for(var a=[],e=t.split(/\n/),o=jQuery(document.createElement("div")),i=0;i<e.length;i++)a.push(o.text(e[i]).html());return a.join("<br />")},runUserFunction:function(t){try{t()}catch(t){console.log("MapSVG user-defined function error: (line "+t.line+"): "+t.message)}},download:function(){_data.downloadForm||(_data.downloadForm=$('<form id="mdownload" action="/wp-content/plugins/mapsvg-dev/download.php" method="POST"><input type="hidden" name="svg_file" value="0" /><input type="hidden" name="svg_title"></form>'),_data.downloadForm.appendTo("body")),_data.downloadForm.find('input[name="svg_file"]').val(_data.$svg.prop("outerHTML")),_data.downloadForm.find('input[name="svg_title"]').val(_data.options.title),setTimeout(function(){jQuery("#mdownload").submit()},500)},showTooltip:function(t){t.length&&(_data.tooltip.container.html(t),_data.tooltip.container.addClass("mapsvg-tooltip-visible"))},popoverAdjustPosition:function(){if(_data.$popover&&_data.$popover.data("point")){var t=_this.convertSVGToPixel(_data.$popover.data("point"));_data.$popover.css({transform:"translateX(-50%) translate("+t[0]+"px,"+t[1]+"px)"})}},showPopover:function(t){var a,e=t instanceof Region?t:t.location&&t.location.marker&&t.location.marker?t.location.marker:null;e&&(a=e instanceof Marker?{x:e.x,y:e.y}:e.getCenterSVG(),_this.popover&&_this.popover.destroy(),_this.popover=new MapSVG.PopoverController({container:_data.$popover,point:a,yShift:e instanceof Marker?e.height:0,template:t instanceof Region?_data.templates.popoverRegion:_data.templates.popoverMarker,mapsvg:_this,data:t instanceof Region?t.forTemplate():t,mapObject:e,scrollable:!0,withToolbar:!MapSVG.isPhone||!_data.options.popovers.mobileFullscreen,events:{shown:function(t){if(_data.options.popovers.centerOn){var a=this.container.height()/2;!_data.options.popovers.centerOn||MapSVG.isPhone&&_data.options.popovers.mobileFullscreen||_this.centerOn(e,a)}_data.events["shown.popover"]&&_data.events["shown.popover"].call(this,_this),_data.popoverShowingFor=e,_this.trigger("popoverShown")},closed:function(t){_data.options.popovers.resetViewboxOnClose&&_this.viewBoxReset(!0),e instanceof Region&&(_data.popoverShowingFor=null),_data.events["closed.popover"]&&_data.events["closed.popover"].call(this,t),_this.trigger("popoverClosed")},resize:function(){if(_data.options.popovers.centerOn){var t=this.container.height()/2;!_data.options.popovers.centerOn||MapSVG.isPhone&&_data.options.popovers.mobileFullscreen||_this.centerOn(e,t)}}}}))},hidePopover:function(){_this.popover&&_this.popover.close()},hideTip:function(){_data.tooltip.container.removeClass("mapsvg-tooltip-visible")},popoverOffHandler:function(t){_data.isScrolling||$(t.target).closest(".mapsvg-popover").length||$(t.target).hasClass("mapsvg-btn-zoom")||this.popover&&this.popover.close()},mouseOverHandler:function(t){if(!_data.eventsPrevent.mouseover){var a,e;if(_data.options.tooltips.on)this instanceof Region&&(a="tooltipRegion",e=this.forTemplate()),this instanceof Marker&&(a="tooltipMarker",e=this.object),_data.popoverShowingFor!==this&&_this.showTooltip(_data.templates[a](e));if(_data.options.menu.on){if("database"==_data.options.menu.source){if(this instanceof Region&&this.objects.length)var o=this.objects.map(function(t){return t.id});if(this instanceof Marker)o=this.object.id}else{if(this instanceof Region)o=[this.id];if(this instanceof Marker&&this.object.regions&&this.object.regions.length)o=this.object.regions.map(function(t){return t.id})}_data.controllers.directory.highlightItems(o)}this instanceof Region?(this.selected||this.highlight(),_data.events["mouseover.region"]&&_data.events["mouseover.region"].call(this,t,_this)):_data.events["mouseover.marker"]&&_data.events["mouseover.marker"].call(this,t,_this)}},mouseOutHandler:function(t){_data.eventsPrevent.mouseout||(_data.options.tooltips.on&&_this.hideTip(),this instanceof Region?(this.selected||this.unhighlight(),_data.events["mouseout.region"]&&_data.events["mouseout.region"].call(this,t,_this)):_data.events["mouseout.marker"]&&_data.events["mouseout.marker"].call(this,t,_this),_data.options.menu.on&&_data.controllers.directory.unhighlightItems())},updateOptions:function(t){$.extend(!0,_data.options,t)},updateMarkersDict:function(){_data.markersDict={},_data.markers.forEach(function(t,a){_data.markersDict[t.id]=a})},eventsPrevent:function(t){_data.eventsPrevent[t]=!0},eventsRestore:function(t){t?_data.eventsPrevent[t]=!1:_data.eventsPrevent={}},setEventHandlers:function(){_data.$map.off(".common.mapsvg"),_data.$scrollpane.off(".common.mapsvg"),$(document).off("keydown.scroll.mapsvg"),$(document).off("mousemove.scrollInit.mapsvg"),$(document).off("mouseup.scrollInit.mapsvg");MapSVG.touchDevice,MapSVG.touchDevice;if(_data.editMarkers.on){var t=MapSVG.touchDevice?"touchstart.common.mapsvg":"mousedown.common.mapsvg";_data.$map.on(t,".mapsvg-marker",function(t){t.originalEvent.preventDefault();var a=_this.getMarker($(this).attr("id")),e=MapSVG.mouseCoords(t);a.drag(e,_data.scale,function(){_data.mapIsGeo&&(this.geoCoords=_this.convertSVGToGeo(this.x+this.width/2,this.y+(this.height-1))),_data.markerEditHandler&&_data.markerEditHandler.call(this,!0),this.onChange&&this.onChange.call(this)},function(){_data.markerEditHandler&&_data.markerEditHandler.call(this),this.onChange&&this.onChange.call(this)})})}_data.editMarkers.on||_data.$map.on("mouseover.common.mapsvg",".mapsvg-region",function(t){var a=$(this).attr("id");_this.mouseOverHandler.call(_this.getRegion(a),t,_this,options)}).on("mouseleave.common.mapsvg",".mapsvg-region",function(t){var a=$(this).attr("id");_this.mouseOutHandler.call(_this.getRegion(a),t,_this,options)}),_data.editRegions.on||_data.$map.on("mouseover.common.mapsvg",".mapsvg-marker",function(t){var a=$(this).attr("id");_this.mouseOverHandler.call(_this.getMarker(a),t,_this,options)}).on("mouseleave.common.mapsvg",".mapsvg-marker",function(t){var a=$(this).attr("id");_this.mouseOutHandler.call(_this.getMarker(a),t,_this,options)}),_data.options.scroll.spacebar?$(document).on("keydown.scroll.mapsvg",function(t){_data.isScrolling||32!=t.keyCode||(t.preventDefault(),_data.$map.addClass("mapsvg-scrollable"),$(document).on("mousemove.scrollInit.mapsvg",function(t){_data.isScrolling=!0,$(document).off("mousemove.scrollInit.mapsvg"),_this.scrollStart(t,_this)}).on("keyup.scroll.mapsvg",function(t){32==t.keyCode&&($(document).off("mousemove.scrollInit.mapsvg"),_data.$map.removeClass("mapsvg-scrollable"))}))}):_data.options.scroll.on?_data.$map.on("touchstart.common.mapsvg mousedown.common.mapsvg",function(t){if(!$(t.target).hasClass("mapsvg-popover")&&!$(t.target).closest(".mapsvg-popover").length){if(t.stopImmediatePropagation(),"touchstart"==t.type&&t.preventDefault(),t.target&&$(t.target).attr("class")&&-1!=$(t.target).attr("class").indexOf("mapsvg-region")){var a=_this.getRegion($(t.target).attr("id"));_this.scrollRegionClickHandler.call(_this,t,a)}else if(t.target&&$(t.target).attr("class")&&-1!=$(t.target).attr("class").indexOf("mapsvg-marker")){if(_data.editMarkers.on)return;a=_this.getMarker($(t.target).attr("id"));_this.scrollRegionClickHandler.call(_this,t,a)}"mousedown"==t.type?_this.scrollStart(t,_this):_this.touchStart(t,_this)}}):_data.editMarkers.on?_data.clickAddsMarker&&_data.$map.on("touchend.common.mapsvg mouseup.common.mapsvg",function(t){t.stopImmediatePropagation(),t.preventDefault(),_this.markerAddClickHandler(t)}):(_data.$map.on("touchstart.common.mapsvg",".mapsvg-region",function(t){_data.touchScrollStart=$("body").scrollTop()}),_data.$map.on("touchstart.common.mapsvg",".mapsvg-marker",function(t){_data.touchScrollStart=$("body").scrollTop()}),_data.$map.on("touchend.common.mapsvg mouseup.common.mapsvg",".mapsvg-region",function(t){t.stopImmediatePropagation(),t.preventDefault(),_data.touchScrollStart&&_data.touchScrollStart!=$("body").scrollTop()||_this.regionClickHandler.call(_this,t,_this.getRegion($(this).attr("id")))}),_data.$map.on("touchend.common.mapsvg mouseup.common.mapsvg",".mapsvg-marker",function(t){t.stopImmediatePropagation(),t.preventDefault(),_data.touchScrollStart&&_data.touchScrollStart!=$("body").scrollTop()||_this.regionClickHandler.call(_this,t,_this.getMarker($(this).attr("id")))}))},addLayer:function(t){_data.layers[t]=$('<div class="mapsvg-layer mapsvg-layer-'+t+'"></div>'),_data.$layers.append(_data.layers[t])},getDatabaseService:function(){return this.database},regionAdd:function(t){var a=new Region($(t),_data.options,_data.regionID,_this);return a.setStatus(1),_data.regions.push(a),_data.regions.sort(function(t,a){return t.id==a.id?0:+(t.id>a.id)||-1}),_data.regions.forEach(function(t,a){_data.regionsDict[t.id]=a}),a},regionDelete:function(t){var a=_data.regionsDict[t];if(void 0!==a){var e=_this.getRegion(t);e.node&&e.node.remove(),_data.regions.splice(a,1),delete _data.regionsDict[t]}else $("#"+t).length&&$("#"+t).remove()},reloadRegions:function(){var e=this;_data.regions=[],_data.regionsDict={},_data.$svg.find(".mapsvg-region").removeClass("mapsvg-region"),_data.$svg.find(".mapsvg-region-disabled").removeClass("mapsvg-region-disabled"),_data.$svg.find("path, polygon, circle, ellipse, rect").each(function(t){if(!$(this).closest("defs").length&&$(this)[0].getAttribute("id")&&(!_data.options.regionPrefix||_data.options.regionPrefix&&0===$(this)[0].getAttribute("id").indexOf(_data.options.regionPrefix))){var a=new Region($(this),_data.options,_data.regionID,e);_data.regions.push(a)}}),_data.regions.sort(function(t,a){return t.id==a.id?0:+(t.id>a.id)||-1}),_data.regions.forEach(function(t,a){_data.regionsDict[t.id]=a})},reloadRegionsFull:function(){var e=_this.regionsDatabase.getSchemaFieldByType("status");_this.regionsDatabase.getLoaded().forEach(function(t){var a=_this.getRegion(t.id);a&&(a.data=t,e&&void 0!==t.status&&null!==t.status&&a.setStatus(t.status))}),_this.loadDirectory(),_this.setGauge(),_this.setLayersControl(),_this.setGroups()},updateOutdatedOptions:function(t){t.menu&&(t.menu.position||t.menu.customContainer)&&(t.menu.customContainer?t.menu.location="custom":(t.menu.position="left"===t.menu.position?"left":"right",t.menu.location="left"===t.menu.position?"leftSidebar":"rightSidebar",t.containers&&t.containers[t.menu.location]||(t.containers=t.containers||{},t.containers[t.menu.location]={on:!1,width:"200px"}),t.containers[t.menu.location].width=t.menu.width,MapSVG.parseBoolean(t.menu.on)&&(t.containers[t.menu.location].on=!0)),delete t.menu.position,delete t.menu.width,delete t.menu.customContainer),!t.detailsView||"near"!==t.detailsView.location&&"top"!==t.detailsView.location||(t.detailsView.location="mapContainer")},init:function(t,a){if(!t.source)throw new Error("MapSVG: please provide SVG file source.");if(0===t.source.indexOf("//")?t.source=t.source.replace(/^\/\/[^\/]+/,"").replace("//","/"):t.source=t.source.replace(/^.*:\/\/[^\/]+/,"").replace("//","/"),(_data={}).editMode=t.editMode,delete t.editMode,_this.updateOutdatedOptions(t),_data.options=$.extend(!0,{},defaults,t),_this.id=_data.options.db_map_id,"new"==_this.id&&(_this.id=null),_data.highlightedRegions=[],_data.editRegions={on:!1},_data.editMarkers={on:!1},_data.editData={on:!1},_data.map=a,_data.$map=$(a),_data.$scrollpane=$('<div class="mapsvg-scrollpane"></div>').appendTo(_data.$map),_data.$layers=$('<div class="mapsvg-layers-wrap"></div>').appendTo(_data.$scrollpane),_data.whRatio=0,_data.isScrolling=!1,_data.markerOptions={},_data.svgDefault={},_data.refLength=0,_data.scale=1,_data._scale=1,_data.selected_id=[],_data.mapData={},_data.regions=[],_data.regionsDict={},_data.regionID={id:0},_data.markers=[],_data.markersDict={},_data._viewBox=[],_data.viewBox=[],_data.viewBoxZoom=[],_data.viewBoxFind=void 0,_data.zoomLevel=0,_data.scroll={},_data.layers={},_data.geoCoordinates=!1,_data.geoViewBox={leftLon:0,topLat:0,rightLon:0,bottomLat:0},_data.eventsPrevent={},_data.googleMaps={loaded:!1,initialized:!1,map:null},_this.setEvents(t.events),_data.events.beforeLoad)try{_data.events.beforeLoad.call(_this)}catch(t){}if(_data.events.beforeLoad&&_data.events.beforeLoad.beforeLoad&&"function"==typeof _data.events.beforeLoad.beforeLoad)try{_data.events.beforeLoad.beforeLoad.call(_this)}catch(t){}if(_data.$map.addClass("mapsvg").addClass("no-transitions").css("background",_data.options.colors.background),_this.setContainers(_data.options.containers),_this.setColors(),_data.$loading=$("<div>"+_data.options.loadingText+"</div>").addClass("mapsvg-loading"),_data.$map.append(_data.$loading),_this.addLayer("markers"),_this.addLayer("popovers"),_data.$loading.css({"margin-left":function(){return-$(this).outerWidth(!1)/2+"px"},"margin-top":function(){return-$(this).outerHeight(!1)/2+"px"}}),_data.options.googleMaps.on&&_data.$map.addClass("mapsvg-google-map-loading"),_data.options.extension&&$().mapSvg.extensions&&$().mapSvg.extensions[_data.options.extension]){var e=$().mapSvg.extensions[_data.options.extension];e&&e.common(_this)}return $.ajax({url:_data.options.source+"?v="+_data.options.svgFileVersion}).done(function(t){var a=$(t).find("svg");if(_data.$svg=a,_data.svgDefault.width=a.attr("width"),_data.svgDefault.height=a.attr("height"),_data.svgDefault.viewBox=a.attr("viewBox"),_data.svgDefault.width&&_data.svgDefault.height)_data.svgDefault.width=parseFloat(_data.svgDefault.width.replace(/px/g,"")),_data.svgDefault.height=parseFloat(_data.svgDefault.height.replace(/px/g,"")),_data.svgDefault.viewBox=_data.svgDefault.viewBox?_data.svgDefault.viewBox.split(" "):[0,0,_data.svgDefault.width,_data.svgDefault.height];else{if(!_data.svgDefault.viewBox)return alert("MapSVG needs width/height or viewBox parameter to be present in SVG file."),!1;_data.svgDefault.viewBox=_data.svgDefault.viewBox.split(" "),_data.svgDefault.width=parseFloat(_data.svgDefault.viewBox[2]),_data.svgDefault.height=parseFloat(_data.svgDefault.viewBox[3])}var e=a.attr("mapsvg:geoViewBox")||a.attr("mapsvg:geoviewbox");if(e&&4==(e=e.split(" ")).length&&(_data.mapIsGeo=!0,_data.geoCoordinates=!0,_data.geoViewBox={leftLon:parseFloat(e[0]),topLat:parseFloat(e[1]),rightLon:parseFloat(e[2]),bottomLat:parseFloat(e[3])},_data.mapLonDelta=_data.geoViewBox.rightLon-_data.geoViewBox.leftLon,_data.mapLatBottomDegree=3.14159*_data.geoViewBox.bottomLat/180),$.each(_data.svgDefault.viewBox,function(t,a){_data.svgDefault.viewBox[t]=parseFloat(a)}),_data._viewBox=4==_data.options.viewBox.length&&_data.options.viewBox||_data.svgDefault.viewBox,$.each(_data._viewBox,function(t,a){_data._viewBox[t]=parseFloat(a)}),a.attr("preserveAspectRatio","xMidYMid meet"),a.removeAttr("width"),a.removeAttr("height"),_this.reloadRegions(),_data.$scrollpane.append(a),_this.setSize(_data.options.width,_data.options.height,_data.options.responsive),_data.options.disableAll&&_this.setDisableAll(!0),_this.setViewBox(_data._viewBox),_this.setResponsive(_data.options.responsive,!0),_this.setScroll(_data.options.scroll,!0),_this.setZoom(_data.options.zoom),_this.setGoogleMaps(),_data.options.tooltipsMode&&(_data.options.tooltips.mode=_data.options.tooltipsMode),_this.setTooltips(_data.options.tooltips),_data.options.popover&&(_data.options.popovers=_data.options.popover),_this.setPopovers(_data.options.popovers),_data.options.cursor&&_this.setCursor(_data.options.cursor),_this.setTemplates(_data.options.templates),!_data.options.backend&&_data.options.extension&&$().mapSvg.extensions&&$().mapSvg.extensions[_data.options.extension]){var o=$().mapSvg.extensions[_data.options.extension];o&&o.frontend(_this)}if(_this.filtersSchema=new MapSVG.Filters(_data.options.filtersSchema),_this.database=new MapSVG.DatabaseService({map_id:_this.id,perpage:_data.options.database.pagination.on?_data.options.database.pagination.perpage:0,sortBy:"database"==_data.options.menu.source?_data.options.menu.sortBy:"id",sortDir:"database"==_data.options.menu.source?_data.options.menu.sortDirection:"desc",table:"database"},_this),_this.database.on("dataLoaded",function(){_this.addLocations(),_this.attachDataToRegions(),_this.loadDirectory(),_data.events.databaseLoaded&&_data.events.databaseLoaded.call(_this)}),_this.database.on("schemaChange",function(){_this.database.getAll()}),_this.regionsDatabase=new MapSVG.DatabaseService({map_id:_this.id,perpage:0,sortBy:"regions"==_data.options.menu.source?_data.options.menu.sortBy:"id",sortDir:"regions"==_data.options.menu.source?_data.options.menu.sortDirection:"desc",table:"regions"},_this),_this.regionsDatabase.on("dataLoaded",function(){_this.reloadRegionsFull(),_this.loadDirectory(),_data.events.regionsLoaded&&(_data.events.regionsLoaded.length&&0<_data.events.regionsLoaded.length?_this.trigger("regionsLoaded",_this):_data.events.regionsLoaded.call(_this))}),_data.menuDatabase="regions"==_data.options.menu.source?_this.regionsDatabase:_this.database,_this.setMenu(),_this.setFilters(),_data.options.menu.filterout.field){var i={};i[_data.options.menu.filterout.field]=_data.options.menu.filterout.val,"regions"==_data.options.menu.source||_this.database.query.setFilterOut(i)}_this.setEventHandlers(),_this.id?_this.regionsDatabase.getAll().done(function(t){_data.options.database.loadOnStart||_data.editMode?_this.database.getAll().done(function(t){_this.final()}):_this.final()}):_this.final()}),_this},final:function(){if(match=RegExp("[?&]mapsvg_select=([^&]*)").exec(window.location.search)){var t=decodeURIComponent(match[1].replace(/\+/g," "));_this.selectRegion(t)}if(setTimeout(function(){_this.updateSize(),setTimeout(function(){_data.$map.removeClass("no-transitions")},200)},100),_data.events.afterLoad&&"function"==typeof _data.events.afterLoad)try{_data.events.afterLoad.call(_this)}catch(t){console.log(t)}_data.options.afterLoad&&_data.options.afterLoad.call(_this),_data.options.dataLoaded&&_data.options.dataLoaded.call(),_data.$loading.hide()}};var _this=this.methods},$.fn.mapSvg=function(t){var a=$(this).attr("id");return"object"==typeof t&&void 0===instances[a]?(instances[a]=new mapSVG(this,t),instances[a].methods.init(t,this)):instances[a]?instances[a].methods:instances}}(jQuery),function(d){var l=/^\s+/,p=/\s+$/,o=0,s=d.round,c=d.min,g=d.max,t=d.random;function h(t,a){if(a=a||{},(t=t||"")instanceof h)return t;if(!(this instanceof h))return new h(t,a);var e=function(t){var a={r:0,g:0,b:0},e=1,o=!1,i=!1;"string"==typeof t&&(t=function(t){t=t.replace(l,"").replace(p,"").toLowerCase();var a,e=!1;if($[t])t=$[t],e=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};if(a=F.rgb.exec(t))return{r:a[1],g:a[2],b:a[3]};if(a=F.rgba.exec(t))return{r:a[1],g:a[2],b:a[3],a:a[4]};if(a=F.hsl.exec(t))return{h:a[1],s:a[2],l:a[3]};if(a=F.hsla.exec(t))return{h:a[1],s:a[2],l:a[3],a:a[4]};if(a=F.hsv.exec(t))return{h:a[1],s:a[2],v:a[3]};if(a=F.hsva.exec(t))return{h:a[1],s:a[2],v:a[3],a:a[4]};if(a=F.hex8.exec(t))return{a:(o=a[1],D(o)/255),r:D(a[2]),g:D(a[3]),b:D(a[4]),format:e?"name":"hex8"};var o;if(a=F.hex6.exec(t))return{r:D(a[1]),g:D(a[2]),b:D(a[3]),format:e?"name":"hex"};if(a=F.hex3.exec(t))return{r:D(a[1]+""+a[1]),g:D(a[2]+""+a[2]),b:D(a[3]+""+a[3]),format:e?"name":"hex"};return!1}(t));"object"==typeof t&&(P(t.r)&&P(t.g)&&P(t.b)?(s=t.r,n=t.g,r=t.b,a={r:255*V(s,255),g:255*V(n,255),b:255*V(r,255)},o=!0,i="%"===String(t.r).substr(-1)?"prgb":"rgb"):P(t.h)&&P(t.s)&&P(t.v)?(t.s=O(t.s),t.v=O(t.v),a=function(t,a,e){t=6*V(t,360),a=V(a,100),e=V(e,100);var o=d.floor(t),i=t-o,s=e*(1-a),n=e*(1-i*a),r=e*(1-(1-i)*a),l=o%6;return{r:255*[e,n,s,s,r,e][l],g:255*[r,e,e,n,s,s][l],b:255*[s,s,r,e,e,n][l]}}(t.h,t.s,t.v),o=!0,i="hsv"):P(t.h)&&P(t.s)&&P(t.l)&&(t.s=O(t.s),t.l=O(t.l),a=function(t,a,e){var o,i,s;function n(t,a,e){return e<0&&(e+=1),1<e&&(e-=1),e<1/6?t+6*(a-t)*e:e<.5?a:e<2/3?t+(a-t)*(2/3-e)*6:t}if(t=V(t,360),a=V(a,100),e=V(e,100),0===a)o=i=s=e;else{var r=e<.5?e*(1+a):e+a-e*a,l=2*e-r;o=n(l,r,t+1/3),i=n(l,r,t),s=n(l,r,t-1/3)}return{r:255*o,g:255*i,b:255*s}}(t.h,t.s,t.l),o=!0,i="hsl"),t.hasOwnProperty("a")&&(e=t.a));var s,n,r;return e=B(e),{ok:o,format:t.format||i,r:c(255,g(a.r,0)),g:c(255,g(a.g,0)),b:c(255,g(a.b,0)),a:e}}(t);this._originalInput=t,this._r=e.r,this._g=e.g,this._b=e.b,this._a=e.a,this._roundA=s(100*this._a)/100,this._format=a.format||e.format,this._gradientType=a.gradientType,this._r<1&&(this._r=s(this._r)),this._g<1&&(this._g=s(this._g)),this._b<1&&(this._b=s(this._b)),this._ok=e.ok,this._tc_id=o++}function i(t,a,e){t=V(t,255),a=V(a,255),e=V(e,255);var o,i,s=g(t,a,e),n=c(t,a,e),r=(s+n)/2;if(s==n)o=i=0;else{var l=s-n;switch(i=.5<r?l/(2-s-n):l/(s+n),s){case t:o=(a-e)/l+(a<e?6:0);break;case a:o=(e-t)/l+2;break;case e:o=(t-a)/l+4}o/=6}return{h:o,s:i,l:r}}function n(t,a,e){t=V(t,255),a=V(a,255),e=V(e,255);var o,i,s=g(t,a,e),n=c(t,a,e),r=s,l=s-n;if(i=0===s?0:l/s,s==n)o=0;else{switch(s){case t:o=(a-e)/l+(a<e?6:0);break;case a:o=(e-t)/l+2;break;case e:o=(t-a)/l+4}o/=6}return{h:o,s:i,v:r}}function a(t,a,e,o){var i=[L(s(t).toString(16)),L(s(a).toString(16)),L(s(e).toString(16))];return o&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function r(t,a,e,o){var i;return[L((i=o,d.round(255*parseFloat(i)).toString(16))),L(s(t).toString(16)),L(s(a).toString(16)),L(s(e).toString(16))].join("")}function e(t,a){a=0===a?0:a||10;var e=h(t).toHsl();return e.s-=a/100,e.s=G(e.s),h(e)}function u(t,a){a=0===a?0:a||10;var e=h(t).toHsl();return e.s+=a/100,e.s=G(e.s),h(e)}function _(t){return h(t).desaturate(100)}function f(t,a){a=0===a?0:a||10;var e=h(t).toHsl();return e.l+=a/100,e.l=G(e.l),h(e)}function v(t,a){a=0===a?0:a||10;var e=h(t).toRgb();return e.r=g(0,c(255,e.r-s(-a/100*255))),e.g=g(0,c(255,e.g-s(-a/100*255))),e.b=g(0,c(255,e.b-s(-a/100*255))),h(e)}function m(t,a){a=0===a?0:a||10;var e=h(t).toHsl();return e.l-=a/100,e.l=G(e.l),h(e)}function b(t,a){var e=h(t).toHsl(),o=(e.h+a)%360;return e.h=o<0?360+o:o,h(e)}function w(t){var a=h(t).toHsl();return a.h=(a.h+180)%360,h(a)}function y(t){var a=h(t).toHsl(),e=a.h;return[h(t),h({h:(e+120)%360,s:a.s,l:a.l}),h({h:(e+240)%360,s:a.s,l:a.l})]}function x(t){var a=h(t).toHsl(),e=a.h;return[h(t),h({h:(e+90)%360,s:a.s,l:a.l}),h({h:(e+180)%360,s:a.s,l:a.l}),h({h:(e+270)%360,s:a.s,l:a.l})]}function S(t){var a=h(t).toHsl(),e=a.h;return[h(t),h({h:(e+72)%360,s:a.s,l:a.l}),h({h:(e+216)%360,s:a.s,l:a.l})]}function M(t,a,e){a=a||6,e=e||30;var o=h(t).toHsl(),i=360/e,s=[h(t)];for(o.h=(o.h-(i*a>>1)+720)%360;--a;)o.h=(o.h+i)%360,s.push(h(o));return s}function k(t,a){a=a||6;for(var e=h(t).toHsv(),o=e.h,i=e.s,s=e.v,n=[],r=1/a;a--;)n.push(h({h:o,s:i,v:s})),s=(s+r)%1;return n}h.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,a,e,o=this.toRgb();return t=o.r/255,a=o.g/255,e=o.b/255,.2126*(t<=.03928?t/12.92:d.pow((t+.055)/1.055,2.4))+.7152*(a<=.03928?a/12.92:d.pow((a+.055)/1.055,2.4))+.0722*(e<=.03928?e/12.92:d.pow((e+.055)/1.055,2.4))},setAlpha:function(t){return this._a=B(t),this._roundA=s(100*this._a)/100,this},toHsv:function(){var t=n(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=n(this._r,this._g,this._b),a=s(360*t.h),e=s(100*t.s),o=s(100*t.v);return 1==this._a?"hsv("+a+", "+e+"%, "+o+"%)":"hsva("+a+", "+e+"%, "+o+"%, "+this._roundA+")"},toHsl:function(){var t=i(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=i(this._r,this._g,this._b),a=s(360*t.h),e=s(100*t.s),o=s(100*t.l);return 1==this._a?"hsl("+a+", "+e+"%, "+o+"%)":"hsla("+a+", "+e+"%, "+o+"%, "+this._roundA+")"},toHex:function(t){return a(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return r(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:s(this._r),g:s(this._g),b:s(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+s(this._r)+", "+s(this._g)+", "+s(this._b)+")":"rgba("+s(this._r)+", "+s(this._g)+", "+s(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:s(100*V(this._r,255))+"%",g:s(100*V(this._g,255))+"%",b:s(100*V(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+s(100*V(this._r,255))+"%, "+s(100*V(this._g,255))+"%, "+s(100*V(this._b,255))+"%)":"rgba("+s(100*V(this._r,255))+"%, "+s(100*V(this._g,255))+"%, "+s(100*V(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(C[a(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var a="#"+r(this._r,this._g,this._b,this._a),e=a,o=this._gradientType?"GradientType = 1, ":"";t&&(e=h(t).toHex8String());return"progid:DXImageTransform.Microsoft.gradient("+o+"startColorstr="+a+",endColorstr="+e+")"},toString:function(t){var a=!!t;t=t||this._format;var e=!1,o=this._a<1&&0<=this._a;return a||!o||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"name"!==t?("rgb"===t&&(e=this.toRgbString()),"prgb"===t&&(e=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(e=this.toHexString()),"hex3"===t&&(e=this.toHexString(!0)),"hex8"===t&&(e=this.toHex8String()),"name"===t&&(e=this.toName()),"hsl"===t&&(e=this.toHslString()),"hsv"===t&&(e=this.toHsvString()),e||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return h(this.toString())},_applyModification:function(t,a){var e=t.apply(null,[this].concat([].slice.call(a)));return this._r=e._r,this._g=e._g,this._b=e._b,this.setAlpha(e._a),this},lighten:function(){return this._applyModification(f,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(m,arguments)},desaturate:function(){return this._applyModification(e,arguments)},saturate:function(){return this._applyModification(u,arguments)},greyscale:function(){return this._applyModification(_,arguments)},spin:function(){return this._applyModification(b,arguments)},_applyCombination:function(t,a){return t.apply(null,[this].concat([].slice.call(a)))},analogous:function(){return this._applyCombination(M,arguments)},complement:function(){return this._applyCombination(w,arguments)},monochromatic:function(){return this._applyCombination(k,arguments)},splitcomplement:function(){return this._applyCombination(S,arguments)},triad:function(){return this._applyCombination(y,arguments)},tetrad:function(){return this._applyCombination(x,arguments)}},h.fromRatio=function(t,a){if("object"==typeof t){var e={};for(var o in t)t.hasOwnProperty(o)&&(e[o]="a"===o?t[o]:O(t[o]));t=e}return h(t,a)},h.equals=function(t,a){return!(!t||!a)&&h(t).toRgbString()==h(a).toRgbString()},h.random=function(){return h.fromRatio({r:t(),g:t(),b:t()})},h.mix=function(t,a,e){e=0===e?0:e||50;var o,i=h(t).toRgb(),s=h(a).toRgb(),n=e/100,r=2*n-1,l=s.a-i.a,d=1-(o=((o=r*l==-1?r:(r+l)/(1+r*l))+1)/2);return h({r:s.r*o+i.r*d,g:s.g*o+i.g*d,b:s.b*o+i.b*d,a:s.a*n+i.a*(1-n)})},h.readability=function(t,a){var e=h(t),o=h(a);return(d.max(e.getLuminance(),o.getLuminance())+.05)/(d.min(e.getLuminance(),o.getLuminance())+.05)},h.isReadable=function(t,a,e){var o,i,s=h.readability(t,a);switch(i=!1,(o=function(t){var a,e;a=((t=t||{level:"AA",size:"small"}).level||"AA").toUpperCase(),e=(t.size||"small").toLowerCase(),"AA"!==a&&"AAA"!==a&&(a="AA");"small"!==e&&"large"!==e&&(e="small");return{level:a,size:e}}(e)).level+o.size){case"AAsmall":case"AAAlarge":i=4.5<=s;break;case"AAlarge":i=3<=s;break;case"AAAsmall":i=7<=s}return i},h.mostReadable=function(t,a,e){var o,i,s,n,r=null,l=0;i=(e=e||{}).includeFallbackColors,s=e.level,n=e.size;for(var d=0;d<a.length;d++)l<(o=h.readability(t,a[d]))&&(l=o,r=h(a[d]));return h.isReadable(t,r,{level:s,size:n})||!i?r:(e.includeFallbackColors=!1,h.mostReadable(t,["#fff","#000"],e))};var $=h.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},C=h.hexNames=function(t){var a={};for(var e in t)t.hasOwnProperty(e)&&(a[t[e]]=e);return a}($);function B(t){return t=parseFloat(t),(isNaN(t)||t<0||1<t)&&(t=1),t}function V(t,a){var e;"string"==typeof(e=t)&&-1!=e.indexOf(".")&&1===parseFloat(e)&&(t="100%");var o,i="string"==typeof(o=t)&&-1!=o.indexOf("%");return t=c(a,g(0,parseFloat(t))),i&&(t=parseInt(t*a,10)/100),d.abs(t-a)<1e-6?1:t%a/parseFloat(a)}function G(t){return c(1,g(0,t))}function D(t){return parseInt(t,16)}function L(t){return 1==t.length?"0"+t:""+t}function O(t){return t<=1&&(t=100*t+"%"),t}var R,T,j,F=(T="[\\s|\\(]+("+(R="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",j="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",{CSS_UNIT:new RegExp(R),rgb:new RegExp("rgb"+T),rgba:new RegExp("rgba"+j),hsl:new RegExp("hsl"+T),hsla:new RegExp("hsla"+j),hsv:new RegExp("hsv"+T),hsva:new RegExp("hsva"+j),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function P(t){return!!F.CSS_UNIT.exec(t)}MapSVG.tinycolor=h,"undefined"!=typeof module&&module.exports?module.exports=h:"function"==typeof define&&define.amd&&define(function(){return h})}(Math);
!function(o){function t(e){var t=e||window.event,n=[].slice.call(arguments,1),i=0,l=0,s=0;return(e=o.event.fix(t)).type="mousewheel",t.wheelDelta&&(i=t.wheelDelta/120),t.detail&&(i=-t.detail/3),s=i,void 0!==t.axis&&t.axis===t.HORIZONTAL_AXIS&&(s=0,l=-1*i),void 0!==t.wheelDeltaY&&(s=t.wheelDeltaY/120),void 0!==t.wheelDeltaX&&(l=-1*t.wheelDeltaX/120),n.unshift(e,i,l,s),(o.event.dispatch||o.event.handle).apply(this,n)}var n=["DOMMouseScroll","mousewheel"];if(o.event.fixHooks)for(var e=n.length;e;)o.event.fixHooks[n[--e]]=o.event.mouseHooks;o.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null}},o.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery);
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Handlebars=e():t.Handlebars=e()}(this,function(){return function(r){var s={};function i(t){if(s[t])return s[t].exports;var e=s[t]={exports:{},id:t,loaded:!1};return r[t].call(e.exports,e,e.exports,i),e.loaded=!0,e.exports}return i.m=r,i.c=s,i.p="",i(0)}([function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0;var i=s(r(2)),n=s(r(21)),a=r(22),o=r(27),c=s(r(28)),h=s(r(25)),l=s(r(20)),p=i.default.create;function u(){var r=p();return r.compile=function(t,e){return o.compile(t,e,r)},r.precompile=function(t,e){return o.precompile(t,e,r)},r.AST=n.default,r.Compiler=o.Compiler,r.JavaScriptCompiler=c.default,r.Parser=a.parser,r.parse=a.parse,r}var f=u();f.create=u,l.default(f),f.Visitor=h.default,f.default=f,e.default=f,t.exports=e.default},function(t,e){"use strict";e.default=function(t){return t&&t.__esModule?t:{default:t}},e.__esModule=!0},function(t,e,r){"use strict";var s=r(3).default,i=r(1).default;e.__esModule=!0;var n=s(r(4)),a=i(r(18)),o=i(r(6)),c=s(r(5)),h=s(r(19)),l=i(r(20));function p(){var e=new n.HandlebarsEnvironment;return c.extend(e,n),e.SafeString=a.default,e.Exception=o.default,e.Utils=c,e.escapeExpression=c.escapeExpression,e.VM=h,e.template=function(t){return h.template(t,e)},e}var u=p();u.create=p,l.default(u),u.default=u,e.default=u,t.exports=e.default},function(t,e){"use strict";e.default=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},e.__esModule=!0},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0,e.HandlebarsEnvironment=l;var i=r(5),n=s(r(6)),a=r(7),o=r(15),c=s(r(17));e.VERSION="4.0.2";e.COMPILER_REVISION=7;e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};var h="[object Object]";function l(t,e,r){this.helpers=t||{},this.partials=e||{},this.decorators=r||{},a.registerDefaultHelpers(this),o.registerDefaultDecorators(this)}l.prototype={constructor:l,logger:c.default,log:c.default.log,registerHelper:function(t,e){if(i.toString.call(t)===h){if(e)throw new n.default("Arg not supported with multiple helpers");i.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(i.toString.call(t)===h)i.extend(this.partials,t);else{if(void 0===e)throw new n.default("Attempting to register a partial as undefined");this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(i.toString.call(t)===h){if(e)throw new n.default("Arg not supported with multiple decorators");i.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]}};var p=c.default.log;e.log=p,e.createFrame=i.createFrame,e.logger=c.default},function(t,e){"use strict";e.__esModule=!0,e.extend=a,e.indexOf=function(t,e){for(var r=0,s=t.length;r<s;r++)if(t[r]===e)return r;return-1},e.escapeExpression=function(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return i.test(t)?t.replace(s,n):t},e.isEmpty=function(t){return!t&&0!==t||!(!h(t)||0!==t.length)},e.createFrame=function(t){var e=a({},t);return e._parent=t,e},e.blockParams=function(t,e){return t.path=e,t},e.appendContextPath=function(t,e){return(t?t+".":"")+e};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},s=/[&<>"'`=]/g,i=/[&<>"'`=]/;function n(t){return r[t]}function a(t){for(var e=1;e<arguments.length;e++)for(var r in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],r)&&(t[r]=arguments[e][r]);return t}var o=Object.prototype.toString;e.toString=o;var c=function(t){return"function"==typeof t};c(/x/)&&(e.isFunction=c=function(t){return"function"==typeof t&&"[object Function]"===o.call(t)}),e.isFunction=c;var h=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===o.call(t)};e.isArray=h},function(t,e){"use strict";e.__esModule=!0;var o=["description","fileName","lineNumber","message","name","number","stack"];function c(t,e){var r=e&&e.loc,s=void 0,i=void 0;r&&(t+=" - "+(s=r.start.line)+":"+(i=r.start.column));for(var n=Error.prototype.constructor.call(this,t),a=0;a<o.length;a++)this[o[a]]=n[o[a]];Error.captureStackTrace&&Error.captureStackTrace(this,c),r&&(this.lineNumber=s,this.column=i)}c.prototype=new Error,e.default=c,t.exports=e.default},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0,e.registerDefaultHelpers=function(t){i.default(t),n.default(t),a.default(t),o.default(t),c.default(t),h.default(t),l.default(t)};var i=s(r(8)),n=s(r(9)),a=s(r(10)),o=s(r(11)),c=s(r(12)),h=s(r(13)),l=s(r(14))},function(t,e,r){"use strict";e.__esModule=!0;var a=r(5);e.default=function(n){n.registerHelper("blockHelperMissing",function(t,e){var r=e.inverse,s=e.fn;if(!0===t)return s(this);if(!1===t||null==t)return r(this);if(a.isArray(t))return 0<t.length?(e.ids&&(e.ids=[e.name]),n.helpers.each(t,e)):r(this);if(e.data&&e.ids){var i=a.createFrame(e.data);i.contextPath=a.appendContextPath(e.data.contextPath,e.name),e={data:i}}return s(t,e)})},t.exports=e.default},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0;var u=r(5),f=s(r(6));e.default=function(t){t.registerHelper("each",function(s,t){if(!t)throw new f.default("Must pass iterator to #each");var i=t.fn,e=t.inverse,r=0,n="",a=void 0,o=void 0;function c(t,e,r){null!=s[t]&&(a&&(a.key=t,a.index=e,a.first=0===e,a.last=!!r,o&&(a.contextPath=o+t)),n+=i(s[t],{data:a,blockParams:u.blockParams([s[t],t],[o+t,null])}))}if(t.data&&t.ids&&(o=u.appendContextPath(t.data.contextPath,t.ids[0])+"."),u.isFunction(s)&&(s=s.call(this)),t.data&&(a=u.createFrame(t.data)),s&&"object"==typeof s)if(u.isArray(s))for(var h=s.length;r<h;r++)c(r,r,r===s.length-1);else{var l=void 0;for(var p in s)s.hasOwnProperty(p)&&(void 0!==l&&c(l,r-1),l=p,r++);void 0!==l&&c(l,r-1,!0)}return 0===r&&(n=e(this)),n})},t.exports=e.default},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0;var i=s(r(6));e.default=function(t){t.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new i.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var s=r(5);e.default=function(r){r.registerHelper("if",function(t,e){return s.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||s.isEmpty(t)?e.inverse(this):e.fn(this)}),r.registerHelper("unless",function(t,e){return r.helpers.if.call(this,t,{fn:e.inverse,inverse:e.fn,hash:e.hash})})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(i){i.registerHelper("log",function(){for(var t=[void 0],e=arguments[arguments.length-1],r=0;r<arguments.length-1;r++)t.push(arguments[r]);var s=1;null!=e.hash.level?s=e.hash.level:e.data&&null!=e.data.level&&(s=e.data.level),t[0]=s,i.log.apply(i,t)})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",function(t,e){return t&&t[e]})},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var i=r(5);e.default=function(t){t.registerHelper("with",function(t,e){i.isFunction(t)&&(t=t.call(this));var r=e.fn;if(i.isEmpty(t))return e.inverse(this);var s=e.data;return e.data&&e.ids&&((s=i.createFrame(e.data)).contextPath=i.appendContextPath(e.data.contextPath,e.ids[0])),r(t,{data:s,blockParams:i.blockParams([t],[s&&s.contextPath])})})},t.exports=e.default},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0,e.registerDefaultDecorators=function(t){i.default(t)};var i=s(r(16))},function(t,e,r){"use strict";e.__esModule=!0;var o=r(5);e.default=function(t){t.registerDecorator("inline",function(i,n,a,t){var e=i;return n.partials||(n.partials={},e=function(t,e){var r=a.partials;a.partials=o.extend({},r,n.partials);var s=i(t,e);return a.partials=r,s}),n.partials[t.args[0]]=t.fn,e})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=n.methodMap.indexOf(t.toLowerCase());t=0<=e?e:parseInt(t,10)}return t},log:function(t){if(t=n.lookupLevel(t),"undefined"!=typeof console&&n.lookupLevel(n.level)<=t){var e=n.methodMap[t];console[e]||(e="log");for(var r=arguments.length,s=Array(1<r?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];console[e].apply(console,s)}}};e.default=n,t.exports=e.default},function(t,e){"use strict";function r(t){this.string=t}e.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},e.default=r,t.exports=e.default},function(t,e,r){"use strict";var s=r(3).default,i=r(1).default;e.__esModule=!0,e.checkRevision=function(t){var e=t&&t[0]||1,r=u.COMPILER_REVISION;if(e!==r){if(e<r){var s=u.REVISION_CHANGES[r],i=u.REVISION_CHANGES[e];throw new p.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+s+") or downgrade your runtime to an older version ("+i+").")}throw new p.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}},e.template=function(o,c){if(!c)throw new p.default("No environment passed to template");if(!o||!o.main)throw new p.default("Unknown template object: "+typeof o);o.main.decorator=o.main_d,c.VM.checkRevision(o.compiler);var a={strict:function(t,e){if(!(e in t))throw new p.default('"'+e+'" not defined in '+t);return t[e]},lookup:function(t,e){for(var r=t.length,s=0;s<r;s++)if(t[s]&&null!=t[s][e])return t[s][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:l.escapeExpression,invokePartial:function(t,e,r){r.hash&&(e=l.extend({},e,r.hash),r.ids&&(r.ids[0]=!0));t=c.VM.resolvePartial.call(this,t,e,r);var s=c.VM.invokePartial.call(this,t,e,r);null==s&&c.compile&&(r.partials[r.name]=c.compile(t,o.compilerOptions,c),s=r.partials[r.name](e,r));{if(null==s)throw new p.default("The partial "+r.name+" could not be compiled when running in runtime-only mode");if(r.indent){for(var i=s.split("\n"),n=0,a=i.length;n<a&&(i[n]||n+1!==a);n++)i[n]=r.indent+i[n];s=i.join("\n")}return s}},fn:function(t){var e=o[t];return e.decorator=o[t+"_d"],e},programs:[],program:function(t,e,r,s,i){var n=this.programs[t],a=this.fn(t);return e||i||s||r?n=f(this,t,a,e,r,s,i):n||(n=this.programs[t]=f(this,t,a)),n},data:function(t,e){for(;t&&e--;)t=t._parent;return t},merge:function(t,e){var r=t||e;return t&&e&&t!==e&&(r=l.extend({},e,t)),r},noop:c.VM.noop,compilerInfo:o.compiler};function h(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=e.data;h._setup(e),!e.partial&&o.useData&&(r=function(t,e){e&&"root"in e||((e=e?u.createFrame(e):{}).root=t);return e}(t,r));var s=void 0,i=o.useBlockParams?[]:void 0;function n(t){return""+o.main(a,t,a.helpers,a.partials,r,i,s)}return o.useDepths&&(s=e.depths?t!==e.depths[0]?[t].concat(e.depths):e.depths:[t]),(n=d(o.main,n,a,e.depths||[],r,i))(t,e)}return h.isTop=!0,h._setup=function(t){t.partial?(a.helpers=t.helpers,a.partials=t.partials,a.decorators=t.decorators):(a.helpers=a.merge(t.helpers,c.helpers),o.usePartial&&(a.partials=a.merge(t.partials,c.partials)),(o.usePartial||o.useDecorators)&&(a.decorators=a.merge(t.decorators,c.decorators)))},h._child=function(t,e,r,s){if(o.useBlockParams&&!r)throw new p.default("must pass block params");if(o.useDepths&&!s)throw new p.default("must pass parent depths");return f(a,t,o[t],e,0,r,s)},h},e.wrapProgram=f,e.resolvePartial=function(t,e,r){t?t.call||r.name||(r.name=t,t=r.partials[t]):t="@partial-block"===r.name?r.data["partial-block"]:r.partials[r.name];return t},e.invokePartial=function(t,e,r){r.partial=!0,r.ids&&(r.data.contextPath=r.ids[0]||r.data.contextPath);var s=void 0;r.fn&&r.fn!==n&&(s=r.data["partial-block"]=r.fn).partials&&(r.partials=l.extend({},r.partials,s.partials));void 0===t&&s&&(t=s);{if(void 0===t)throw new p.default("The partial "+r.name+" could not be found");if(t instanceof Function)return t(e,r)}},e.noop=n;var l=s(r(5)),p=i(r(6)),u=r(4);function f(s,t,i,n,e,a,o){function r(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=o;return o&&t!==o[0]&&(r=[t].concat(o)),i(s,t,s.helpers,s.partials,e.data||n,a&&[e.blockParams].concat(a),r)}return(r=d(i,r,s,o,n,a)).program=t,r.depth=o?o.length:0,r.blockParams=e||0,r}function n(){return""}function d(t,e,r,s,i,n){if(t.decorator){var a={};e=t.decorator(e,a,r,s&&s[0],i,n,s),l.extend(e,a)}return e}},function(t,e){(function(s){"use strict";e.__esModule=!0,e.default=function(t){var e=void 0!==s?s:window,r=e.Handlebars;t.noConflict=function(){e.Handlebars===t&&(e.Handlebars=r)}},t.exports=e.default}).call(e,function(){return this}())},function(t,e){"use strict";e.__esModule=!0;var r={helpers:{helperExpression:function(t){return"SubExpression"===t.type||("MustacheStatement"===t.type||"BlockStatement"===t.type)&&!!(t.params&&t.params.length||t.hash)},scopedId:function(t){return/^\.|this\b/.test(t.original)},simpleId:function(t){return 1===t.parts.length&&!r.helpers.scopedId(t)&&!t.depth}}};e.default=r,t.exports=e.default},function(t,e,r){"use strict";var s=r(1).default,i=r(3).default;e.__esModule=!0,e.parse=function(t,e){return"Program"!==t.type?((n.default.yy=h).locInfo=function(t){return new h.SourceLocation(e&&e.srcName,t)},new a.default(e).accept(n.default.parse(t))):t};var n=s(r(23)),a=s(r(24)),o=i(r(26)),c=r(5);e.parser=n.default;var h={};c.extend(h,o)},function(t,e){"use strict";var r=function(){var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition_plus0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,1],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(t,e,r,s,i,n,a){var o=n.length-1;switch(i){case 1:return n[o-1];case 2:this.$=s.prepareProgram(n[o]);break;case 3:case 4:case 5:case 6:case 7:case 8:this.$=n[o];break;case 9:this.$={type:"CommentStatement",value:s.stripComment(n[o]),strip:s.stripFlags(n[o],n[o]),loc:s.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:n[o],value:n[o],loc:s.locInfo(this._$)};break;case 11:this.$=s.prepareRawBlock(n[o-2],n[o-1],n[o],this._$);break;case 12:this.$={path:n[o-3],params:n[o-2],hash:n[o-1]};break;case 13:this.$=s.prepareBlock(n[o-3],n[o-2],n[o-1],n[o],!1,this._$);break;case 14:this.$=s.prepareBlock(n[o-3],n[o-2],n[o-1],n[o],!0,this._$);break;case 15:this.$={open:n[o-5],path:n[o-4],params:n[o-3],hash:n[o-2],blockParams:n[o-1],strip:s.stripFlags(n[o-5],n[o])};break;case 16:case 17:this.$={path:n[o-4],params:n[o-3],hash:n[o-2],blockParams:n[o-1],strip:s.stripFlags(n[o-5],n[o])};break;case 18:this.$={strip:s.stripFlags(n[o-1],n[o-1]),program:n[o]};break;case 19:var c=s.prepareBlock(n[o-2],n[o-1],n[o],n[o],!1,this._$),h=s.prepareProgram([c],n[o-1].loc);h.chained=!0,this.$={strip:n[o-2].strip,program:h,chain:!0};break;case 20:this.$=n[o];break;case 21:this.$={path:n[o-1],strip:s.stripFlags(n[o-2],n[o])};break;case 22:case 23:this.$=s.prepareMustache(n[o-3],n[o-2],n[o-1],n[o-4],s.stripFlags(n[o-4],n[o]),this._$);break;case 24:this.$={type:"PartialStatement",name:n[o-3],params:n[o-2],hash:n[o-1],indent:"",strip:s.stripFlags(n[o-4],n[o]),loc:s.locInfo(this._$)};break;case 25:this.$=s.preparePartialBlock(n[o-2],n[o-1],n[o],this._$);break;case 26:this.$={path:n[o-3],params:n[o-2],hash:n[o-1],strip:s.stripFlags(n[o-4],n[o])};break;case 27:case 28:this.$=n[o];break;case 29:this.$={type:"SubExpression",path:n[o-3],params:n[o-2],hash:n[o-1],loc:s.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:n[o],loc:s.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:s.id(n[o-2]),value:n[o],loc:s.locInfo(this._$)};break;case 32:this.$=s.id(n[o-1]);break;case 33:case 34:this.$=n[o];break;case 35:this.$={type:"StringLiteral",value:n[o],original:n[o],loc:s.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(n[o]),original:Number(n[o]),loc:s.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===n[o],original:"true"===n[o],loc:s.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:s.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:s.locInfo(this._$)};break;case 40:case 41:this.$=n[o];break;case 42:this.$=s.preparePath(!0,n[o],this._$);break;case 43:this.$=s.preparePath(!1,n[o],this._$);break;case 44:n[o-2].push({part:s.id(n[o]),original:n[o],separator:n[o-1]}),this.$=n[o-2];break;case 45:this.$=[{part:s.id(n[o]),original:n[o]}];break;case 46:this.$=[];break;case 47:n[o-1].push(n[o]);break;case 48:this.$=[n[o]];break;case 49:n[o-1].push(n[o]);break;case 50:this.$=[];break;case 51:n[o-1].push(n[o]);break;case 58:this.$=[];break;case 59:n[o-1].push(n[o]);break;case 64:this.$=[];break;case 65:n[o-1].push(n[o]);break;case 70:this.$=[];break;case 71:n[o-1].push(n[o]);break;case 78:this.$=[];break;case 79:n[o-1].push(n[o]);break;case 82:this.$=[];break;case 83:n[o-1].push(n[o]);break;case 86:this.$=[];break;case 87:n[o-1].push(n[o]);break;case 90:this.$=[];break;case 91:n[o-1].push(n[o]);break;case 94:this.$=[];break;case 95:n[o-1].push(n[o]);break;case 98:this.$=[n[o]];break;case 99:n[o-1].push(n[o]);break;case 100:this.$=[n[o]];break;case 101:n[o-1].push(n[o])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{13:40,15:[1,20],17:39},{20:42,56:41,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:45,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:48,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:42,56:49,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:50,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,51]},{72:[1,35],86:52},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:53,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:54,38:56,39:[1,58],43:57,44:[1,59],45:55,47:[2,54]},{28:60,43:61,44:[1,59],47:[2,56]},{13:63,15:[1,20],18:[1,62]},{15:[2,48],18:[2,48]},{33:[2,86],57:64,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:65,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:66,47:[1,67]},{30:68,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:69,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:70,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:71,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:75,33:[2,80],50:72,63:73,64:76,65:[1,44],69:74,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,80]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,51]},{20:75,53:81,54:[2,84],63:82,64:76,65:[1,44],69:83,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:84,47:[1,67]},{47:[2,55]},{4:85,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:86,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:87,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:88,47:[1,67]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:75,33:[2,88],58:89,63:90,64:76,65:[1,44],69:91,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:92,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:93,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,31:94,33:[2,60],63:95,64:76,65:[1,44],69:96,70:77,71:78,72:[1,79],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,66],36:97,63:98,64:76,65:[1,44],69:99,70:77,71:78,72:[1,79],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,22:100,23:[2,52],63:101,64:76,65:[1,44],69:102,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,92],62:103,63:104,64:76,65:[1,44],69:105,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,106]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:107,72:[1,108],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,109],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,110]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:56,39:[1,58],43:57,44:[1,59],45:112,46:111,47:[2,76]},{33:[2,70],40:113,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,114]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:75,63:116,64:76,65:[1,44],67:115,68:[2,96],69:117,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,118]},{32:119,33:[2,62],74:120,75:[1,121]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:122,74:123,75:[1,121]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,124]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,125]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,109]},{20:75,63:126,64:76,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:75,33:[2,72],41:127,63:128,64:76,65:[1,44],69:129,70:77,71:78,72:[1,79],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,130]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,131]},{33:[2,63]},{72:[1,133],76:132},{33:[1,134]},{33:[2,69]},{15:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:135,74:136,75:[1,121]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,138],77:[1,137]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,139]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],55:[2,55],57:[2,20],61:[2,57],74:[2,81],83:[2,85],87:[2,18],91:[2,89],102:[2,53],105:[2,93],111:[2,19],112:[2,77],117:[2,97],120:[2,63],123:[2,69],124:[2,12],136:[2,75],137:[2,32]},parseError:function(t,e){throw new Error(t)},parse:function(t){var e=this,r=[0],s=[null],i=[],n=this.table,a="",o=0,c=0,h=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,void 0===(this.yy.parser=this).lexer.yylloc&&(this.lexer.yylloc={});var l=this.lexer.yylloc;i.push(l);var p=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var u,f,d,m,g,v,y,k,S,b,_={};;){if(d=r[r.length-1],void 0===(m=this.defaultActions[d]?this.defaultActions[d]:(null==u&&(b=void 0,"number"!=typeof(b=e.lexer.lex()||1)&&(b=e.symbols_[b]||b),u=b),n[d]&&n[d][u]))||!m.length||!m[0]){var P="";if(!h){for(v in S=[],n[d])this.terminals_[v]&&2<v&&S.push("'"+this.terminals_[v]+"'");P=this.lexer.showPosition?"Parse error on line "+(o+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+S.join(", ")+", got '"+(this.terminals_[u]||u)+"'":"Parse error on line "+(o+1)+": Unexpected "+(1==u?"end of input":"'"+(this.terminals_[u]||u)+"'"),this.parseError(P,{text:this.lexer.match,token:this.terminals_[u]||u,line:this.lexer.yylineno,loc:l,expected:S})}}if(m[0]instanceof Array&&1<m.length)throw new Error("Parse Error: multiple actions possible at state: "+d+", token: "+u);switch(m[0]){case 1:r.push(u),s.push(this.lexer.yytext),i.push(this.lexer.yylloc),r.push(m[1]),u=null,f?(u=f,f=null):(c=this.lexer.yyleng,a=this.lexer.yytext,o=this.lexer.yylineno,l=this.lexer.yylloc,0<h&&h--);break;case 2:if(y=this.productions_[m[1]][1],_.$=s[s.length-y],_._$={first_line:i[i.length-(y||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(y||1)].first_column,last_column:i[i.length-1].last_column},p&&(_._$.range=[i[i.length-(y||1)].range[0],i[i.length-1].range[1]]),void 0!==(g=this.performAction.call(_,a,c,o,this.yy,m[1],s,i)))return g;y&&(r=r.slice(0,-1*y*2),s=s.slice(0,-1*y),i=i.slice(0,-1*y)),r.push(this.productions_[m[1]][0]),s.push(_.$),i.push(_._$),k=n[r[r.length-2]][r[r.length-1]],r.push(k);break;case 3:return!0}}return!0}},e={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var s=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===s.length?this.yylloc.first_column:0)+s[s.length-r.length].length-r[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;var t,e,r,s,i;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),a=0;a<n.length&&(!(r=this._input.match(this.rules[n[a]]))||e&&!(r[0].length>e[0].length)||(e=r,s=a,this.options.flex));a++);return e?((i=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,n[s],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return void 0!==t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)},options:{},performAction:function(t,r,e,s){function i(t,e){return r.yytext=r.yytext.substr(t,r.yyleng-e)}switch(e){case 0:if("\\\\"===r.yytext.slice(-2)?(i(0,1),this.begin("mu")):"\\"===r.yytext.slice(-1)?(i(0,1),this.begin("emu")):this.begin("mu"),r.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(r.yytext=r.yytext.substr(5,r.yyleng-9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(r.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return r.yytext=i(1,2).replace(/\\"/g,'"'),80;case 32:return r.yytext=i(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:case 42:return 72;case 43:return"INVALID";case 44:return 5}},rules:[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],conditions:{mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}}};function r(){this.yy={}}return t.lexer=e,new((r.prototype=t).Parser=r)}();e.__esModule=!0,e.default=r},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0;var i=s(r(25));function n(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=t}function f(t,e,r){void 0===e&&(e=t.length);var s=t[e-1],i=t[e-2];return s?"ContentStatement"===s.type?(i||!r?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(s.original):void 0:r}function d(t,e,r){void 0===e&&(e=-1);var s=t[e+1],i=t[e+2];return s?"ContentStatement"===s.type?(i||!r?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(s.original):void 0:r}function m(t,e,r){var s=t[null==e?0:e+1];if(s&&"ContentStatement"===s.type&&(r||!s.rightStripped)){var i=s.value;s.value=s.value.replace(r?/^\s+/:/^[ \t]*\r?\n?/,""),s.rightStripped=s.value!==i}}function g(t,e,r){var s=t[null==e?t.length-1:e-1];if(s&&"ContentStatement"===s.type&&(r||!s.leftStripped)){var i=s.value;return s.value=s.value.replace(r?/\s+$/:/[ \t]+$/,""),s.leftStripped=s.value!==i,s.leftStripped}}(n.prototype=new i.default).Program=function(t){var e=!this.options.ignoreStandalone,r=!this.isRootSeen;this.isRootSeen=!0;for(var s=t.body,i=0,n=s.length;i<n;i++){var a=s[i],o=this.accept(a);if(o){var c=f(s,i,r),h=d(s,i,r),l=o.openStandalone&&c,p=o.closeStandalone&&h,u=o.inlineStandalone&&c&&h;o.close&&m(s,i,!0),o.open&&g(s,i,!0),e&&u&&(m(s,i),g(s,i)&&"PartialStatement"===a.type&&(a.indent=/([ \t]+$)/.exec(s[i-1].original)[1])),e&&l&&(m((a.program||a.inverse).body),g(s,i)),e&&p&&(m(s,i),g((a.inverse||a.program).body))}}return t},n.prototype.BlockStatement=n.prototype.DecoratorBlock=n.prototype.PartialBlockStatement=function(t){this.accept(t.program),this.accept(t.inverse);var e=t.program||t.inverse,r=t.program&&t.inverse,s=r,i=r;if(r&&r.chained)for(s=r.body[0].program;i.chained;)i=i.body[i.body.length-1].program;var n={open:t.openStrip.open,close:t.closeStrip.close,openStandalone:d(e.body),closeStandalone:f((s||e).body)};if(t.openStrip.close&&m(e.body,null,!0),r){var a=t.inverseStrip;a.open&&g(e.body,null,!0),a.close&&m(s.body,null,!0),t.closeStrip.open&&g(i.body,null,!0),!this.options.ignoreStandalone&&f(e.body)&&d(s.body)&&(g(e.body),m(s.body))}else t.closeStrip.open&&g(e.body,null,!0);return n},n.prototype.Decorator=n.prototype.MustacheStatement=function(t){return t.strip},n.prototype.PartialStatement=n.prototype.CommentStatement=function(t){var e=t.strip||{};return{inlineStandalone:!0,open:e.open,close:e.close}},e.default=n,t.exports=e.default},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0;var i=s(r(6));function n(){this.parents=[]}function a(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash")}function o(t){a.call(this,t),this.acceptKey(t,"program"),this.acceptKey(t,"inverse")}function c(t){this.acceptRequired(t,"name"),this.acceptArray(t.params),this.acceptKey(t,"hash")}n.prototype={constructor:n,mutating:!1,acceptKey:function(t,e){var r=this.accept(t[e]);if(this.mutating){if(r&&!n.prototype[r.type])throw new i.default('Unexpected node type "'+r.type+'" found when accepting '+e+" on "+t.type);t[e]=r}},acceptRequired:function(t,e){if(this.acceptKey(t,e),!t[e])throw new i.default(t.type+" requires "+e)},acceptArray:function(t){for(var e=0,r=t.length;e<r;e++)this.acceptKey(t,e),t[e]||(t.splice(e,1),e--,r--)},accept:function(t){if(t){if(!this[t.type])throw new i.default("Unknown type: "+t.type,t);this.current&&this.parents.unshift(this.current),this.current=t;var e=this[t.type](t);return this.current=this.parents.shift(),!this.mutating||e?e:!1!==e?t:void 0}},Program:function(t){this.acceptArray(t.body)},MustacheStatement:a,Decorator:a,BlockStatement:o,DecoratorBlock:o,PartialStatement:c,PartialBlockStatement:function(t){c.call(this,t),this.acceptKey(t,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:a,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(t){this.acceptArray(t.pairs)},HashPair:function(t){this.acceptRequired(t,"value")}},e.default=n,t.exports=e.default},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0,e.SourceLocation=function(t,e){this.source=t,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}},e.id=function(t){return/^\[.*\]$/.test(t)?t.substr(1,t.length-2):t},e.stripFlags=function(t,e){return{open:"~"===t.charAt(2),close:"~"===e.charAt(e.length-3)}},e.stripComment=function(t){return t.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")},e.preparePath=function(t,e,r){r=this.locInfo(r);for(var s=t?"@":"",i=[],n=0,a=0,o=e.length;a<o;a++){var c=e[a].part,h=e[a].original!==c;if(s+=(e[a].separator||"")+c,h||".."!==c&&"."!==c&&"this"!==c)i.push(c);else{if(0<i.length)throw new l.default("Invalid path: "+s,{loc:r});".."===c&&(n++,"../")}}return{type:"PathExpression",data:t,depth:n,parts:i,original:s,loc:r}},e.prepareMustache=function(t,e,r,s,i,n){var a=s.charAt(3)||s.charAt(2),o="{"!==a&&"&"!==a;return{type:/\*/.test(s)?"Decorator":"MustacheStatement",path:t,params:e,hash:r,escaped:o,strip:i,loc:this.locInfo(n)}},e.prepareRawBlock=function(t,e,r,s){h(t,r),s=this.locInfo(s);var i={type:"Program",body:e,strip:{},loc:s};return{type:"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:i,openStrip:{},inverseStrip:{},closeStrip:{},loc:s}},e.prepareBlock=function(t,e,r,s,i,n){s&&s.path&&h(t,s);var a=/\*/.test(t.open);e.blockParams=t.blockParams;var o=void 0,c=void 0;if(r){if(a)throw new l.default("Unexpected inverse block on decorator",r);r.chain&&(r.program.body[0].closeStrip=s.strip),c=r.strip,o=r.program}i&&(i=o,o=e,e=i);return{type:a?"DecoratorBlock":"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:e,inverse:o,openStrip:t.strip,inverseStrip:c,closeStrip:s&&s.strip,loc:this.locInfo(n)}},e.prepareProgram=function(t,e){if(!e&&t.length){var r=t[0].loc,s=t[t.length-1].loc;r&&s&&(e={source:r.source,start:{line:r.start.line,column:r.start.column},end:{line:s.end.line,column:s.end.column}})}return{type:"Program",body:t,strip:{},loc:e}},e.preparePartialBlock=function(t,e,r,s){return h(t,r),{type:"PartialBlockStatement",name:t.path,params:t.params,hash:t.hash,program:e,openStrip:t.strip,closeStrip:r&&r.strip,loc:this.locInfo(s)}};var l=s(r(6));function h(t,e){if(e=e.path?e.path.original:e,t.path.original!==e){var r={loc:t.path.loc};throw new l.default(t.path.original+" doesn't match "+e,r)}}},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0,e.Compiler=a,e.precompile=function(t,e,r){if(null==t||"string"!=typeof t&&"Program"!==t.type)throw new c.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);"data"in(e=e||{})||(e.data=!0);e.compat&&(e.useDepths=!0);var s=r.parse(t,e),i=(new r.Compiler).compile(s,e);return(new r.JavaScriptCompiler).compile(i,e)},e.compile=function(s,i,n){void 0===i&&(i={});if(null==s||"string"!=typeof s&&"Program"!==s.type)throw new c.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+s);"data"in i||(i.data=!0);i.compat&&(i.useDepths=!0);var a=void 0;function o(){var t=n.parse(s,i),e=(new n.Compiler).compile(t,i),r=(new n.JavaScriptCompiler).compile(e,i,void 0,!0);return n.template(r)}function t(t,e){return a||(a=o()),a.call(this,t,e)}return t._setup=function(t){return a||(a=o()),a._setup(t)},t._child=function(t,e,r,s){return a||(a=o()),a._child(t,e,r,s)},t};var c=s(r(6)),n=r(5),o=s(r(21)),i=[].slice;function a(){}function h(t,e){if(t===e)return!0;if(n.isArray(t)&&n.isArray(e)&&t.length===e.length){for(var r=0;r<t.length;r++)if(!h(t[r],e[r]))return!1;return!0}}function l(t){if(!t.path.parts){var e=t.path;t.path={type:"PathExpression",data:!1,depth:0,parts:[e.original+""],original:e.original+"",loc:e.loc}}}a.prototype={compiler:a,equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var r=0;r<e;r++){var s=this.opcodes[r],i=t.opcodes[r];if(s.opcode!==i.opcode||!h(s.args,i.args))return!1}e=this.children.length;for(r=0;r<e;r++)if(!this.children[r].equals(t.children[r]))return!1;return!0},guid:0,compile:function(t,e){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=e,this.stringParams=e.stringParams,this.trackIds=e.trackIds,e.blockParams=e.blockParams||[];var r=e.knownHelpers;if(e.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},r)for(var s in r)s in r&&(e.knownHelpers[s]=r[s]);return this.accept(t)},compileProgram:function(t){var e=(new this.compiler).compile(t,this.options),r=this.guid++;return this.usePartial=this.usePartial||e.usePartial,this.children[r]=e,this.useDepths=this.useDepths||e.useDepths,r},accept:function(t){if(!this[t.type])throw new c.default("Unknown type: "+t.type,t);this.sourceNode.unshift(t);var e=this[t.type](t);return this.sourceNode.shift(),e},Program:function(t){this.options.blockParams.unshift(t.blockParams);for(var e=t.body,r=e.length,s=0;s<r;s++)this.accept(e[s]);return this.options.blockParams.shift(),this.isSimple=1===r,this.blockParams=t.blockParams?t.blockParams.length:0,this},BlockStatement:function(t){l(t);var e=t.program,r=t.inverse;e=e&&this.compileProgram(e),r=r&&this.compileProgram(r);var s=this.classifySexpr(t);"helper"===s?this.helperSexpr(t,e,r):"simple"===s?(this.simpleSexpr(t),this.opcode("pushProgram",e),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue",t.path.original)):(this.ambiguousSexpr(t,e,r),this.opcode("pushProgram",e),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(t){var e=t.program&&this.compileProgram(t.program),r=this.setupFullMustacheParams(t,e,void 0),s=t.path;this.useDecorators=!0,this.opcode("registerDecorator",r.length,s.original)},PartialStatement:function(t){this.usePartial=!0;var e=t.program;e&&(e=this.compileProgram(t.program));var r=t.params;if(1<r.length)throw new c.default("Unsupported number of partial arguments: "+r.length,t);r.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):r.push({type:"PathExpression",parts:[],depth:0}));var s=t.name.original,i="SubExpression"===t.name.type;i&&this.accept(t.name),this.setupFullMustacheParams(t,e,void 0,!0);var n=t.indent||"";this.options.preventIndent&&n&&(this.opcode("appendContent",n),n=""),this.opcode("invokePartial",i,s,n),this.opcode("append")},PartialBlockStatement:function(t){this.PartialStatement(t)},MustacheStatement:function(t){this.SubExpression(t),t.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(t){this.DecoratorBlock(t)},ContentStatement:function(t){t.value&&this.opcode("appendContent",t.value)},CommentStatement:function(){},SubExpression:function(t){l(t);var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ambiguousSexpr:function(t,e,r){var s=t.path,i=s.parts[0],n=null!=e||null!=r;this.opcode("getContext",s.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",r),s.strict=!0,this.accept(s),this.opcode("invokeAmbiguous",i,n)},simpleSexpr:function(t){var e=t.path;e.strict=!0,this.accept(e),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,r){var s=this.setupFullMustacheParams(t,e,r),i=t.path,n=i.parts[0];if(this.options.knownHelpers[n])this.opcode("invokeKnownHelper",s.length,n);else{if(this.options.knownHelpersOnly)throw new c.default("You specified knownHelpersOnly, but used the unknown helper "+n,t);i.strict=!0,i.falsy=!0,this.accept(i),this.opcode("invokeHelper",s.length,i.original,o.default.helpers.simpleId(i))}},PathExpression:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0],r=o.default.helpers.scopedId(t),s=!t.depth&&!r&&this.blockParamIndex(e);s?this.opcode("lookupBlockParam",s,t.parts):e?t.data?(this.options.data=!0,this.opcode("lookupData",t.depth,t.parts,t.strict)):this.opcode("lookupOnContext",t.parts,t.falsy,t.strict,r):this.opcode("pushContext")},StringLiteral:function(t){this.opcode("pushString",t.value)},NumberLiteral:function(t){this.opcode("pushLiteral",t.value)},BooleanLiteral:function(t){this.opcode("pushLiteral",t.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(t){var e=t.pairs,r=0,s=e.length;for(this.opcode("pushHash");r<s;r++)this.pushParam(e[r].value);for(;r--;)this.opcode("assignToHash",e[r].key);this.opcode("popHash")},opcode:function(t){this.opcodes.push({opcode:t,args:i.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(t){t&&(this.useDepths=!0)},classifySexpr:function(t){var e=o.default.helpers.simpleId(t.path),r=e&&!!this.blockParamIndex(t.path.parts[0]),s=!r&&o.default.helpers.helperExpression(t),i=!r&&(s||e);if(i&&!s){var n=t.path.parts[0],a=this.options;a.knownHelpers[n]?s=!0:a.knownHelpersOnly&&(i=!1)}return s?"helper":i?"ambiguous":"simple"},pushParams:function(t){for(var e=0,r=t.length;e<r;e++)this.pushParam(t[e])},pushParam:function(t){var e=null!=t.value?t.value:t.original||"";if(this.stringParams)e.replace&&(e=e.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",e,t.type),"SubExpression"===t.type&&this.accept(t);else{if(this.trackIds){var r=void 0;if(!t.parts||o.default.helpers.scopedId(t)||t.depth||(r=this.blockParamIndex(t.parts[0])),r){var s=t.parts.slice(1).join(".");this.opcode("pushId","BlockParam",r,s)}else(e=t.original||e).replace&&(e=e.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",t.type,e)}this.accept(t)}},setupFullMustacheParams:function(t,e,r,s){var i=t.params;return this.pushParams(i),this.opcode("pushProgram",e),this.opcode("pushProgram",r),t.hash?this.accept(t.hash):this.opcode("emptyHash",s),i},blockParamIndex:function(t){for(var e=0,r=this.options.blockParams.length;e<r;e++){var s=this.options.blockParams[e],i=s&&n.indexOf(s,t);if(s&&0<=i)return[e,i]}}}},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0;var i=r(4),d=s(r(6)),n=r(5),a=s(r(29));function c(t){this.value=t}function o(){}o.prototype={nameLookup:function(t,e){return o.isValidJavaScriptVariableName(e)?[t,".",e]:[t,"[",JSON.stringify(e),"]"]},depthedLookup:function(t){return[this.aliasable("container.lookup"),'(depths, "',t,'")']},compilerInfo:function(){var t=i.COMPILER_REVISION;return[t,i.REVISION_CHANGES[t]]},appendToBuffer:function(t,e,r){return n.isArray(t)||(t=[t]),t=this.source.wrap(t,e),this.environment.isSimple?["return ",t,";"]:r?["buffer += ",t,";"]:(t.appendToBuffer=!0,t)},initializeBuffer:function(){return this.quotedString("")},compile:function(t,e,r,s){this.environment=t,this.options=e,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!s,this.name=this.environment.name,this.isChild=!!r,this.context=r||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(t,e),this.useDepths=this.useDepths||t.useDepths||t.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||t.useBlockParams;var i=t.opcodes,n=void 0,a=void 0,o=void 0,c=void 0;for(o=0,c=i.length;o<c;o++)n=i[o],this.source.currentLocation=n.loc,a=a||n.loc,this[n.opcode].apply(this,n.args);if(this.source.currentLocation=a,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new d.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend("var decorators = container.decorators;\n"),this.decorators.push("return fn;"),this.decorators=s?Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators.merge()));var h=this.createFunctionContext(s);if(this.isChild)return h;var l={compiler:this.compilerInfo(),main:h};this.decorators&&(l.main_d=this.decorators,l.useDecorators=!0);var p=this.context,u=p.programs,f=p.decorators;for(o=0,c=u.length;o<c;o++)u[o]&&(l[o]=u[o],f[o]&&(l[o+"_d"]=f[o],l.useDecorators=!0));return this.environment.usePartial&&(l.usePartial=!0),this.options.data&&(l.useData=!0),this.useDepths&&(l.useDepths=!0),this.useBlockParams&&(l.useBlockParams=!0),this.options.compat&&(l.compat=!0),s?l.compilerOptions=this.options:(l.compiler=JSON.stringify(l.compiler),this.source.currentLocation={start:{line:1,column:0}},l=this.objectLiteral(l),e.srcName?(l=l.toStringWithSourceMap({file:e.destName})).map=l.map&&l.map.toString():l=l.toString()),l},preamble:function(){this.lastContext=0,this.source=new a.default(this.options.srcName),this.decorators=new a.default(this.options.srcName)},createFunctionContext:function(t){var e="",r=this.stackVars.concat(this.registers.list);0<r.length&&(e+=", "+r.join(", "));var s=0;for(var i in this.aliases){var n=this.aliases[i];this.aliases.hasOwnProperty(i)&&n.children&&1<n.referenceCount&&(e+=", alias"+ ++s+"="+i,n.children[0]="alias"+s)}var a=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&a.push("blockParams"),this.useDepths&&a.push("depths");var o=this.mergeSource(e);return t?(a.push(o),Function.apply(this,a)):this.source.wrap(["function(",a.join(","),") {\n  ",o,"}"])},mergeSource:function(t){var e=this.environment.isSimple,r=!this.forceBuffer,s=void 0,i=void 0,n=void 0,a=void 0;return this.source.each(function(t){t.appendToBuffer?(n?t.prepend("  + "):n=t,a=t):(n&&(i?n.prepend("buffer += "):s=!0,a.add(";"),n=a=void 0),i=!0,e||(r=!1))}),r?n?(n.prepend("return "),a.add(";")):i||this.source.push('return "";'):(t+=", buffer = "+(s?"":this.initializeBuffer()),n?(n.prepend("return buffer + "),a.add(";")):this.source.push("return buffer;")),t&&this.source.prepend("var "+t.substring(2)+(s?"":";\n")),this.source.merge()},blockValue:function(t){var e=this.aliasable("helpers.blockHelperMissing"),r=[this.contextName(0)];this.setupHelperArgs(t,0,r);var s=this.popStack();r.splice(1,0,s),this.push(this.source.functionCall(e,"call",r))},ambiguousBlockValue:function(){var t=this.aliasable("helpers.blockHelperMissing"),e=[this.contextName(0)];this.setupHelperArgs("",0,e,!0),this.flushInline();var r=this.topStack();e.splice(1,0,r),this.pushSource(["if (!",this.lastHelper,") { ",r," = ",this.source.functionCall(t,"call",e),"}"])},appendContent:function(t){this.pendingContent?t=this.pendingContent+t:this.pendingLocation=this.source.currentLocation,this.pendingContent=t},append:function(){if(this.isInline())this.replaceStack(function(t){return[" != null ? ",t,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var t=this.popStack();this.pushSource(["if (",t," != null) { ",this.appendToBuffer(t,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(t){this.lastContext=t},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(t,e,r,s){var i=0;s||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(t[i++])),this.resolvePath("context",t,i,e,r)},lookupBlockParam:function(t,e){this.useBlockParams=!0,this.push(["blockParams[",t[0],"][",t[1],"]"]),this.resolvePath("context",e,1)},lookupData:function(t,e,r){t?this.pushStackLiteral("container.data(data, "+t+")"):this.pushStackLiteral("data"),this.resolvePath("data",e,0,!0,r)},resolvePath:function(r,s,i,n,t){var a=this;if(this.options.strict||this.options.assumeObjects)this.push(function(t,e,r,s){var i=e.popStack(),n=0,a=r.length;t&&a--;for(;n<a;n++)i=e.nameLookup(i,r[n],s);return t?[e.aliasable("container.strict"),"(",i,", ",e.quotedString(r[n]),")"]:i}(this.options.strict&&t,this,s,r));else for(var e=s.length;i<e;i++)this.replaceStack(function(t){var e=a.nameLookup(t,s[i],r);return n?[" && ",e]:[" != null ? ",e," : ",t]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(t,e){this.pushContext(),this.pushString(e),"SubExpression"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(t){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(t?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(t.ids)),this.stringParams&&(this.push(this.objectLiteral(t.contexts)),this.push(this.objectLiteral(t.types))),this.push(this.objectLiteral(t.values))},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},registerDecorator:function(t,e){var r=this.nameLookup("decorators",e,"decorator"),s=this.setupHelperArgs(e,t);this.decorators.push(["fn = ",this.decorators.functionCall(r,"",["fn","props","container",s])," || fn;"])},invokeHelper:function(t,e,r){var s=this.popStack(),i=this.setupHelper(t,e),n=r?[i.name," || "]:"",a=["("].concat(n,s);this.options.strict||a.push(" || ",this.aliasable("helpers.helperMissing")),a.push(")"),this.push(this.source.functionCall(a,"call",i.callParams))},invokeKnownHelper:function(t,e){var r=this.setupHelper(t,e);this.push(this.source.functionCall(r.name,"call",r.callParams))},invokeAmbiguous:function(t,e){this.useRegister("helper");var r=this.popStack();this.emptyHash();var s=this.setupHelper(0,t,e),i=["(","(helper = ",this.lastHelper=this.nameLookup("helpers",t,"helper")," || ",r,")"];this.options.strict||(i[0]="(helper = ",i.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",i,s.paramsInit?["),(",s.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",s.callParams)," : helper))"])},invokePartial:function(t,e,r){var s=[],i=this.setupParams(e,1,s);t&&(e=this.popStack(),delete i.name),r&&(i.indent=JSON.stringify(r)),i.helpers="helpers",i.partials="partials",i.decorators="container.decorators",t?s.unshift(e):s.unshift(this.nameLookup("partials",e,"partial")),this.options.compat&&(i.depths="depths"),i=this.objectLiteral(i),s.push(i),this.push(this.source.functionCall("container.invokePartial","",s))},assignToHash:function(t){var e=this.popStack(),r=void 0,s=void 0,i=void 0;this.trackIds&&(i=this.popStack()),this.stringParams&&(s=this.popStack(),r=this.popStack());var n=this.hash;r&&(n.contexts[t]=r),s&&(n.types[t]=s),i&&(n.ids[t]=i),n.values[t]=e},pushId:function(t,e,r){"BlockParam"===t?this.pushStackLiteral("blockParams["+e[0]+"].path["+e[1]+"]"+(r?" + "+JSON.stringify("."+r):"")):"PathExpression"===t?this.pushString(e):"SubExpression"===t?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:o,compileChildren:function(t,e){for(var r=t.children,s=void 0,i=void 0,n=0,a=r.length;n<a;n++){s=r[n],i=new this.compiler;var o=this.matchExistingProgram(s);this.useBlockParams=null==o?(this.context.programs.push(""),o=this.context.programs.length,s.index=o,s.name="program"+o,this.context.programs[o]=i.compile(s,e,this.context,!this.precompile),this.context.decorators[o]=i.decorators,this.context.environments[o]=s,this.useDepths=this.useDepths||i.useDepths,this.useBlockParams||i.useBlockParams):(s.index=o,s.name="program"+o,this.useDepths=this.useDepths||s.useDepths,this.useBlockParams||s.useBlockParams)}},matchExistingProgram:function(t){for(var e=0,r=this.context.environments.length;e<r;e++){var s=this.context.environments[e];if(s&&s.equals(t))return e}},programExpression:function(t){var e=this.environment.children[t],r=[e.index,"data",e.blockParams];return(this.useBlockParams||this.useDepths)&&r.push("blockParams"),this.useDepths&&r.push("depths"),"container.program("+r.join(", ")+")"},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},push:function(t){return t instanceof c||(t=this.source.wrap(t)),this.inlineStack.push(t),t},pushStackLiteral:function(t){this.push(new c(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),t&&this.source.push(t)},replaceStack:function(t){var e=["("],r=void 0,s=void 0,i=void 0;if(!this.isInline())throw new d.default("replaceStack on non-inline");var n=this.popStack(!0);if(n instanceof c)e=["(",r=[n.value]],i=!0;else{s=!0;var a=this.incrStack();e=["((",this.push(a)," = ",n,")"],r=this.topStack()}var o=t.call(this,r);i||this.popStack(),s&&this.stackSlot--,this.push(e.concat(o,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;this.inlineStack=[];for(var e=0,r=t.length;e<r;e++){var s=t[e];if(s instanceof c)this.compileStack.push(s);else{var i=this.incrStack();this.pushSource([i," = ",s,";"]),this.compileStack.push(i)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),r=(e?this.inlineStack:this.compileStack).pop();if(!t&&r instanceof c)return r.value;if(!e){if(!this.stackSlot)throw new d.default("Invalid stack pop");this.stackSlot--}return r},topStack:function(){var t=this.isInline()?this.inlineStack:this.compileStack,e=t[t.length-1];return e instanceof c?e.value:e},contextName:function(t){return this.useDepths&&t?"depths["+t+"]":"depth"+t},quotedString:function(t){return this.source.quotedString(t)},objectLiteral:function(t){return this.source.objectLiteral(t)},aliasable:function(t){var e=this.aliases[t];return e?e.referenceCount++:((e=this.aliases[t]=this.source.wrap(t)).aliasable=!0,e.referenceCount=1),e},setupHelper:function(t,e,r){var s=[];return{params:s,paramsInit:this.setupHelperArgs(e,t,s,r),name:this.nameLookup("helpers",e,"helper"),callParams:[this.contextName(0)].concat(s)}},setupParams:function(t,e,r){var s={},i=[],n=[],a=[],o=!r,c=void 0;o&&(r=[]),s.name=this.quotedString(t),s.hash=this.popStack(),this.trackIds&&(s.hashIds=this.popStack()),this.stringParams&&(s.hashTypes=this.popStack(),s.hashContexts=this.popStack());var h=this.popStack(),l=this.popStack();(l||h)&&(s.fn=l||"container.noop",s.inverse=h||"container.noop");for(var p=e;p--;)c=this.popStack(),r[p]=c,this.trackIds&&(a[p]=this.popStack()),this.stringParams&&(n[p]=this.popStack(),i[p]=this.popStack());return o&&(s.args=this.source.generateArray(r)),this.trackIds&&(s.ids=this.source.generateArray(a)),this.stringParams&&(s.types=this.source.generateArray(n),s.contexts=this.source.generateArray(i)),this.options.data&&(s.data="data"),this.useBlockParams&&(s.blockParams="blockParams"),s},setupHelperArgs:function(t,e,r,s){var i=this.setupParams(t,e,r);return i=this.objectLiteral(i),s?(this.useRegister("options"),r.push("options"),["options=",i]):r?(r.push(i),""):i}},function(){for(var t="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),e=o.RESERVED_WORDS={},r=0,s=t.length;r<s;r++)e[t[r]]=!0}(),o.isValidJavaScriptVariableName=function(t){return!o.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)},e.default=o,t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var a=r(5),s=void 0;try{}catch(t){}function n(t,e,r){if(a.isArray(t)){for(var s=[],i=0,n=t.length;i<n;i++)s.push(e.wrap(t[i],r));return s}return"boolean"==typeof t||"number"==typeof t?t+"":t}function i(t){this.srcFile=t,this.source=[]}s||((s=function(t,e,r,s){this.src="",s&&this.add(s)}).prototype={add:function(t){a.isArray(t)&&(t=t.join("")),this.src+=t},prepend:function(t){a.isArray(t)&&(t=t.join("")),this.src=t+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),i.prototype={isEmpty:function(){return!this.source.length},prepend:function(t,e){this.source.unshift(this.wrap(t,e))},push:function(t,e){this.source.push(this.wrap(t,e))},merge:function(){var e=this.empty();return this.each(function(t){e.add(["  ",t,"\n"])}),e},each:function(t){for(var e=0,r=this.source.length;e<r;e++)t(this.source[e])},empty:function(){var t=this.currentLocation||{start:{}};return new s(t.start.line,t.start.column,this.srcFile)},wrap:function(t){var e=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return t instanceof s?t:(t=n(t,this,e),new s(e.start.line,e.start.column,this.srcFile,t))},functionCall:function(t,e,r){return r=this.generateList(r),this.wrap([t,e?"."+e+"(":"(",r,")"])},quotedString:function(t){return'"'+(t+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(t){var e=[];for(var r in t)if(t.hasOwnProperty(r)){var s=n(t[r],this);"undefined"!==s&&e.push([this.quotedString(r),":",s])}var i=this.generateList(e);return i.prepend("{"),i.add("}"),i},generateList:function(t){for(var e=this.empty(),r=0,s=t.length;r<s;r++)r&&e.add(","),e.add(n(t[r],this));return e},generateArray:function(t){var e=this.generateList(t);return e.prepend("["),e.add("]"),e}},e.default=i,t.exports=e.default}])});
Handlebars.registerHelper("ifeq",function(e,r,n){return e==r?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("getLabel",function(e,r,n,t){return e&&r&&n&&r[n]?"object"==typeof e[r[n]]?e[r[n]].label||"...":e[r[n]]:e&&e[0]&&e[0].label?"...":""}),Handlebars.registerHelper("getStatusText",function(e,r,n,t){return e[r[n]]?e[r[n]].label:"..."}),Handlebars.registerHelper("round",function(e,r){return Math.round(e)}),Handlebars.registerHelper("ifinr",function(e,r,n){for(var t in r)if(r[t].id==e)return n.fn(this);return n.inverse(this)}),Handlebars.registerHelper("ifselected",function(e,r,n){for(var t in r)if(r[t].value==e)return n.fn(this);return n.inverse(this)}),Handlebars.registerHelper("ifin",function(e,r,n){return-1!=r.indexOf(e)?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifnoteq",function(e,r,n){return e!=r?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifjson",function(e,r,n){return"object"==typeof e[r]?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifnotjson",function(e,r,n){return"object"!=typeof e[r]?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("getRegions",function(e,r,n){var t=e[r],i="";if(t&&t.length)return i+='<label class="label label-default">'+(t[0].title?t[0].title:t[0].id)+"</label> ",1<t.length&&(i+='<span class="mapsvg-data-image-counter">+'+(t.length-1)+"</span>"),new Handlebars.SafeString(i)}),Handlebars.registerHelper("getSelectedOptions",function(e,r,n){var t=e[r],i="";if(t&&t.length)return i+='<label class="label label-default">'+(void 0===t[0].label?t[0].value:t[0].label)+"</label> ",1<t.length&&(i+='<span class="mapsvg-data-image-counter">+'+(t.length-1)+"</span>"),new Handlebars.SafeString(i)}),Handlebars.registerHelper("getRegionIDs",function(e,r,n){var t=e[r],i="";if(t&&t.length)return i+='<label class="label label-default">'+(region.title?region.title:region.id)+"</label> ",1<t.length&&(i+='<span class="mapsvg-data-image-counter">+'+(t.length-1)+"</span>"),new Handlebars.SafeString(i)}),Handlebars.registerHelper("getThumbs",function(e,r,n){var t=e[r],i="";if(t&&t.length)return i+='<img src="'+t[0].thumbnail+'" class="mapsvg-data-thumbnail"/>',1<t.length&&(i+='<span class="mapsvg-data-image-counter">+'+(t.length-1)+"</span>"),new Handlebars.SafeString(i)}),Handlebars.registerHelper("getMarkerImage",function(e,r,n){var t=e[r];if(t&&t.img)return new Handlebars.SafeString('<img src="'+t.markerImageUrl+'" class="mapsvg-marker-image"/>')}),Handlebars.registerHelper("not",function(e,r,n){return e!=r?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("if_starts",function(e,r,n){return e&&0==e.indexOf(r)?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("if_function",function(e,r){return"function"==typeof e?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("if_number",function(e,r){return jQuery.isNumeric(e)?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("if_string",function(e,r){return"string"!=typeof e||jQuery.isNumeric(e)?r.inverse(this):r.fn(this)}),Handlebars.registerHelper("toString",function(e){return null!=e?MapSVG.convertToText(e):""}),Handlebars.registerHelper("jsonToString",function(e){return null!=e?JSON.stringify(e):""}),Handlebars.registerHelper("log",function(e){return console.log(e),e}),Handlebars.registerHelper("stripUnderscores",function(e){return null!=e?e.replace(/_/g," "):""}),Handlebars.registerHelper("spacesToUnderscores",function(e){return null!=e?e.replace(/ /g,"_"):""}),Handlebars.registerHelper("switch",function(e,r){this._switch_value_=e,this._switch_break_=!1;var n=r.fn(this);return delete this._switch_break_,delete this._switch_value_,n}),Handlebars.registerHelper("case",function(e,r){var n=Array.prototype.slice.call(arguments),t=(r=n.pop(),n);return this._switch_break_||-1===t.indexOf(this._switch_value_)?"":(!0===r.hash.break&&(this._switch_break_=!0),r.fn(this))}),Handlebars.registerHelper("default",function(e){if(!this._switch_break_)return e.fn(this)});
var scripts=document.getElementsByTagName("script"),myScript=scripts[scripts.length-1].src.split("/");myScript.pop();var pluginRootURL=myScript.join("/")+"/";!function(c,d,e){function a(e,t){e=e||{};var i=this;if(this.formBuilder=t,this.images=[],this.type=e.type,this.value=e.value,this.searchable=d.parseBoolean(e.searchable),this.databaseFields=this.formBuilder.mapsvg.database.getSchema().map(function(e){if("text"==e.type||"region"==e.type||"textarea"==e.type||"post"==e.type||"select"==e.type||"radio"==e.type||"checkbox"==e.type)return"post"==e.type?"Object.post.post_title":"Object."+e.name}),this.regionFields=this.formBuilder.mapsvg.regionsDatabase.getSchema().map(function(e){if("status"==e.type||"text"==e.type||"textarea"==e.type||"post"==e.type||"select"==e.type||"radio"==e.type||"checkbox"==e.type)return"Region."+e.name}),this.db_type="varchar(255)","region"==this.type)this.options=this.formBuilder.getRegionsList(),this.label="Regions",this.name="regions",this.db_type="text";else if("textarea"==this.type)this.autobr=e.autobr,this.html=e.html,this.db_type="text";else if("modal"==this.type)this.buttonText=e.buttonText;else if("location"==this.type)this.location=this.value,this.db_type="text";else if("search"==this.type)this.fallback=d.parseBoolean(e.fallback),this.placeholder=e.placeholder||"Search",this.noResultsText=e.noResultsText||"No results found",this.width=i.formBuilder.filtersHide&&!i.formBuilder.modal?null:e.width||"100%";else if("distance"==this.type){this.label=e.label||"Search radius",this.distanceControl=e.distanceControl||"select",this.distanceUnits=e.distanceUnits||"km",this.distanceUnitsLabel=e.distanceUnitsLabel||"km",this.fromLabel=e.fromLabel||"from",this.placeholder=e.placeholder,this.userLocationButton=e.userLocationButton||!1,this.type=e.type,this.addressField=e.addressField||!0,this.addressFieldPlaceholder=e.addressFieldPlaceholder||"Address",this.options=e.options||[{value:"10",default:!0},{value:"30",default:!1},{value:"50",default:!1},{value:"100",default:!1}];var a=!1;i.value&&this.options.forEach(function(e){e.value===i.value.length&&(e.selected=!0,a=!0)}),a||this.options.forEach(function(e){e.default&&(e.selected=!0)})}else"post"==this.type?(i.formBuilder.admin&&(this.post_types=this.formBuilder.admin.getPostTypes()),this.post_type=e.post_type||this.post_types[0],this.add_fields=d.parseBoolean(e.add_fields),this.db_type="int(11)",this.name="post_id",this.post_id=e.post_id,this.post=e.post):"checkbox"==this.type?(this.db_type="tinyint(1)",this.checkboxLabel=e.checkboxLabel,this.checkboxValue=e.checkboxValue):"radio"==this.type||"select"==this.type?(this.options=e.options||[{label:"Option one",name:"option_one",value:1},{label:"Option two",name:"option_two",value:2}],"select"==this.type&&(this.multiselect=e.multiselect,this.optionsGrouped=e.optionsGrouped,this.db_type=this.multiselect?"text":"varchar(255)"),this.optionsDict=e.optionsDict||{},this.optionsDict||this.options.forEach(function(e){i.optionsDict[e.value]=e.label})):"image"==this.type?(this.button_text=e.button_text||"Browse...",this.db_type="text",this.label=e.label||"Images",this.name=e.name||"images"):"status"==this.type?(this.label=e.label||"Status",this.name="status",this.options=e.options||[{label:"Enabled",value:1,color:"",disabled:!1},{label:"Disabled",value:0,color:"",disabled:!0}]):"date"==this.type&&(i.formBuilder.admin&&(this.languages=["en-GB","ar","az","bg","bs","ca","cs","cy","da","de","el","es","et","eu","fa","fi","fo","fr","gl","he","hr","hu","hy","id","is","it","ja","ka","kh","kk","kr","lt","lv","mk","ms","nb","nl","nl-BE","no","pl","pt-BR","pt","ro","rs","rs-latin","ru","sk","sl","sq","sr","sr-latin","sv","sw","th","tr","uk","vi","zh-CN","zh-TW"]),this.db_type="varchar(50)",this.language=e.language);this.label=this.label||(void 0===e.label?"Label":e.label),this.name=this.name||e.name||"label",this.help=e.help||"",this.placeholder=e.placeholder;var s=this.type;if("marker"===s&&i.formBuilder.mapsvg.isGeo()&&(s="marker-geo"),"location"===s&&i.formBuilder.mapsvg.isGeo()&&(s="location-geo"),this.formBuilder.filtersMode?(this.parameterName=e.parameterName||"",this.parameterNameShort=this.parameterName.split(".")[1],this.placeholder=e.placeholder||"Any",this.templates={result:Handlebars.compile(c("#mapsvg-filters-tmpl-"+s+"-view").html())}):this.templates={result:Handlebars.compile(c("#mapsvg-data-tmpl-"+s+"-view").html())},this.views={result:c(this.templates.result(this.get()))},this.views.result.data("formElement",this),c().mselect2&&("distance"!==this.type?this.views.result.find("select").css({width:"100%",display:"block"}).mselect2().on("select2:focus",function(){c(this).mselect2("open")}):this.views.result.find("select").mselect2().on("select2:focus",function(){c(this).mselect2("open")})),this.html){var r=this.views.result.find("textarea")[0];this.editor=CodeMirror.fromTextArea(r,{mode:{name:"handlebars",base:"text/html"},matchBrackets:!0,lineNumbers:!0}),i.formBuilder.admin&&this.editor.on("change",this.setTextareaValue)}"image"==this.type&&(this.images=this.value||[],this.redrawImages()),"marker"!=this.type&&"location"!=this.type||(this.templates.marker=Handlebars.compile(c("#mapsvg-data-tmpl-marker").html()),this.location&&this.location.marker&&i.renderMarker()),this.setEventHandlers()}d.parseBoolean=function(e){switch(String(e).toLowerCase()){case"on":case"true":case"1":case"yes":case"y":return!0;case"off":case"false":case"0":case"no":case"n":return!1;default:return}},a.prototype.setTextareaValue=function(e,t){var i=e.getValue();c(e.getTextArea()).val(i).trigger("change")},a.prototype.setEventHandlers=function(){var n=this;if(this.formBuilder.editMode)this.views.result.on("click",function(){n.formBuilder.edit(n)});else{if("image"==this.type){var e=n.views.result.find(".mapsvg-data-images");this.formBuilder.mediaUploader.on("select",function(){if(n.formBuilder.mediaUploaderFor!==n)return!1;n.formBuilder.mediaUploader.state().get("selection").toJSON().forEach(function(e){var t={sizes:{}};for(var i in e.sizes)t[i]=e.sizes[i].url.replace("http://","//").replace("https://","//"),t.sizes[i]={width:e.sizes[i].width,height:e.sizes[i].height};t.thumbnail||(t.thumbnail=t.full,t.sizes.thumbnail={width:e.sizes.full.width,height:e.sizes.full.height}),t.medium||(t.medium=t.full,t.sizes.medium={width:e.sizes.full.width,height:e.sizes.full.height}),n.images.push(t)}),n.redrawImages()}),n.views.result.on("click",".mapsvg-upload-image",function(e){e.preventDefault(),(n.formBuilder.mediaUploaderFor=n).formBuilder.mediaUploader.open()}),n.views.result.on("click",".mapsvg-image-delete",function(e){e.preventDefault(),c(this).closest(".mapsvg-thumbnail-wrap").remove(),n.images=[],n.views.result.find("img").each(function(e,t){n.images.push(c(t).data("image"))}),n.views.result.find("input").val(JSON.stringify(n.images))}),n.sortable=new Sortable(e[0],{animation:150,onStart:function(){n.elements.containers.form_view.addClass("sorting")},onEnd:function(e){n.images=[],n.views.result.find("img").each(function(e,t){n.images.push(c(t).data("image"))}),n.views.result.find("input").val(JSON.stringify(n.images))}})}if("post"==this.type){n.views.result.find(".mapsvg-find-post").mselect2({ajax:{url:ajaxurl+"?action=mapsvg_search_posts&post_type="+n.post_type,dataType:"json",delay:250,data:function(e){return{query:e.term,page:e.page}},processResults:function(e,t){return t.page=t.page||1,{results:e,pagination:{more:!1}}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1,templateResult:function(e){return e.loading?e.text:"<div class='select2-result-repository clearfix'>"+e.post_title+"</div>"},templateSelection:function(e){return e.post_title||e.text}}).on("select2:select",function(e){n.post=e.params.data,n.views.result.find(".mapsvg-post-id").text(n.post.ID),n.views.result.find(".mapsvg-post-url").text(n.post.url).attr("href",n.post.url),n.views.result.find('input[name="post_id"]').val(n.post.ID)})}if("location"===this.type){if(n.formBuilder.mapsvg.isGeo()){var t=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("formatted_address"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:ajaxurl+"?action=mapsvg_geocoding&address=%QUERY%",wildcard:"%QUERY%",transform:function(e){return e.error_message&&alert(e.error_message),e.results},rateLimitWait:600}});(l=this.views.result.find(".typeahead")).typeahead({minLength:3},{name:"mapsvg-addresses",display:"formatted_address",source:t});l.on("typeahead:select",function(e,t){n.location&&n.location.marker&&n.deleteMarker();var i={};i.formatted=t.formatted_address,t.address_components.forEach(function(e){var t=e.types[0];i[t]=e.long_name,e.short_name!=e.long_name&&(i[t+"_short"]=e.short_name)});var a={address:i,lat:t.geometry.location.lat,lng:t.geometry.location.lng};n.location=new d.Location(a),n.formBuilder.location=this.location;var s=new d.Marker({location:n.location,mapsvg:n.formBuilder.mapsvg});n.location.marker=s,n.formBuilder.mapsvg.setEditingMarker(s.id),n.formBuilder.marker=s.getOptions(),n.renderMarker();var r=n.formBuilder.view.find('select[name="regions"]');if(-1!==n.formBuilder.mapsvg.getData().options.source.indexOf("/geo-calibrated/usa.svg"))0!==r.length&&n.location.address.state_short&&(r.val(["US-"+n.location.address.state_short]),r.trigger("change"));else if(-1!==n.formBuilder.mapsvg.getData().options.source.indexOf("/geo-calibrated/world.svg"))0!==r.length&&n.location.address.country_short&&(r.val([n.location.address.country_short]),r.trigger("change"));else if(0!==r.length&&n.location.address.administrative_area_level_1){var o=n.formBuilder.mapsvg.getData().regions.filter(function(e){return e.title===n.location.address.administrative_area_level_1||e.title===n.location.address.administrative_area_level_2||e.id===n.location.address.country_short+"-"+n.location.address.administrative_area_level_1_short});0<o.length&&(o=o[0],r.val([o.id]),r.trigger("change"))}l.typeahead("val","")})}n.views.result.on("click",".mapsvg-marker-image-btn-trigger",function(e){c(this).toggleClass("active"),n.toggleMarkerSelector.call(n,c(this),e)}),n.views.result.on("click",".mapsvg-marker-delete",function(e){e.preventDefault(),n.deleteMarker()})}if("distance"===this.type){if(n.formBuilder.mapsvg.isGeo()){var l;t=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("formatted_address"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:ajaxurl+"?action=mapsvg_geocoding&address=%QUERY%",wildcard:"%QUERY%",transform:function(e){return e.error_message&&alert(e.error_message),e.results},rateLimitWait:600}}),(l=this.views.result.find(".typeahead")).typeahead({minLength:3},{name:"mapsvg-addresses",display:"formatted_address",source:t,limit:5});l.on("change keyup",function(){""===c(this).val()&&n.formBuilder.view.find('[name="distanceLatLng"]').val("").trigger("change")}),l.on("typeahead:select",function(e,t){t.formatted_address;var i=t.geometry.location;n.formBuilder.view.find('[name="distanceLatLng"]').val(i.lat+","+i.lng).trigger("change"),l.blur()})}n.views.result.on("click",".mapsvg-marker-image-btn-trigger",function(e){c(this).toggleClass("active"),n.toggleMarkerSelector.call(n,c(this),e)}),n.views.result.on("click",".mapsvg-marker-delete",function(e){e.preventDefault(),n.deleteMarker()})}}},a.prototype.toggleMarkerSelector=function(e,t){t.preventDefault();var i=this;if(i.markerSelector&&i.markerSelector.is(":visible"))i.markerSelector.hide();else if(i.markerSelector&&i.markerSelector.not(":visible"))i.markerSelector.show();else{i.markerImageButton=e.find("img");var a=i.markerImageButton.attr("src"),s=d.markerImages.map(function(e){return'<button class="btn btn-default mapsvg-marker-image-btn mapsvg-marker-image-btn-choose '+(a==e.url?"active":"")+'"><img src="'+e.url+'" /></button>'});i.markerSelector||(i.markerSelector=i.views.result.find(".mapsvg-marker-image-selector")),i.markerSelector&&i.markerSelector.empty(),i.formBuilder.markerSelector=i.markerSelector,i.formBuilder.marker?i.markerSelector.data("marker",i.formBuilder.marker):i.markerSelector.data("marker",null),i.markerSelector.html(s.join("")),i.markerSelector.on("click",".mapsvg-marker-image-btn-choose",function(e){e.preventDefault();var t=c(this).find("img").attr("src");i.formBuilder.marker&&i.formBuilder.mapsvg.getMarker(i.formBuilder.marker.id).setImage(t);i.markerSelector.hide(),i.views.result.find(".mapsvg-marker-image-btn-trigger").toggleClass("active",!1),i.markerImageButton.attr("src",t),d.defaultMarkerImage=t})}},a.prototype.deleteMarker=function(){this.formBuilder.marker&&(this.formBuilder.mapsvg.getMarker(this.formBuilder.marker.id).delete(),delete this.formBuilder.marker),this.views.result.find(".mapsvg-new-marker").hide(),this.views.result.find(".mapsvg-marker-id").attr("disabled","disabled")},a.prototype.renderMarker=function(e){var t=this;if(!this.location&&!e.location)return!1;e&&e.location&&(this.location=e.location),t.views.result.find(".mapsvg-new-marker").show().html(this.templates.marker(this.location)),this.location.marker.onChange=function(){t.renderMarker()}},a.prototype.redrawImages=function(){var a=this.views.result.find(".mapsvg-data-images");a.empty(),this.images&&this.images.forEach(function(e){var t=c('<img class="mapsvg-data-thumbnail" />').attr("src",e.thumbnail).data("image",e),i=c('<div class="mapsvg-thumbnail-wrap"></div>').data("image",e);i.append(t),i.append('<i class="fa fa-times  mapsvg-image-delete"></i>'),a.append(i)}),this.views.result.find("input").val(JSON.stringify(this.images))},a.prototype.setEditorEventHandlers=function(){var o=this;this.views.edit.on("click","button.mapsvg-remove",function(){o.views.result.empty().remove(),o.views.edit.empty().remove(),o.formBuilder.delete(o)}).on("keyup change paste",".mapsvg-edit-status-row input",function(){o.mayBeAddStatusRow()}).on("keyup change paste",".mapsvg-edit-distance-row input",function(){o.mayBeAddDistanceRow()}),this.views.edit.on("click",".mapsvg-filter-insert-options",function(){var e,t,i=o.parameterName.split(".")[0],a=o.parameterName.split(".")[1];(e="Object"==i?o.formBuilder.mapsvg.database.getSchemaField(a):"id"==a?{options:o.formBuilder.mapsvg.getData().regions.map(function(e){return{label:e.id,value:e.id}})}:"region_title"==a?{options:o.formBuilder.mapsvg.getData().regions.map(function(e){return{label:e.title,value:e.title}})}:o.formBuilder.mapsvg.regionsDatabase.getSchemaField(a))&&e.options&&(t="regions"==a?(e.options[0].title&&e.options[0].title.length&&e.options.sort(function(e,t){return e.title<t.title?-1:e.title>t.title?1:0}),e.options.map(function(e){return(e.title||e.id)+":"+e.id})):e.options.map(function(e){return e.label+":"+e.value}),c(this).closest(".form-group").find("textarea").val(t.join("\n")).trigger("change"))}),this.views.edit.on("keyup change paste","input, textarea, select",function(){var e=c(this).attr("name"),t=c(this).data("array");if("status"===o.type&&t){var i=c(this).data("param"),a=c(this).closest("tr").index();o.options[a]=o.options[a]||{label:"",value:"",color:"",disabled:!1},o.options[a][i]=c(this).is(":checkbox")?c(this).prop("checked"):c(this).val(),o.redraw()}else if("distance"===o.type&&t){i=c(this).data("param"),a=c(this).closest("tr").index();o.options[a]||(o.options[a]={value:"",default:!1}),"default"===i?(o.options.forEach(function(e,t){e.default=!1}),o.options[a].default=c(this).prop("checked")):o.options[a].value=c(this).val(),o.redraw()}else{if("label"==e||"name"==e)return!1;var s;if(s="checkbox"==c(this).attr("type")?c(this).prop("checked"):c(this).val(),"radio"==c(this).attr("type")){var r=c(this).attr("name");s=c('input[name="'+r+'"]:checked').val()}o.update(e,s)}}),this.views.edit.on("keyup change paste",'input[name="label"]',function(){if(!o.nameChanged){var e=c(this).val();e=e.toLowerCase().replace(/ /g,"_").replace(/\W/g,""),o.views.edit.find('input[name="name"]').val(e),o.label=c(this).val(),"region"!=o.type&&(o.name=e),o.views.result.find("label").first().html(o.label),o.formBuilder.filtersMode||o.views.result.find("label").first().append('<div class="field-name">'+o.name+"</div>")}}),this.views.edit.on("keyup change paste",'input[name="name"]',function(){this.value&&(this.value.match(/[^a-zA-Z0-9_]/g)&&(this.value=this.value.replace(/[^a-zA-Z0-9_]/g,""),c(this).trigger("change")),this.value[0].match(/[^a-zA-Z_]/g)&&(this.value=this.value[0].replace(/[^a-zA-Z_]/g,"")+this.value.slice(1),c(this).trigger("change"))),"region"!=o.type&&(o.name=this.value),o.views.result.find("label").html(o.label+'<div class="field-name">'+o.name+"</div>"),o.nameChanged=!0})},a.prototype.getEditor=function(){return this.formBuilder.filtersMode?this.templates.edit=this.templates.edit||Handlebars.compile(c("#mapsvg-filters-tmpl-"+this.type+"-control").html()):this.templates.edit=this.templates.edit||Handlebars.compile(c("#mapsvg-data-tmpl-"+this.type+"-control").html()),this.views.edit=c(this.templates.edit(this.get())),this.views.edit},a.prototype.destroyEditor=function(){this.views.edit.empty().remove()},a.prototype.initEditor=function(){var a=this;this.views.edit.find("input").first().select(),c().mselect2&&("distance"!==this.type?this.views.edit.find("select").css({width:"100%",display:"block"}).mselect2():this.views.edit.find("select").mselect2()),"status"==this.type&&(a.views.edit.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){var t=c(this).find("input"),i=c(this).closest("tr").index();""==t.val()&&c(this).find("i").css({"background-color":""}),a.options[i]=a.options[i]||{label:"",value:"",color:"",disabled:!1},a.options[i].color=t.val()}),a.mayBeAddStatusRow()),"distance"===this.type&&a.mayBeAddDistanceRow(),this.views.edit.find(".mapsvg-onoff").bootstrapToggle({onstyle:"default",offstyle:"default"}),this.setEditorEventHandlers()},a.prototype.mayBeAddStatusRow=function(){var a=this;this.templates.editStatusRow=this.templates.editStatusRow||c(c("#mapsvg-edit-status-row").html());var e=a.views.edit.find(".mapsvg-edit-status-label:last-child");if(e&&e.last()&&e.last().val()&&e.last().val().trim().length){var t=this.templates.editStatusRow.clone();t.insertAfter(a.views.edit.find(".mapsvg-edit-status-row:last-child")),t.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){var t=c(this).find("input"),i=c(this).closest("tr").index();""==t.val()&&c(this).find("i").css({"background-color":""}),a.options[i]=a.options[i]||{label:"",value:"",color:"",disabled:!1},a.options[i].color=t.val()})}var i=a.views.edit.find(".mapsvg-edit-status-row"),s=i.eq(i.length-2),r=i.eq(i.length-1);s.length&&r.length&&!(s.find("input:eq(0)").val().trim()||s.find("input:eq(1)").val().trim()||s.find("input:eq(2)").val().trim())&&!(r.find("input:eq(0)").val().trim()||r.find("input:eq(1)").val().trim()||r.find("input:eq(2)").val().trim())&&r.remove()},a.prototype.mayBeAddDistanceRow=function(){this.templates.editDistanceRow=this.templates.editDistanceRow||c(c("#mapsvg-edit-distance-row").html());var e=this.views.edit.find(".mapsvg-edit-distance-row:last-child input");e&&e.last()&&e.last().val()&&e.last().val().trim().length&&this.templates.editDistanceRow.clone().insertAfter(this.views.edit.find(".mapsvg-edit-distance-row:last-child"));var t=this.views.edit.find(".mapsvg-edit-distance-row"),i=t.eq(t.length-2),a=t.eq(t.length-1);i.length&&a.length&&!i.find("input:eq(0)").val().trim()&&!a.find("input:eq(0)").val().trim()&&a.remove()},a.prototype.getSchema=function(){var t=this,i={type:this.type,db_type:this.db_type,label:this.label,name:this.name,value:this.value,searchable:d.parseBoolean(this.searchable)};if("select"==this.type&&(i.multiselect=d.parseBoolean(this.multiselect),i.multiselect&&(i.db_type="text"),i.optionsGrouped=this.optionsGrouped),this.options){var e=c.extend(!0,{},{options:this.options});i.options=e.options,i.optionsDict={},"region"==i.type?i.options.forEach(function(e){i.optionsDict[e.id]=e.title||e.id}):"status"==t.type?i.options.forEach(function(e,t){""===i.options[t].value?i.options.splice(t,1):(i.options[t].disabled=d.parseBoolean(i.options[t].disabled),i.optionsDict[e.value]=e)}):"distance"==t.type?i.options.forEach(function(e,t){""===i.options[t].value?i.options.splice(t,1):i.options[t].default=d.parseBoolean(i.options[t].default)}):i.options.forEach(function(e){i.optionsDict[e.value]="status"==t.type?e:e.label})}return this.help&&(i.help=this.help),this.button_text&&(i.button_text=this.button_text),"post"==this.type&&(i.post_type=this.post_type,i.add_fields=this.add_fields),"date"==this.type&&(i.language=this.language),"textarea"==this.type&&(i.autobr=this.autobr,i.html=this.html),"modal"==this.type&&(i.buttonText=this.buttonText),"distance"==this.type&&(i.distanceControl=this.distanceControl,i.distanceUnits=this.distanceUnits,i.distanceUnitsLabel=this.distanceUnitsLabel,i.fromLabel=this.fromLabel,i.addressField=this.addressField,i.addressFieldPlaceholder=this.addressFieldPlaceholder,i.userLocationButton=this.userLocationButton,i.placeholder=this.placeholder,"none"===i.distanceControl&&(i.distanceDefault=i.options.filter(function(e){return e.default})[0].value)),"search"==this.type&&(i.fallback=d.parseBoolean(this.fallback),i.placeholder=this.placeholder,i.noResultsText=this.noResultsText,i.width=this.width),this.checkboxLabel&&(i.checkboxLabel=this.checkboxLabel),this.checkboxValue&&(i.checkboxValue=this.checkboxValue),this.formBuilder.filtersMode&&(i.parameterName=this.parameterName,i.parameterNameShort=this.parameterName.split(".")[1],i.placeholder=this.placeholder),i.visible=void 0===this.visible||this.visible,i},a.prototype.get=function(){var e=this.getSchema();if(e._name=e.name,this.formBuilder.namespace){e.name=this.name.split("[")[0];var t=this.name.split("[")[1]||"";t&&(t="["+t),e.name=this.formBuilder.namespace+"["+e.name+"]"+t}return"post"==this.type&&(this.formBuilder.admin&&(e.post_types=this.formBuilder.admin.getPostTypes()),e.post_type=this.post_type,e.post=this.post,e.add_fields=this.add_fields||0),"date"==this.type&&(this.formBuilder.admin&&(e.languages=this.languages),e.language=this.language),"location"===this.type&&this.location&&(e.location=this.location,this.location.marker&&(e.location.img=(0===this.location.marker.src.indexOf(d.urls.uploads)?"uploads/":"")+this.location.marker.src.split("/").pop())),"textarea"==this.type&&(e.html=this.html),e.databaseFields=this.databaseFields,e.regionFields=this.regionFields,e.placeholder=this.placeholder,e},a.prototype.update=function(e,t){var i=this;if("options"==e){var a=[];t=t.split("\n").forEach(function(e){e=e.trim().split(":"),"checkbox"==i.type&&3==e.length?a.push({label:e[0],name:e[1],value:e[2]}):"radio"!=i.type&&"select"!=i.type||2!=e.length||a.push({label:e[0],value:e[1]})}),this.options=a}else this[e]=t;"parameterName"==e&&this.views.edit.find(".mapsvg-filter-param-name").text(t),this.redraw()},a.prototype.redraw=function(){var e=c(this.templates.result(this.get()));this.views.result.html(e.html()),c().mselect2&&("distance"!==this.type?this.views.result.find("select").css({width:"100%",display:"block"}).mselect2().on("select2:focus",function(){c(this).mselect2("open")}):this.views.result.find("select").mselect2().on("select2:focus",function(){c(this).mselect2("open")})),c().colorpicker&&this.views.edit&&this.views.edit.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){""==c(this).find("input").val()&&c(this).find("i").css({"background-color":""})})};var t=function(e){var t=this;this.container=e.container,this.namespace=e.namespace,this.mediaUploader=e.mediaUploader,this.schema=e.schema||[],this.editMode=null!=e.editMode&&e.editMode,this.filtersMode=null!=e.filtersMode&&e.filtersMode,this.filtersHide=null!=e.filtersHide&&e.filtersHide,this.modal=null!=e.modal&&e.modal,this.admin=e.admin,this.mapsvg=e.mapsvg,this.data=e.data||{},this.eventHandlers=e.events,this.template="form-builder",this.closeOnSave=!0===e.closeOnSave,this.newRecord=!0===e.newRecord,this.types=e.types||["text","textarea","checkbox","radio","select","image","region","location","post","date"],this.templates={},this.elements={},this.view=c("<div />").addClass("mapsvg-form-builder"),this.editMode&&this.view.addClass("full-flex"),this.formControls=[],d.templatesLoaded[this.template]?this.init():c.get(d.urls.templates+t.template+".hbs?"+Math.random(),function(e){c(e).appendTo("body"),d.templatesLoaded[t.template]=!0,Handlebars.registerPartial("dataMarkerPartial",c("#mapsvg-data-tmpl-marker").html()),t.init()})};t.prototype.init=function(){var e=this;if(d.formBuilder=this,e.editMode){var t=Handlebars.compile(c("#mapsvg-form-editor-tmpl-ui").html());e.view.append(t({types:this.types})),e.view.addClass("edit")}else{var i=c('<div class="mapsvg-data-form-view"></div>');e.view.append(i),this.filtersMode||i.addClass("form-horizontal")}e.elements={buttons:{text:e.view.find("#mapsvg-data-btn-text"),textarea:e.view.find("#mapsvg-data-btn-textarea"),checkbox:e.view.find("#mapsvg-data-btn-checkbox"),radio:e.view.find("#mapsvg-data-btn-radio"),select:e.view.find("#mapsvg-data-btn-select"),image:e.view.find("#mapsvg-data-btn-image"),region:e.view.find("#mapsvg-data-btn-region"),marker:e.view.find("#mapsvg-data-btn-marker"),saveSchema:e.view.find("#mapsvg-data-btn-save-schema")},containers:{buttons_add:e.view.find("#mapsvg-data-buttons-add"),form_view:e.view.find(".mapsvg-data-form-view"),form_edit:e.view.find("#mapsvg-data-form-edit")}},e.redraw()},t.prototype.viewDidLoad=function(){_this.formControls.forEach(function(e){if(e.html){var t=e.views.result.find("textarea")[0];e.htmlEditor=CodeMirror.fromTextArea(t,{mode:{name:"handlebars",base:"text/html"},matchBrackets:!0,lineNumbers:!0})}})},t.prototype.setEventHandlers=function(){var p=this;c(e).off("keydown.form.mapsvg").on("keydown.form.mapsvg",function(e){d.formBuilder&&((e.metaKey||e.ctrlKey)&&13==e.keyCode?d.formBuilder.save():27==e.keyCode&&d.formBuilder.close())}),this.editMode?(this.view.on("click","#mapsvg-data-buttons-add button",function(e){e.preventDefault();var t=c(this).data("create");p.add({type:t})}),this.view.on("click","#mapsvg-data-btn-save-schema",function(e){e.preventDefault();var t=p.getSchema(),r={};p.formControls.forEach(function(e){r[e.name]=(r[e.name]||0)+1}),p.elements.containers.form_view.find(".form-group").removeClass("has-error");var o,n,l=[],d=["id","title","lat","lon","lng","location_lat","location_lon","location_lng","location_address","location_img","marker","marker_id","regions","region_id","post_id","post","post_title","post_url","keywords","status"],m={regions:"region",status:"status",post_id:"post",marker:"marker",location:"location"};p.formControls.forEach(function(e,t){var i=!1;if(!p.filtersMode)if(1<r[e.name])o||(o="Field names should be unique",l.push(o),i=!0);else if(0===e.name.length)n||(n="Field name can't be empty",l.push(n),i=!0);else if(-1!=d.indexOf(e.name)&&(!m[e.name]||m[e.name]&&m[e.name]!=e.type)){var a='Field name "'+e.name+'" is reserved, please set another name';l.push(a),i=!0}if(e.options&&"region"!=e.type&&"marker"!=e.type){var s=_.pluck(e.options,"value");s.length!=_.uniq(s).length&&(l.push('Check "Options" list - values should not repeat'),i=!0)}i&&e.views.result.addClass("has-error")}),0==l.length?p.eventHandlers.saveSchema&&p.eventHandlers.saveSchema(t):c.growl.error({title:"Errors",message:l.join("<br />")})}),setTimeout(function(){var e=p.elements.containers.form_view[0];p.sortable=new Sortable(e,{animation:150,onStart:function(){p.elements.containers.form_view.addClass("sorting")},onEnd:function(){setTimeout(function(){p.elements.containers.form_view.removeClass("sorting"),p.formControls=[],c(e).find(".form-group").each(function(e,t){p.formControls.push(c(t).data("formElement"))})},500)}})},1e3)):(p.view.on("click","button.btn-save",function(e){e.preventDefault(),p.save()}),p.view.on("click","button.btn-close",function(e){e.preventDefault(),p.close()})),new d.ResizeSensor(this.view[0],function(){p.scrollApi&&p.scrollApi.reinitialise()})},t.prototype.save=function(){var e=this;e.marker&&(e.marker.onChange=null,e.mapsvg.unsetEditingMarker());var t=e.getData();e.saved=!0,e.eventHandlers.save&&e.eventHandlers.save.call(e,t)},t.prototype.getData=function(){var i=this,e=i.toJSON(!0);return i.formControls.forEach(function(t){if("image"==t.type&&(e[t.name]=[],t.images&&t.images.length&&null!=t.images[0])){var a=[];t.views.result.find(".mapsvg-thumbnail-wrap").each(function(e,t){var i=c(t).data("image");a.push(i)}),t.images=a,e[t.name]=e[t.name].concat(t.images)}"location"==t.type&&(t.location?e[t.name]=t.location:e[t.name]=""),"post"==t.type&&(e.post=t.post),"region"==t.type&&(e.regions&&"object"==typeof e.regions&&e.regions.length?e.regions=e.regions.map(function(e){return{id:e,title:i.mapsvg.getRegion(e).title}}):e.regions=""),"select"==t.type&&t.multiselect&&e[t.name]&&e[t.name].length&&(e[t.name]=e[t.name].map(function(e){return{value:e,label:t.optionsDict[e]}}))}),null!=i.data.id&&(e.id=i.data.id),delete e.marker_id,e},t.prototype.getDataJSON=function(){var t=this,i=t.toJSON(!0);return t.formControls.forEach(function(e){if("image"==e.type&&(i[e.name]=[],e.images&&e.images.length&&null!=e.images[0])){var a=[];t.view.find(".mapsvg-thumbnail-wrap").each(function(e,t){var i=c(t).data("image");a.push(i)}),e.images=a,i[e.name]=i[e.name].concat(e.images)}"location"==e.type&&(i[e.name]=e.location)}),null!=t.data.id&&(i.id=t.data.id),i},t.prototype.redraw=function(e){var i=this;if(delete i.marker,i.container.empty(),i.elements.containers.form_view.empty(),i.formControls=[],i.data&&i.data.id&&i.add({type:"id",label:"ID",name:"id",value:i.data.id}),i.data&&i.data._title&&i.add({type:"title",label:"Title",name:"title",value:i.data._title}),i.schema&&i.schema.length&&i.schema.forEach(function(e){if(i.admin&&i.admin.isMetabox&&"post"==e.type);else{if(i.filtersMode?"distance"==e.type?e.value=i.data.distance?i.data.distance:void 0!==e.value?e.value:null:e.value=i.data[e.parameterNameShort]:e.value=i.data?i.data[e.name]:void 0!==e.value?e.value:null,"location"!=e.type||i.editMode?"post"==e.type&&(e.post=i.data.post):(e.value&&e.value.marker&&e.value.marker.id&&(i.marker=i.mapsvg.getMarker(e.value.marker.id).getOptions(),i.mapsvg.setEditingMarker(i.marker.id)),i.admin&&i.admin.setMode&&i.admin.setMode("editMarkers"),i.admin&&i.admin.enableMarkersMode(!0),i.mapsvg.setMarkerEditHandler(function(){i.marker=this.getOptions(),i.mapsvg.setEditingMarker(this.id),i.locationFormElement&&i.locationFormElement.renderMarker(i.mapsvg.getMarker(i.marker.id))})),i.filtersMode){if(!i.filtersHide||i.filtersHide&&i.modal&&"search"!==e.type||!i.modal&&"search"===e.type)var t=i.add(e)}else t=i.add(e);"location"==e.type&&(i.locationFormElement=t)}}),i.editMode||(0==this.schema.length?i.add({type:"empty"}):i.admin&&!i.admin.isMetabox&&i.add({type:"save"})),i.filtersMode&&i.filtersHide&&!i.modal&&i.add({type:"modal",buttonText:i.mapsvg.getData().options.filters.buttonText}),i.editMode||i.filtersMode)i.container.html(this.view);else{var t=c('<div class="nano"></div>'),a=c('<div class="nano-content"></div>');t.append(a),a.html(this.view),i.container.html(t),t.jScrollPane(),i.scrollApi=t.data("jsp")}i.eventHandlers.load&&i.eventHandlers.load(),this.editMode||i.filtersMode||this.view.find("input:visible,textarea:visible").not(".tt-hint").first().focus(),this.container.find(".CodeMirror").each(function(e,t){t&&t.CodeMirror.refresh()}),i.setEventHandlers(),i.eventHandlers.init&&i.eventHandlers.init(i.data)},t.prototype.delete=function(i){var a=this;a.formControls.forEach(function(e,t){e===i&&(a.formControls.splice(t,1),a.structureChanged=!0)})},t.prototype.add=function(t){if(-1!=["region","marker","post","status","distance","location","search"].indexOf(t.type)){var i=!1;if(this.formControls.forEach(function(e){e.type==t.type&&(i=!0)}),i)return void c.growl.error({title:"Error",message:'You can add only 1 "'+d.ucfirst(t.type)+'" field'})}"date"==t.type&&(d.datepicker=d.datepicker||{});var e=new a(t,this);return this.formControls.push(e),this.elements.containers.form_view.append(e.views.result),this.editMode&&this.edit(e),e},t.prototype.edit=function(e){var t=this;t.currentlyEditing&&t.currentlyEditing.destroyEditor(),t.elements.containers.form_edit.append(e.getEditor()),e.initEditor(),t.currentlyEditing=e,t.elements.containers.form_view.find(".form-group.active").removeClass("active"),e.views.result.addClass("active")},t.prototype.get=function(){return this.formControls.map(function(e){return e.get()})},t.prototype.getSchema=function(){return this.formControls.map(function(e){return e.getSchema()})},t.prototype.close=function(){var e=this;if(!e.saved){if(null==e.data.id&&e.marker){var t=e.mapsvg.getMarker(e.marker.id);t.onChange=null,t.delete(),delete e.marker}if(e.marker){var i=e.mapsvg.getEditingMarker();i&&(i.update(e.marker),e.mapsvg.unsetEditingMarker())}}if(e.markerSelector&&e.markerSelector.popover("destroy"),c().mselect2){var a=e.view.find(".mapsvg-select2");a.length&&a.mselect2("destroy")}var s=e.view.find(".CodeMirror");s.length&&s.empty().remove(),e.admin&&e.admin.enableMarkersMode(!1),d.formBuilder=null,e.eventHandlers.close&&e.eventHandlers.close()},t.prototype.destroy=function(){this.view.empty().remove(),this.sortable=null},t.prototype.on=function(e,t){this.eventHandlers[e]=t},t.prototype.toJSON=function(s){var t={};return this.elements.containers.form_view.find("input, textarea, select").each(function(){var e;c(this).data("skip")||c(this).prop("disabled")||!c(this).attr("name")||!s&&"checkbox"==c(this).attr("type")&&null==c(this).attr("checked")||"radio"==c(this).attr("type")&&null==c(this).attr("checked")||(e="checkbox"==c(this).attr("type")?c(this).prop("checked"):c(this).val(),function e(t,i,a){if(!s&&!a)return!1;1==i.length?t[i[0]]=a:(null==t[i[0]]&&(t[i[0]]={}),e(t[i[0]],i.slice(1),a))}(t,c(this).attr("name").replace(/]/g,"").split("["),e))}),t},t.prototype.getRegionsList=function(){return this.mapsvg.getData().regions.map(function(e){return{id:e.id,title:e.title}})},t.prototype.getMarkersList=function(){return this.mapsvg.getData().markers.map(function(e){return{id:e.id}})},d.FormBuilder=t}(jQuery,MapSVG,window);
!function(e,n){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e.Bloodhound=n(t)}):"object"==typeof exports?module.exports=n(require("jquery")):e.Bloodhound=n(e.jQuery)}(this,function(f){var p=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:f.isArray,isFunction:f.isFunction,isObject:f.isPlainObject,isUndefined:function(t){return void 0===t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(t){return t instanceof f},toStr:function(t){return p.isUndefined(t)||null===t?"":t+""},bind:f.proxy,each:function(t,n){f.each(t,function(t,e){return n(e,t)})},map:f.map,filter:f.grep,every:function(n,i){var s=!0;return n?(f.each(n,function(t,e){if(!(s=i.call(null,e,t,n)))return!1}),!!s):s},some:function(n,i){var s=!1;return n?(f.each(n,function(t,e){if(s=i.call(null,e,t,n))return!1}),!!s):s},mixin:f.extend,identity:function(t){return t},clone:function(t){return f.extend(!0,{},t)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(t){return f.isFunction(t)?t:function(){return String(t)}},defer:function(t){setTimeout(t,0)},debounce:function(s,r,o){var a,u;return function(){var t,e,n=this,i=arguments;return t=function(){a=null,o||(u=s.apply(n,i))},e=o&&!a,clearTimeout(a),a=setTimeout(t,r),e&&(u=s.apply(n,i)),u}},throttle:function(n,i){var s,r,o,a,u,c;return u=0,c=function(){u=new Date,o=null,a=n.apply(s,r)},function(){var t=new Date,e=i-(t-u);return s=this,r=arguments,e<=0?(clearTimeout(o),o=null,u=t,a=n.apply(s,r)):o||(o=setTimeout(c,e)),a}},stringify:function(t){return p.isString(t)?t:JSON.stringify(t)},guid:function(){function t(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return"tt-"+t()+t(!0)+t(!0)+t()},noop:function(){}}}(),n=function(){"use strict";function t(t){return(t=p.toStr(t))?t.split(/\s+/):[]}function e(t){return(t=p.toStr(t))?t.split(/\W+/):[]}function n(t){t=p.toStr(t);var e=[],n="";return p.each(t.split(""),function(t){t.match(/\s+/)?n="":(e.push(n+t),n+=t)}),e}function i(i){return function(t){return t=p.isArray(t)?t:[].slice.call(arguments,0),function(e){var n=[];return p.each(t,function(t){n=n.concat(i(p.toStr(e[t])))}),n}}}return{nonword:e,whitespace:t,ngram:n,obj:{nonword:i(e),whitespace:i(t),ngram:i(n)}}}(),i=function(){"use strict";function t(t){this.maxSize=p.isNumber(t)?t:100,this.reset(),this.maxSize<=0&&(this.set=this.get=f.noop)}function e(){this.head=this.tail=null}function s(t,e){this.key=t,this.val=e,this.prev=this.next=null}return p.mixin(t.prototype,{set:function(t,e){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key],this.size--),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new s(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];if(e)return this.list.moveToFront(e),e.val},reset:function(){this.size=0,this.hash={},this.list=new e}}),p.mixin(e.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),t}(),e=function(){"use strict";function t(t,e){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+p.escapeRegExChars(this.prefix)),this.ls=e||r,!this.ls&&this._noop()}function i(){return(new Date).getTime()}function s(t){return JSON.stringify(p.isUndefined(t)?null:t)}function n(t){return f.parseJSON(t)}var r;try{(r=window.localStorage).setItem("~~~","!"),r.removeItem("~~~")}catch(t){r=null}return p.mixin(t.prototype,{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=p.noop},_safeSet:function(t,e){try{this.ls.setItem(t,e)}catch(t){"QuotaExceededError"===t.name&&(this.clear(),this._noop())}},get:function(t){return this.isExpired(t)&&this.remove(t),n(this.ls.getItem(this._prefix(t)))},set:function(t,e,n){return p.isNumber(n)?this._safeSet(this._ttlKey(t),s(i()+n)):this.ls.removeItem(this._ttlKey(t)),this._safeSet(this._prefix(t),s(e))},remove:function(t){return this.ls.removeItem(this._ttlKey(t)),this.ls.removeItem(this._prefix(t)),this},clear:function(){var t,e=function(t){var e,n,i=[],s=r.length;for(e=0;e<s;e++)(n=r.key(e)).match(t)&&i.push(n.replace(t,""));return i}(this.keyMatcher);for(t=e.length;t--;)this.remove(e[t]);return this},isExpired:function(t){var e=n(this.ls.getItem(this._ttlKey(t)));return!!(p.isNumber(e)&&i()>e)}}),t}(),s=function(){"use strict";function t(t){t=t||{},this.maxPendingRequests=t.maxPendingRequests||6,this.cancelled=!1,this.lastReq=null,this._send=t.transport,this._get=t.limiter?t.limiter(this._get):this._get,this._cache=!1===t.cache?new i(0):e}var a=0,u={},e=new i(10);return t.setMaxPendingRequests=function(t){this.maxPendingRequests=t},t.resetCache=function(){e.reset()},p.mixin(t.prototype,{_fingerprint:function(t){return(t=t||{}).url+t.type+f.param(t.data||{})},_get:function(t,e){function n(t){e(null,t),o._cache.set(s,t)}function i(){e(!0)}var s,r,o=this;s=this._fingerprint(t),this.cancelled||s!==this.lastReq||((r=u[s])?r.done(n).fail(i):a<this.maxPendingRequests?(a++,u[s]=this._send(t).done(n).fail(i).always(function(){a--,delete u[s],o.onDeckRequestArgs&&(o._get.apply(o,o.onDeckRequestArgs),o.onDeckRequestArgs=null)})):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(t,e){var n,i;e=e||f.noop,t=p.isString(t)?{url:t}:t||{},i=this._fingerprint(t),this.cancelled=!1,this.lastReq=i,(n=this._cache.get(i))?e(null,n):this._get(t,e)},cancel:function(){this.cancelled=!0}}),t}(),r=window.SearchIndex=function(){"use strict";function t(t){(t=t||{}).datumTokenizer&&t.queryTokenizer||f.error("datumTokenizer and queryTokenizer are both required"),this.identify=t.identify||p.stringify,this.datumTokenizer=t.datumTokenizer,this.queryTokenizer=t.queryTokenizer,this.matchAnyQueryToken=t.matchAnyQueryToken,this.reset()}function n(t){return t=p.filter(t,function(t){return!!t}),p.map(t,function(t){return t.toLowerCase()})}function o(){var t={};return t[u]=[],t[a]={},t}var a="c",u="i";return p.mixin(t.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var r=this;t=p.isArray(t)?t:[t],p.each(t,function(t){var s,e;r.datums[s=r.identify(t)]=t,e=n(r.datumTokenizer(t)),p.each(e,function(t){var e,n,i;for(e=r.trie,n=t.split("");i=n.shift();)(e=e[a][i]||(e[a][i]=o()))[u].push(s)})})},get:function(t){var e=this;return p.map(t,function(t){return e.datums[t]})},search:function(t){var e,r,o=this;return e=n(this.queryTokenizer(t)),p.each(e,function(t){var e,n,i,s;if(r&&0===r.length&&!o.matchAnyQueryToken)return!1;for(e=o.trie,n=t.split("");e&&(i=n.shift());)e=e[a][i];if(e&&0===n.length)s=e[u].slice(0),r=r?function(t,e){var n=0,i=0,s=[];t=t.sort(),e=e.sort();for(var r=t.length,o=e.length;n<r&&i<o;)t[n]<e[i]?n++:(t[n]>e[i]||(s.push(t[n]),n++),i++);return s}(r,s):s;else if(!o.matchAnyQueryToken)return!(r=[])}),r?p.map(function(t){for(var e={},n=[],i=0,s=t.length;i<s;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}(r),function(t){return o.datums[t]}):[]},all:function(){var t=[];for(var e in this.datums)t.push(this.datums[e]);return t},reset:function(){this.datums={},this.trie=o()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),t}(),o=function(){"use strict";function t(t){this.url=t.url,this.ttl=t.ttl,this.cache=t.cache,this.prepare=t.prepare,this.transform=t.transform,this.transport=t.transport,this.thumbprint=t.thumbprint,this.storage=new e(t.cacheKey)}var n;return n={data:"data",protocol:"protocol",thumbprint:"thumbprint"},p.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(t){this.cache&&(this.storage.set(n.data,t,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var t,e={};return this.cache?(e.data=this.storage.get(n.data),e.protocol=this.storage.get(n.protocol),e.thumbprint=this.storage.get(n.thumbprint),t=e.thumbprint!==this.thumbprint||e.protocol!==location.protocol,e.data&&!t?e.data:null):null},fromNetwork:function(e){var t,n=this;e&&(t=this.prepare(this._settings()),this.transport(t).fail(function(){e(!0)}).done(function(t){e(null,n.transform(t))}))},clear:function(){return this.storage.clear(),this}}),t}(),a=function(){"use strict";function t(t){this.url=t.url,this.prepare=t.prepare,this.transform=t.transform,this.indexResponse=t.indexResponse,this.transport=new s({cache:t.cache,limiter:t.limiter,transport:t.transport,maxPendingRequests:t.maxPendingRequests})}return p.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(t,n){var e,i=this;if(n)return t=t||"",e=this.prepare(t,this._settings()),this.transport.get(e,function(t,e){n(t?[]:i.transform(e))})},cancelLastRequest:function(){this.transport.cancel()}}),t}(),u=function(){"use strict";function r(t){var e,n,i,s,r,o,a,u,c,h,l;if(t)return e={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:p.identity,transport:null},t=p.isString(t)?{url:t}:t,!(t=p.mixin(e,t)).url&&f.error("remote requires url to be set"),t.transform=t.filter||t.transform,t.prepare=(c=(u=t).prepare,h=u.replace,l=u.wildcard,c||(c=h?function(t,e){return e.url=h(e.url,t),e}:u.wildcard?function(t,e){return e.url=e.url.replace(l,encodeURIComponent(t)),e}:function(t,e){return e})),t.limiter=(i=(n=t).limiter,s=n.rateLimitBy,r=n.rateLimitWait,i||(i=/^throttle$/i.test(s)?(a=r,function(t){return p.throttle(t,a)}):(o=r,function(t){return p.debounce(t,o)})),i),t.transport=t.transport?d(t.transport):f.ajax,delete t.replace,delete t.wildcard,delete t.rateLimitBy,delete t.rateLimitWait,t}function d(n){return function(t){var e=f.Deferred();return n(t,function(t){p.defer(function(){e.resolve(t)})},function(t){p.defer(function(){e.reject(t)})}),e}}return function(t){var e,n,i,s;return e={initialize:!0,identify:p.stringify,datumTokenizer:null,queryTokenizer:null,matchAnyQueryToken:!1,sufficient:5,indexRemote:!1,sorter:null,local:[],prefetch:null,remote:null},!(t=p.mixin(e,t||{})).datumTokenizer&&f.error("datumTokenizer is required"),!t.queryTokenizer&&f.error("queryTokenizer is required"),n=t.sorter,t.sorter=n?function(t){return t.sort(n)}:p.identity,t.local=p.isFunction(t.local)?t.local():t.local,t.prefetch=(i=t.prefetch)?(s={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:p.identity,transform:p.identity,transport:null},i=p.isString(i)?{url:i}:i,!(i=p.mixin(s,i)).url&&f.error("prefetch requires url to be set"),i.transform=i.filter||i.transform,i.cacheKey=i.cacheKey||i.url,i.thumbprint="1.2.0"+i.thumbprint,i.transport=i.transport?d(i.transport):f.ajax,i):null,t.remote=r(t.remote),t}}();return function(){"use strict";function t(t){t=u(t),this.sorter=t.sorter,this.identify=t.identify,this.sufficient=t.sufficient,this.indexRemote=t.indexRemote,this.local=t.local,this.remote=t.remote?new a(t.remote):null,this.prefetch=t.prefetch?new o(t.prefetch):null,this.index=new r({identify:this.identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),!1!==t.initialize&&this.initialize()}var e;return e=window&&window.Bloodhound,t.noConflict=function(){return window&&(window.Bloodhound=e),t},t.tokenizers=n,p.mixin(t.prototype,{__ttAdapter:function(){var i=this;return this.remote?function(t,e,n){return i.search(t,e,n)}:function(t,e){return i.search(t,e)}},_loadPrefetch:function(){var n,t,i=this;return n=f.Deferred(),this.prefetch?(t=this.prefetch.fromCache())?(this.index.bootstrap(t),n.resolve()):this.prefetch.fromNetwork(function(t,e){return t?n.reject():(i.add(e),i.prefetch.store(i.index.serialize()),void n.resolve())}):n.resolve(),n.promise()},_initialize:function(){var t=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(function(){t.add(t.local)}),this.initPromise},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){return this.index.add(t),this},get:function(t){return t=p.isArray(t)?t:[].slice.call(arguments),this.index.get(t)},search:function(t,e,i){var s,r=this;return e=e||p.noop,i=i||p.noop,s=this.sorter(this.index.search(t)),e(this.remote?s.slice():s),this.remote&&s.length<this.sufficient?this.remote.get(t,function(t){var n=[];p.each(t,function(e){!p.some(s,function(t){return r.identify(e)===r.identify(t)})&&n.push(e)}),r.indexRemote&&r.add(n),i(n)}):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return s.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),t}()}),function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e(t)}):"object"==typeof exports?module.exports=e(require("jquery")):e(t.jQuery)}(this,function(_){var b=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:_.isArray,isFunction:_.isFunction,isObject:_.isPlainObject,isUndefined:function(t){return void 0===t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(t){return t instanceof _},toStr:function(t){return b.isUndefined(t)||null===t?"":t+""},bind:_.proxy,each:function(t,n){_.each(t,function(t,e){return n(e,t)})},map:_.map,filter:_.grep,every:function(n,i){var s=!0;return n?(_.each(n,function(t,e){if(!(s=i.call(null,e,t,n)))return!1}),!!s):s},some:function(n,i){var s=!1;return n?(_.each(n,function(t,e){if(s=i.call(null,e,t,n))return!1}),!!s):s},mixin:_.extend,identity:function(t){return t},clone:function(t){return _.extend(!0,{},t)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(t){return _.isFunction(t)?t:function(){return String(t)}},defer:function(t){setTimeout(t,0)},debounce:function(s,r,o){var a,u;return function(){var t,e,n=this,i=arguments;return t=function(){a=null,o||(u=s.apply(n,i))},e=o&&!a,clearTimeout(a),a=setTimeout(t,r),e&&(u=s.apply(n,i)),u}},throttle:function(n,i){var s,r,o,a,u,c;return u=0,c=function(){u=new Date,o=null,a=n.apply(s,r)},function(){var t=new Date,e=i-(t-u);return s=this,r=arguments,e<=0?(clearTimeout(o),o=null,u=t,a=n.apply(s,r)):o||(o=setTimeout(c,e)),a}},stringify:function(t){return b.isString(t)?t:JSON.stringify(t)},guid:function(){function t(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return"tt-"+t()+t(!0)+t(!0)+t()},noop:function(){}}}(),n=function(){"use strict";var a={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return function(t){var e,n,i,s,r,o;return n=b.mixin({},a,t),{css:(e={css:(o={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}},b.isMsie()&&b.mixin(o.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),o),classes:n,html:(r=n,{wrapper:'<span class="'+r.wrapper+'"></span>',menu:'<div role="listbox" class="'+r.menu+'"></div>'}),selectors:(i=n,s={},b.each(i,function(t,e){s[e]="."+t}),s)}).css,html:e.html,classes:e.classes,selectors:e.selectors,mixin:function(t){b.mixin(t,e)}}}}(),x=function(){"use strict";function t(t){t&&t.el||_.error("EventBus initialized without el"),this.$el=_(t.el)}var n;return"typeahead:",n={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},b.mixin(t.prototype,{_trigger:function(t,e){var n=_.Event("typeahead:"+t);return this.$el.trigger.call(this.$el,n,e||[]),n},before:function(t){var e;return e=[].slice.call(arguments,1),this._trigger("before"+t,e).isDefaultPrevented()},trigger:function(t){var e;this._trigger(t,[].slice.call(arguments,1)),(e=n[t])&&this._trigger(e,[].slice.call(arguments,1))}}),t}(),e=function(){"use strict";function i(t,e,n,i){var s;if(!n)return this;for(e=e.split(a),n=i?function(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}(n,i):n,this._callbacks=this._callbacks||{};s=e.shift();)this._callbacks[s]=this._callbacks[s]||{sync:[],async:[]},this._callbacks[s][t].push(n);return this}function o(i,s,r){return function(){for(var t,e=0,n=i.length;!t&&e<n;e+=1)t=!1===i[e].apply(s,r);return!t}}var a=/\s+/,u=window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)};return{onSync:function(t,e,n){return i.call(this,"sync",t,e,n)},onAsync:function(t,e,n){return i.call(this,"async",t,e,n)},off:function(t){var e;if(!this._callbacks)return this;for(t=t.split(a);e=t.shift();)delete this._callbacks[e];return this},trigger:function(t){var e,n,i,s,r;if(!this._callbacks)return this;for(t=t.split(a),i=[].slice.call(arguments,1);(e=t.shift())&&(n=this._callbacks[e]);)s=o(n.sync,this,[e].concat(i)),r=o(n.async,this,[e].concat(i)),s()&&u(r);return this}}}(),u=function(o){"use strict";function c(t){return e[t.toUpperCase()]||t}var t={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1,diacriticInsensitive:!1},e={A:"[Aa--------]",B:"[Bb--]",C:"[Cc--]",D:"[Dd-----]",E:"[Ee------]",F:"[Ff--]",G:"[Gg--]",H:"[Hh---]",I:"[Ii---------]",J:"[Jj--]",K:"[Kk--]",L:"[Ll----]",M:"[Mm----]",N:"[Nn---]",O:"[Oo-----]",P:"[Pp---]",Q:"[Qq]",R:"[Rr-----]",S:"[Ss---]",T:"[Tt--]",U:"[Uu------]",V:"[Vv----]",W:"[Ww--]",X:"[Xx---]",Y:"[Yy--]",Z:"[Zz----]"};return function(s){var r;(s=b.mixin({},t,s)).node&&s.pattern&&(s.pattern=b.isArray(s.pattern)?s.pattern:[s.pattern],r=function(t,e,n,i){for(var s,r=[],o=0,a=t.length;o<a;o++){var u=b.escapeRegExChars(t[o]);i&&(u=u.replace(/\S/g,c)),r.push(u)}return s=n?"\\b("+r.join("|")+")\\b":"("+r.join("|")+")",e?new RegExp(s):new RegExp(s,"i")}(s.pattern,s.caseSensitive,s.wordsOnly,s.diacriticInsensitive),function t(e,n){for(var i,s=0;s<e.childNodes.length;s++)3===(i=e.childNodes[s]).nodeType?s+=n(i)?1:0:t(i,n)}(s.node,function(t){var e,n,i;return(e=r.exec(t.data))&&(i=o.createElement(s.tagName),s.className&&(i.className=s.className),(n=t.splitText(e.index)).splitText(e[0].length),i.appendChild(n.cloneNode(!0)),t.parentNode.replaceChild(i,n)),!!e}))}}(window.document),S=function(){"use strict";function o(t,e){var n;(t=t||{}).input||_.error("input is missing"),e.mixin(this),this.$hint=_(t.hint),this.$input=_(t.input),this.$input.attr({"aria-activedescendant":"","aria-owns":this.$input.attr("id")+"_listbox",role:"combobox","aria-readonly":"true","aria-autocomplete":"list"}),_(e.menu).attr("id",this.$input.attr("id")+"_listbox"),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=(n=this.$input,_('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:n.css("font-family"),fontSize:n.css("font-size"),fontStyle:n.css("font-style"),fontVariant:n.css("font-variant"),fontWeight:n.css("font-weight"),wordSpacing:n.css("word-spacing"),letterSpacing:n.css("letter-spacing"),textIndent:n.css("text-indent"),textRendering:n.css("text-rendering"),textTransform:n.css("text-transform")}).insertAfter(n)),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=b.noop),this.onSync("cursorchange",this._updateDescendent)}function i(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var r;return r={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},o.normalizeQuery=function(t){return b.toStr(t).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},b.mixin(o.prototype,e,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(t){var e=r[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(t,e){var n;switch(t){case"up":case"down":n=!i(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!i(e);break;default:n=!0}return n},_checkLanguageDirection:function(){var t=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==t&&(this.dir=t,this.$hint.attr("dir",t),this.trigger("langDirChanged",t))},_setQuery:function(t,e){var n,i,s,r;s=t,r=this.query,i=!!(n=o.normalizeQuery(s)===o.normalizeQuery(r))&&this.query.length!==t.length,this.query=t,e||n?!e&&i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},_updateDescendent:function(t,e){this.$input.attr("aria-activedescendant",e)},bind:function(){var t,e,n,i,s=this;return t=b.bind(this._onBlur,this),e=b.bind(this._onFocus,this),n=b.bind(this._onKeydown,this),i=b.bind(this._onInput,this),this.$input.on("blur.tt",t).on("focus.tt",e).on("keydown.tt",n),!b.isMsie()||9<b.isMsie()?this.$input.on("input.tt",i):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){r[t.which||t.keyCode]||b.defer(b.bind(s._onInput,s,t))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(t,e){this.setInputValue(t),this._setQuery(t,e)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(t){this.$input.val(t),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n;n=(t=this.getInputValue())!==(e=this.getHint())&&0===e.indexOf(t),!(""!==t&&n&&!this.hasOverflow())&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,e,n;return t=this.$input.val().length,e=this.$input[0].selectionStart,b.isNumber(e)?e===t:!document.selection||((n=document.selection.createRange()).moveStart("character",-t),t===n.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=_("<div>")}}),o}(),s=function(){"use strict";function t(t,e){var n,i,s,r;(t=t||{}).templates=t.templates||{},t.templates.notFound=t.templates.notFound||t.templates.empty,t.source||_.error("missing source"),t.node||_.error("missing node"),t.name&&(r=t.name,!/^[_a-zA-Z0-9-]+$/.test(r))&&_.error("invalid dataset name: "+t.name),e.mixin(this),this.highlight=!!t.highlight,this.name=b.toStr(t.name||a()),this.limit=t.limit||5,this.displayFn=(s=(s=t.display||t.displayKey)||b.stringify,b.isFunction(s)?s:function(t){return t[s]}),this.templates=(n=t.templates,i=this.displayFn,{notFound:n.notFound&&b.templatify(n.notFound),pending:n.pending&&b.templatify(n.pending),header:n.header&&b.templatify(n.header),footer:n.footer&&b.templatify(n.footer),suggestion:n.suggestion||function(t){return _('<div role="option">').attr("id",b.guid()).text(i(t))}}),this.source=t.source.__ttAdapter?t.source.__ttAdapter():t.source,this.async=b.isUndefined(t.async)?2<this.source.length:!!t.async,this._resetLastSuggestion(),this.$el=_(t.node).attr("role","presentation").addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}var o,a;return o={dataset:"tt-selectable-dataset",val:"tt-selectable-display",obj:"tt-selectable-object"},a=b.getIdGenerator(),t.extractData=function(t){var e=_(t);return e.data(o.obj)?{dataset:e.data(o.dataset)||"",val:e.data(o.val)||"",obj:e.data(o.obj)||null}:null},b.mixin(t.prototype,e,{_overwrite:function(t,e){(e=e||[]).length?this._renderSuggestions(t,e):this.async&&this.templates.pending?this._renderPending(t):!this.async&&this.templates.notFound?this._renderNotFound(t):this._empty(),this.trigger("rendered",e,!1,this.name)},_append:function(t,e){(e=e||[]).length&&this.$lastSuggestion.length?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(t),this.trigger("rendered",e,!0,this.name)},_renderSuggestions:function(t,e){var n;n=this._getSuggestionsFragment(t,e),this.$lastSuggestion=n.children().last(),this.$el.html(n).prepend(this._getHeader(t,e)).append(this._getFooter(t,e))},_appendSuggestions:function(t,e){var n,i;i=(n=this._getSuggestionsFragment(t,e)).children().last(),this.$lastSuggestion.after(n),this.$lastSuggestion=i},_renderPending:function(t){var e=this.templates.pending;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_renderNotFound:function(t){var e=this.templates.notFound;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(i,t){var s,r=this;return s=document.createDocumentFragment(),b.each(t,function(t){var e,n;n=r._injectQuery(i,t),e=_(r.templates.suggestion(n)).data(o.dataset,r.name).data(o.obj,t).data(o.val,r.displayFn(t)).addClass(r.classes.suggestion+" "+r.classes.selectable),s.appendChild(e[0])}),this.highlight&&u({className:this.classes.highlight,node:s,pattern:i}),_(s)},_getFooter:function(t,e){return this.templates.footer?this.templates.footer({query:t,suggestions:e,dataset:this.name}):null},_getHeader:function(t,e){return this.templates.header?this.templates.header({query:t,suggestions:e,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=_()},_injectQuery:function(t,e){return b.isObject(e)?b.mixin({_query:t},e):e},update:function(n){function t(t){e||(e=!0,t=(t||[]).slice(0,i.limit),r=t.length,i._overwrite(n,t),r<i.limit&&i.async&&i.trigger("asyncRequested",n,i.name))}var i=this,s=!1,e=!1,r=0;this.cancel(),this.cancel=function(){s=!0,i.cancel=_.noop,i.async&&i.trigger("asyncCanceled",n,i.name)},this.source(n,t,function(t){if(t=t||[],!s&&r<i.limit){i.cancel=_.noop;var e=Math.abs(r-i.limit);r+=e,i._append(n,t.slice(0,e)),i.async&&i.trigger("asyncReceived",n,i.name)}}),!e&&t([])},cancel:_.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=_("<div>")}}),t}(),w=function(){"use strict";function t(t,n){var i=this;(t=t||{}).node||_.error("node is required"),n.mixin(this),this.$node=_(t.node),this.query=null,this.datasets=b.map(t.datasets,function(t){var e=i.$node.find(t.node).first();return t.node=e.length?e:_("<div>").appendTo(i.$node),new s(t,n)})}return b.mixin(t.prototype,e,{_onSelectableClick:function(t){this.trigger("selectableClicked",_(t.currentTarget))},_onRendered:function(t,e,n,i){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",e,n,i)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){return b.every(this.datasets,b.bind(function(t){var e=t.isEmpty();return this.$node.attr("aria-expanded",!e),e},this))},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var t=this.getActiveSelectable();t&&t.removeClass(this.classes.cursor)},_ensureVisible:function(t){var e,n,i,s;n=(e=t.position().top)+t.outerHeight(!0),i=this.$node.scrollTop(),s=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),e<0?this.$node.scrollTop(i+e):s<n&&this.$node.scrollTop(i+(n-s))},bind:function(){var t,e=this;return t=b.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,t),this.$node.on("mouseover",this.selectors.selectable,function(){e.setCursor(_(this))}),this.$node.on("mouseleave",function(){e._removeCursor()}),b.each(this.datasets,function(t){t.onSync("asyncRequested",e._propagate,e).onSync("asyncCanceled",e._propagate,e).onSync("asyncReceived",e._propagate,e).onSync("rendered",e._onRendered,e).onSync("cleared",e._onCleared,e)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.scrollTop(0),this.$node.addClass(this.classes.open)},close:function(){this.$node.attr("aria-expanded",!1),this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(t){this.$node.attr("dir",t)},selectableRelativeToCursor:function(t){var e,n,i;return n=this.getActiveSelectable(),e=this._getSelectables(),-1===(i=(i=((i=(n?e.index(n):-1)+t)+1)%(e.length+1)-1)<-1?e.length-1:i)?null:e.eq(i)},setCursor:function(t){this._removeCursor(),(t=t&&t.first())&&(t.addClass(this.classes.cursor),this._ensureVisible(t))},getSelectableData:function(t){return t&&t.length?s.extractData(t):null},getActiveSelectable:function(){var t=this._getSelectables().filter(this.selectors.cursor).first();return t.length?t:null},getTopSelectable:function(){var t=this._getSelectables().first();return t.length?t:null},update:function(e){var t=e!==this.query;return t&&(this.query=e,b.each(this.datasets,function(t){t.update(e)})),t},empty:function(){b.each(this.datasets,function(t){t.clear()}),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){this.$node.off(".tt"),this.$node=_("<div>"),b.each(this.datasets,function(t){t.destroy()})}}),t}(),A=function(){"use strict";function t(t){this.$el=_("<span></span>",{role:"status","aria-live":"polite"}).css({position:"absolute",padding:"0",border:"0",height:"1px",width:"1px","margin-bottom":"-1px","margin-right":"-1px",overflow:"hidden",clip:"rect(0 0 0 0)","white-space":"nowrap"}),t.$input.after(this.$el),b.each(t.menu.datasets,b.bind(function(t){t.onSync&&(t.onSync("rendered",b.bind(this.update,this)),t.onSync("cleared",b.bind(this.cleared,this)))},this))}return b.mixin(t.prototype,{update:function(t,e){var n,i=e.length;n=1===i?{result:"result",is:"is"}:{result:"results",is:"are"},this.$el.text(i+" "+n.result+" "+n.is+" available, use up and down arrow keys to navigate.")},cleared:function(){this.$el.text("")}}),t}(),k=function(){"use strict";function t(){w.apply(this,[].slice.call(arguments,0))}var e=w.prototype;return b.mixin(t.prototype,w.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),e.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),e.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),e._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),e._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(t){return this.$node.css("ltr"===t?this.css.ltr:this.css.rtl),e.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),t}(),$=function(){"use strict";function t(t,e){var n,i,s,r,o,a,u,c,h,l,d;(t=t||{}).input||_.error("missing input"),t.menu||_.error("missing menu"),t.eventBus||_.error("missing event bus"),e.mixin(this),this.eventBus=t.eventBus,this.minLength=b.isNumber(t.minLength)?t.minLength:1,this.input=t.input,this.menu=t.menu,this.enabled=!0,this.autoselect=!!t.autoselect,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),n=f(this,"activate","open","_onFocused"),i=f(this,"deactivate","_onBlurred"),s=f(this,"isActive","isOpen","_onEnterKeyed"),r=f(this,"isActive","isOpen","_onTabKeyed"),o=f(this,"isActive","_onEscKeyed"),a=f(this,"isActive","open","_onUpKeyed"),u=f(this,"isActive","open","_onDownKeyed"),c=f(this,"isActive","isOpen","_onLeftKeyed"),h=f(this,"isActive","isOpen","_onRightKeyed"),l=f(this,"_openIfActive","_onQueryChanged"),d=f(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",n,this).onSync("blurred",i,this).onSync("enterKeyed",s,this).onSync("tabKeyed",r,this).onSync("escKeyed",o,this).onSync("upKeyed",a,this).onSync("downKeyed",u,this).onSync("leftKeyed",c,this).onSync("rightKeyed",h,this).onSync("queryChanged",l,this).onSync("whitespaceChanged",d,this).onSync("langDirChanged",this._onLangDirChanged,this)}function f(n){var t=[].slice.call(arguments,1);return function(){var e=[].slice.call(arguments);b.each(t,function(t){return n[t].apply(n,e)})}}return b.mixin(t.prototype,{_hacks:function(){var s,r;s=this.input.$input||_("<div>"),r=this.menu.$node||_("<div>"),s.on("blur.tt",function(t){var e,n,i;e=document.activeElement,n=r.is(e),i=0<r.has(e).length,b.isMsie()&&(n||i)&&(t.preventDefault(),t.stopImmediatePropagation(),b.defer(function(){s.focus()}))}),r.on("mousedown.tt",function(t){t.preventDefault()})},_onSelectableClicked:function(t,e){this.select(e)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(t,e,n,i){if(this._updateHint(),this.autoselect){var s=this.selectors.cursor.substr(1);this.menu.$node.find(this.selectors.suggestion).first().addClass(s)}this.eventBus.trigger("render",e,n,i)},_onAsyncRequested:function(t,e,n){this.eventBus.trigger("asyncrequest",n,e)},_onAsyncCanceled:function(t,e,n){this.eventBus.trigger("asynccancel",n,e)},_onAsyncReceived:function(t,e,n){this.eventBus.trigger("asyncreceive",n,e)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&(e.preventDefault(),e.stopPropagation()):this.autoselect&&this.select(this.menu.getTopSelectable())&&(e.preventDefault(),e.stopPropagation())},_onTabKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&e.preventDefault():(n=this.menu.getTopSelectable())&&this.autocomplete(n)&&e.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getActiveSelectable()||this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getActiveSelectable()||this.menu.getTopSelectable())},_onQueryChanged:function(t,e){this._minLengthMet(e)?this.menu.update(e):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(t,e){this.dir!==e&&(this.dir=e,this.menu.setLanguageDirection(e))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(t){return(t=b.isString(t)?t:this.input.getQuery()||"").length>=this.minLength},_updateHint:function(){var t,e,n,i,s,r;t=this.menu.getTopSelectable(),e=this.menu.getSelectableData(t),n=this.input.getInputValue(),!e||b.isBlankString(n)||this.input.hasOverflow()?this.input.clearHint():(i=S.normalizeQuery(n),s=b.escapeRegExChars(i),(r=new RegExp("^(?:"+s+")(.+$)","i").exec(e.val))&&this.input.setHint(n+r[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return!!this.isActive()||!(!this.isEnabled()||this.eventBus.before("active"))&&(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return!this.isActive()||!this.eventBus.before("idle")&&(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0)},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(t){this.input.setQuery(b.toStr(t))},getVal:function(){return this.input.getQuery()},select:function(t){var e=this.menu.getSelectableData(t);return!(!e||this.eventBus.before("select",e.obj,e.dataset)||(this.input.setQuery(e.val,!0),this.eventBus.trigger("select",e.obj,e.dataset),this.close(),0))},autocomplete:function(t){var e,n;return e=this.input.getQuery(),!(!((n=this.menu.getSelectableData(t))&&e!==n.val)||this.eventBus.before("autocomplete",n.obj,n.dataset)||(this.input.setQuery(n.val),this.eventBus.trigger("autocomplete",n.obj,n.dataset),0))},moveCursor:function(t){var e,n,i,s,r,o;return e=this.input.getQuery(),n=this.menu.selectableRelativeToCursor(t),s=(i=this.menu.getSelectableData(n))?i.obj:null,r=i?i.dataset:null,o=n?n.attr("id"):null,this.input.trigger("cursorchange",o),!(this._minLengthMet()&&this.menu.update(e))&&!this.eventBus.before("cursorchange",s,r)&&(this.menu.setCursor(n),i?this.input.setInputValue(i.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",s,r),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),t}();!function(){"use strict";function i(t,n){t.each(function(){var t,e=_(this);(t=e.data(v.typeahead))&&n(t,e)})}function y(t){var e;return(e=b.isJQuery(t)||b.isElement(t)?_(t).first():[]).length?e:null}var t,v,e;t=_.fn.typeahead,v={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},e={initialize:function(p,g){var m;return g=b.isArray(g)?g:[].slice.call(arguments,1),m=n((p=p||{}).classNames),this.each(function(){var t,e,n,i,s,r,o,a,u,c,h,l,d,f;b.each(g,function(t){t.highlight=!!p.highlight}),t=_(this),e=_(m.html.wrapper),n=y(p.hint),i=y(p.menu),s=!1!==p.hint&&!n,r=!1!==p.menu&&!i,s&&(d=m,n=(l=t).clone().addClass(d.classes.hint).removeData().css(d.css.hint).css((f=l,{backgroundAttachment:f.css("background-attachment"),backgroundClip:f.css("background-clip"),backgroundColor:f.css("background-color"),backgroundImage:f.css("background-image"),backgroundOrigin:f.css("background-origin"),backgroundPosition:f.css("background-position"),backgroundRepeat:f.css("background-repeat"),backgroundSize:f.css("background-size")})).prop({readonly:!0,required:!1}).removeAttr("id name placeholder").removeClass("required").attr({spellcheck:"false",tabindex:-1})),r&&(i=_(m.html.menu).css(m.css.menu)),n&&n.val(""),t=function(t,e){t.data(v.attrs,{dir:t.attr("dir"),autocomplete:t.attr("autocomplete"),spellcheck:t.attr("spellcheck"),style:t.attr("style")}),t.addClass(e.classes.input).attr({spellcheck:!1});try{!t.attr("dir")&&t.attr("dir","auto")}catch(t){}return t}(t,m),(s||r)&&(e.css(m.css.wrapper),t.css(s?m.css.input:m.css.inputWithNoHint),t.wrap(e).parent().prepend(s?n:null).append(r?i:null)),h=r?k:w,o=new x({el:t}),a=new S({hint:n,input:t},m),u=new h({node:i,datasets:g},m),new A({$input:t,menu:u}),c=new $({input:a,menu:u,eventBus:o,minLength:p.minLength,autoselect:p.autoselect},m),t.data(v.www,m),t.data(v.typeahead,c)})},isEnabled:function(){var e;return i(this.first(),function(t){e=t.isEnabled()}),e},enable:function(){return i(this,function(t){t.enable()}),this},disable:function(){return i(this,function(t){t.disable()}),this},isActive:function(){var e;return i(this.first(),function(t){e=t.isActive()}),e},activate:function(){return i(this,function(t){t.activate()}),this},deactivate:function(){return i(this,function(t){t.deactivate()}),this},isOpen:function(){var e;return i(this.first(),function(t){e=t.isOpen()}),e},open:function(){return i(this,function(t){t.open()}),this},close:function(){return i(this,function(t){t.close()}),this},select:function(t){var e=!1,n=_(t);return i(this.first(),function(t){e=t.select(n)}),e},autocomplete:function(t){var e=!1,n=_(t);return i(this.first(),function(t){e=t.autocomplete(n)}),e},moveCursor:function(e){var n=!1;return i(this.first(),function(t){n=t.moveCursor(e)}),n},val:function(e){var n;return arguments.length?(i(this,function(t){t.setVal(b.toStr(e))}),this):(i(this.first(),function(t){n=t.getVal()}),n)},destroy:function(){return i(this,function(t,e){var n,i,s;i=(n=e).data(v.www),s=n.parent().filter(i.selectors.wrapper),b.each(n.data(v.attrs),function(t,e){b.isUndefined(t)?n.removeAttr(e):n.attr(e,t)}),n.removeData(v.typeahead).removeData(v.www).removeData(v.attr).removeClass(i.classes.input),s.length&&(n.detach().insertAfter(s),s.remove()),t.destroy()}),this}},_.fn.typeahead=function(t){return e[t]?e[t].apply(this,[].slice.call(arguments,1)):e.initialize.apply(this,arguments)},_.fn.typeahead.noConflict=function(){return _.fn.typeahead=t,this}}()});
!function(a,e,s){s.DatabaseService=function(e,t){var r=this;this.mapsvg=t,this.map_id=e.map_id,this.table=e.table,this.perpage=parseInt(e.perpage)||0,this.sortBy=e.sortBy||null,this.sortDir=e.sortDir||null,this.type=e.type||"mysql",this.loaded=!1,"local"==this.type&&(this.dbObject=e.dbObject),this.server="mysql"==this.type?new s.ServerMySQL({map_id:this.map_id,table:this.table,perpage:this.perpage,mapsvg:this.mapsvg}):new s.ServerLocal({storage:this.dbObject}),this.lastChangeTime=Date.now(),this.cols=[],this.schemaDict={},this.index={},this.page=1,this.query=new s.DatabaseQuery,this.events={create:[],update:[],change:[],schemaChange:[],dataLoaded:[]},this.schema=new s.DatabaseSchema(e,t),this.schema.on("change",function(){r.getAll(),r.trigger("schemaChange")})},s.DatabaseService.setQuery=function(e){},s.DatabaseService.prototype.setPerpage=function(e){this.server.perpage=e},s.DatabaseService.prototype.lastChangeTime=function(){return this.lastChangeTime},s.DatabaseService.prototype.onFirstPage=function(){return 1===this.query.page},s.DatabaseService.prototype.onLastPage=function(){return!1===this.server.hasMoreRecords},s.DatabaseService.prototype.import=function(e){var t=this;return e=this.formatCSV(e),this.server.import(e).done(function(){t.getAll()})},s.DatabaseService.prototype.create=function(e){var t=this,r=a.extend({},e);return r.post&&delete r.post,this.server.create(r).done(function(){t.trigger("create"),t.trigger("change")})},s.DatabaseService.prototype.update=function(e){var t=this,r=(this.index[e.id],a.extend({},e));return r.post&&delete r.post,this.server.update(r).done(function(){t.trigger("update"),t.trigger("change")})},s.DatabaseService.prototype.delete=function(e){var t=this;return this.server.delete(e).done(function(){t.trigger("delete"),t.trigger("change")})},s.DatabaseService.prototype.clear=function(e){var t=this;return this.server.clear().done(function(){t.getAll(),t.trigger("delete"),t.trigger("change")})},s.DatabaseService.prototype.getLoadedObject=function(e){return this.server.getLoadedObject(e)},s.DatabaseService.prototype.getAll=function(e){var t=this;"object"==typeof e&&Object.keys(e).length&&!e.page&&(t.query.page=1),t.query.set(e),this.page=e&&e.page?parseInt(e.page):this.page;var r={search:t.query.search,searchField:t.query.searchField,searchFallback:t.query.searchFallback,filters:t.query.filters,filterout:t.query.filterout,page:this.page,sortBy:this.sortBy,sortDir:this.sortDir,perpage:void 0!==t.query.perpage?parseInt(t.query.perpage):this.perpage};return this.schema.loaded()||(r.with_schema=!0),this.server.get(r).done(function(e){!t.schema.loaded()&&e.schema&&t.schema.set(e.schema),t.loaded=!0,t.trigger("dataLoaded")})},s.DatabaseService.prototype.getLoaded=function(){return this.server.rows},s.DatabaseService.prototype.formatData=function(e){return e},s.DatabaseService.prototype.formatCSV=function(n){var o=this;return n.forEach(function(e,t){var r={};for(var a in e){var s=o.schema.getField(a);if(void 0!==s)switch(s.type){case"region":r[a]=e[a].split(",").map(function(e){return e.trim()}).filter(function(e){return void 0!==o.mapsvg.getRegion(e)}).map(function(e){return{id:e,title:o.mapsvg.getRegion(e).title}});break;case"location":if(e[a].match(/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/g)){var i=e[a].split(",").map(function(e){return parseFloat(e)});2==i.length&&-90<i[0]&&i[0]<90&&-180<i[1]&&i[1]<180?r[a]={lat:i[0],lng:i[1]}:r[a]=""}else e[a]&&(r[a]={address:e[a]});break;case"select":case"radio":case"text":case"textarea":case"status":default:r[a]=e[a]}}n[t]=r}),n},s.DatabaseService.prototype.on=function(e,t){this.lastChangeTime=Date.now(),this.events[e]||(this.events[e]=[]),this.events[e].push(t)},s.DatabaseService.prototype.trigger=function(e){var t=this;this.events[e]&&this.events[e].length&&this.events[e].forEach(function(e){e&&e(t.server.rows)})},s.DatabaseService.prototype.onSchemaChange=function(e){this.onSchemaChangeCallbacks.push(e)},s.DatabaseService.prototype.getSchema=function(e){return this.schema.get(e)},s.DatabaseService.prototype.getSchemaField=function(e){return this.schema.getField(e)},s.DatabaseService.prototype.getSchemaFieldByType=function(e){return this.schema.getFieldByType(e)},s.DatabaseService.prototype.setSchema=function(e){return this.schema.set(e)},s.DatabaseService.prototype.loadSchema=function(e){return this.schema.load(e)},s.DatabaseService.prototype.saveSchema=function(e){return this.schema.save(e)},s.DatabaseService.prototype.getColumns=function(e){return this.schema.getColumns(e)},s.DatabaseSchema=function(e,t){this.mapsvg=t,this.map_id=e.map_id,this.table=e.table,this.lastChangeTime=Date.now(),this.cols=[],this.schema=[],this.schemaDict={},this.events={create:[],update:[],change:[]}},s.DatabaseSchema.prototype.loaded=function(e){return 0!==this.schema.length},s.DatabaseSchema.prototype.set=function(e){var t=this;e&&(t.schema=e.map(function(e){return e.visible=s.parseBoolean(e.visible),t.schemaDict[e.name]=e}))},s.DatabaseSchema.prototype.save=function(e){var t=this;for(var r in this.set(e),this.schema)this.schema[r]||this.schema.splice(r,1);return e=(e=(e=(e=(e=JSON.stringify(e)).replace(/select/g,"!mapsvg-encoded-slct")).replace(/table/g,"!mapsvg-encoded-tbl")).replace(/database/g,"!mapsvg-encoded-db")).replace(/varchar/g,"!mapsvg-encoded-vc"),a.post(ajaxurl,{action:"mapsvg_save_schema",schema:e,map_id:this.map_id,table:this.table}).done(function(){t.trigger("change")})},s.DatabaseSchema.prototype.get=function(e){return this.schema},s.DatabaseSchema.prototype.getField=function(e){return"id"==e?{name:"id",visible:!0,type:"id"}:this.schemaDict[e]},s.DatabaseSchema.prototype.getFieldByType=function(t){var r=null;return this.schema.forEach(function(e){e.type===t&&(r=e)}),r},s.DatabaseSchema.prototype.load=function(e){var t=this;return a.get(ajaxurl,{action:"mapsvg_get_schema",map_id:this.map_id,table:this.table},null,"json").done(function(e){t.set(e)})},s.DatabaseSchema.prototype.getColumns=function(r){r=r||{};var e=this.get().slice(0);"regions"==this.table&&e.unshift({name:"title",visible:!0,type:"title"});var t=!0;e.forEach(function(e){"id"==e.name&&(t=!1)}),t&&e.unshift({name:"id",visible:!0,type:"id"});var a,s=0!==Object.keys(r).length,i=[];s?e.forEach(function(e){for(var t in a=!0,r)a=e[t]==r[t];a&&i.push(e)}):i=e;return i},s.DatabaseSchema.prototype.on=function(e,t){this.lastChangeTime=Date.now(),this.events[e]||(this.events={}),this.events[e].push(t)},s.DatabaseSchema.prototype.trigger=function(e){this.events[e]&&this.events[e].length&&this.events[e].forEach(function(e){e&&e()})},s.Server=function(e){this.index={},this.hasMoreRecords=!1},s.Server.prototype.reindex=function(){var r=this;this.index={},this.rows&&this.rows.forEach(function(e,t){r.index[e.id]=t})},s.Server.prototype.getLoadedObject=function(e){var t=this.index[e];return null!=t?this.rows[t]:{}},s.ServerMySQL=function(e){this.map_id=e.map_id,this.table=e.table,this.perpage=e.perpage,this.rows=[],s.Server.call(this)},s.extend(s.ServerMySQL,s.Server),s.ServerMySQL.prototype.formatData=function(e){var t={};for(var r in e)!e[r]||"object"!=typeof e[r]&&"function"!=typeof e[r]||null==e[r].getOptions?null===e[r]||void 0===e[r]||"object"==typeof e[r]&&0===e[r].length?t[r]="":t[r]=e[r]:t[r]=e[r].getOptions();return JSON.stringify(t)},s.ServerMySQL.prototype.actionData=function(e,t){return t.action=e,t.map_id=this.map_id,t.table=this.table,t.perpage=this.perpage,t},s.ServerMySQL.prototype.get=function(t){var r=this;return void 0!==t.perpage&&(this.perpage=t.perpage),a.getJSON(ajaxurl,this.actionData("mapsvg_data_get_all",t)).done(function(e){e.objects&&e.objects.length?(r.hasMoreRecords=t.perpage&&e.objects.length>t.perpage,r.hasMoreRecords&&e.objects.pop(),r.rows=e.objects):(r.hasMoreRecords=!1,r.rows=[]),r.reindex()})},s.ServerMySQL.prototype.import=function(e){return e=JSON.stringify(e),a.post(ajaxurl,this.actionData("mapsvg_data_import",{data:e}),null,"json").done(function(e){})},s.ServerMySQL.prototype.create=function(t){var r=this;this.rows.push(t);var e=this.formatData(t);return a.post(ajaxurl,this.actionData("mapsvg_data_create",{data:e}),null,"json").done(function(e){}).then(function(e){return t.id=e.id,r.reindex(),t})},s.ServerMySQL.prototype.update=function(e){var t=this.index[e.id];if(void 0!==t){this.rows[t]=e;var r=this.formatData(e);return a.post(ajaxurl,this.actionData("mapsvg_data_update",{data:r}),null,"json")}},s.ServerMySQL.prototype.delete=function(e){var t=this,r=this.index[e];return this.rows.splice(r,1),a.post(ajaxurl,this.actionData("mapsvg_data_delete",{data:{id:e}}),null,"json").done(function(){t.reindex()})},s.ServerMySQL.prototype.clear=function(e){var t=this;return a.post(ajaxurl,this.actionData("mapsvg_data_clear",{data:{}}),null,"json").done(function(){this.rows=[],t.reindex()})},s.ServerLocal=function(e){this.rows=e.storage,s.Server.call(this,e),this.reindex()},s.extend(s.ServerLocal,s.Server),s.ServerLocal.prototype.get=function(e){defer=a.Deferred();var t=this.rows;return defer.promise(),defer.resolve(t),defer},s.ServerLocal.prototype.create=function(e){if(e.id){var t=this.index[e.id];if(this.rows[t])return this.update(e)}else e.id=this.getId();return this.rows.push(e),this.reindex(),defer=a.Deferred(),defer.promise(),defer.resolve(e),defer},s.ServerLocal.prototype.update=function(e){defer=a.Deferred();var t=this.index[e.id];return this.rows[t]?a.extend(!0,this.rows[t],e):this.rows.push(e),this.reindex(),defer.promise(),defer.resolve(e),defer},s.ServerLocal.prototype.delete=function(e){var t=this.index[e];return this.rows.splice(t,1),this.reindex(),defer=a.Deferred(),defer.promise(),defer.resolve(this.storage),defer},s.ServerLocal.prototype.getId=function(){var e=this.rows.map(function(e){return e.id});return e.length||(e=[0]),e?Math.max.apply(null,e)+1:1},s.Filters=function(e){this.schema={},this.schemaDict={},this.fields={},this.events={change:[]},this.setSchema(e)},s.Filters.prototype.set=function(e){this.fields=e},s.Filters.prototype.save=function(e){this.fields=e},s.Filters.prototype.reset=function(e){this.fields={}},s.Filters.prototype.get=function(e){return this.fields},s.Filters.prototype.getField=function(e){return this.schemaDict[e]},s.Filters.prototype.getSchema=function(e){return this.schema},s.Filters.prototype.setSchema=function(e){var r=this;return e&&e.forEach(function(e){var t=e.parameterName.split(".")[1];r.schemaDict[t]=e}),this.schema=e,this.schema},s.Filters.prototype.on=function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},s.Filters.prototype.trigger=function(e){var t=this;this.events[e]&&this.events[e].length&&this.events[e].forEach(function(e){e&&e(t)})},s.DatabaseQuery=function(e){e=e||{},this.sortBy=e.sortBy||null,this.sortDir=e.sortDir||null,this.page=e.page||1,this.perpage=e.perpage,this.search=e.search,this.searchField=e.searchField,this.filters=e.filters||{},this.filterout=e.filterout||{}},s.DatabaseQuery.prototype.set=function(e){for(var t in e)"filters"==t?this.setFilters(e[t]):this[t]=e[t]},s.DatabaseQuery.prototype.setFilters=function(e){for(var t in e)null===e[t]||""===e[t]||void 0===e[t]?this.filters[t]&&delete this.filters[t]:this.filters[t]=e[t]},s.DatabaseQuery.prototype.setFilterOut=function(e){for(var t in e)this.filterout[t]=e[t]},s.DatabaseQuery.prototype.resetFilters=function(e){this.filters={}},s.DatabaseQuery.prototype.setFilterField=function(e,t){this.filters[e]=t}}(jQuery,window,MapSVG);
!function(e){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e(t,window,document)}):"object"==typeof exports?module.exports=e(require("jquery"),window,document):e(jQuery,window,document)}(function(s,n,o){"use strict";var p,d,i,c,a,u,e,g,v,f,l,r,h,S,m,T,y,b,w,x,$,C,H,O,A;b={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",enabledClass:"has-scrollbar",flashedClass:"flashed",activeClass:"active",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},S="scroll",e="mousedown",g="mouseenter",v="mousemove",l="mousewheel",f="mouseup",h="resize",a="drag",u="enter",T="up",i="DOMMouseScroll",c="down",m="touchmove",p="Microsoft Internet Explorer"===n.navigator.appName&&/msie 7./i.test(n.navigator.appVersion)&&n.ActiveXObject,d=null,C=n.requestAnimationFrame,y=n.cancelAnimationFrame,O=o.createElement("div").style,A=function(){var t,e,i,s;for(t=i=0,s=(e=["t","webkitT","MozT","msT","OT"]).length;i<s;t=++i)if(e[t],e[t]+"ransform"in O)return e[t].substr(0,e[t].length-1);return!1}(),H=function(t){return!1!==A&&(""===A?t:A+t.charAt(0).toUpperCase()+t.substr(1))}("transform"),x=!1!==H,w=function(){var t,e,i;return(e=(t=o.createElement("div")).style).position="absolute",e.width="100px",e.height="100px",e.overflow=S,e.top="-9999px",o.body.appendChild(t),i=t.offsetWidth-t.clientWidth,o.body.removeChild(t),i},$=function(){var t,e,i;return e=n.navigator.userAgent,!!(t=/(?=.+Mac OS X)(?=.+Firefox)/.test(e))&&((i=/Firefox\/\d{2}\./.exec(e))&&(i=i[0].replace(/\D+/g,"")),t&&23<+i)},r=function(){function t(t,e){this.el=t,this.options=e,d||(d=w()),this.$el=s(this.el),this.doc=s(this.options.documentContext||o),this.win=s(this.options.windowContext||n),this.body=this.doc.find("body"),this.$content=this.$el.children("."+this.options.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return t.prototype.preventScrolling=function(t,e){if(this.isActive)if(t.type===i)(e===c&&0<t.originalEvent.detail||e===T&&t.originalEvent.detail<0)&&t.preventDefault();else if(t.type===l){if(!t.originalEvent||!t.originalEvent.wheelDelta)return;(e===c&&t.originalEvent.wheelDelta<0||e===T&&0<t.originalEvent.wheelDelta)&&t.preventDefault()}},t.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},t.prototype.updateScrollValues=function(){var t,e;t=this.content,this.maxScrollTop=t.scrollHeight-t.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=t.scrollTop,e=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==e&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:e}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},t.prototype.setOnScrollStyles=function(){var t,e;x?(t={})[H]="translate(0, "+this.sliderTop+"px)":t={top:this.sliderTop},C?(y&&this.scrollRAF&&y(this.scrollRAF),this.scrollRAF=C((e=this,function(){return e.scrollRAF=null,e.slider.css(t)}))):this.slider.css(t)},t.prototype.createEvents=function(){var i,s,e,o,n,l,r,h;this.events={down:(h=this,function(t){return h.isBeingDragged=!0,h.offsetY=t.pageY-h.slider.offset().top,h.slider.is(t.target)||(h.offsetY=0),h.pane.addClass(h.options.activeClass),h.doc.bind(v,h.events[a]).bind(f,h.events.up),h.body.bind(g,h.events[u]),!1}),drag:(r=this,function(t){return r.sliderY=t.pageY-r.$el.offset().top-r.paneTop-(r.offsetY||.5*r.sliderHeight),r.scroll(),r.contentScrollTop>=r.maxScrollTop&&r.prevScrollTop!==r.maxScrollTop?r.$el.trigger("scrollend"):0===r.contentScrollTop&&0!==r.prevScrollTop&&r.$el.trigger("scrolltop"),!1}),up:(l=this,function(t){return l.isBeingDragged=!1,l.pane.removeClass(l.options.activeClass),l.doc.unbind(v,l.events[a]).unbind(f,l.events.up),l.body.unbind(g,l.events[u]),!1}),resize:(n=this,function(t){n.reset()}),panedown:(o=this,function(t){return o.sliderY=(t.offsetY||t.originalEvent.layerY)-.5*o.sliderHeight,o.scroll(),o.events.down(t),!1}),scroll:(e=this,function(t){e.updateScrollValues(),e.isBeingDragged||(e.iOSNativeScrolling||(e.sliderY=e.sliderTop,e.setOnScrollStyles()),null!=t&&(e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventScrolling(t,c),e.prevScrollTop!==e.maxScrollTop&&e.$el.trigger("scrollend")):0===e.contentScrollTop&&(e.options.preventPageScrolling&&e.preventScrolling(t,T),0!==e.prevScrollTop&&e.$el.trigger("scrolltop"))))}),wheel:(s=this,function(t){var e;if(null!=t)return(e=t.delta||t.wheelDelta||t.originalEvent&&t.originalEvent.wheelDelta||-t.detail||t.originalEvent&&-t.originalEvent.detail)&&(s.sliderY+=-e/3),s.scroll(),!1}),enter:(i=this,function(t){var e;if(i.isBeingDragged)return 1!==(t.buttons||t.which)?(e=i.events).up.apply(e,arguments):void 0})}},t.prototype.addEvents=function(){var t;this.removeEvents(),t=this.events,this.options.disableResize||this.win.bind(h,t[h]),this.iOSNativeScrolling||(this.slider.bind(e,t[c]),this.pane.bind(e,t.panedown).bind(l+" "+i,t.wheel)),this.$content.bind(S+" "+l+" "+i+" "+m,t[S])},t.prototype.removeEvents=function(){var t;t=this.events,this.win.unbind(h,t[h]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(S+" "+l+" "+i+" "+m,t[S])},t.prototype.generate=function(){var t,e,i,s,o;return s=(e=this.options).paneClass,o=e.sliderClass,e.contentClass,(i=this.$el.children("."+s)).length||i.children("."+o).length||this.$el.append('<div class="'+s+'"><div class="'+o+'" /></div>'),this.pane=this.$el.children("."+s),this.slider=this.pane.find("."+o),0===d&&$()?t={right:-14,paddingRight:+n.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,"")+14}:d&&(t={right:-d},this.$el.addClass(e.enabledClass)),null!=t&&this.$content.css(t),this},t.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},t.prototype.reset=function(){var t,e,i,s,o,n,l,r,h,c,a;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),o=(s=(t=this.content).style).overflowY,p&&this.$content.css({height:this.$content.height()}),e=t.scrollHeight+d,0<(h=parseInt(this.$el.css("max-height"),10))&&(this.$el.height(""),this.$el.height(t.scrollHeight>h?h:t.scrollHeight)),l=(n=this.pane.outerHeight(!1))+(r=parseInt(this.pane.css("top"),10))+parseInt(this.pane.css("bottom"),10),(a=Math.round(l/e*n))<this.options.sliderMinHeight?a=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&a>this.options.sliderMaxHeight&&(a=this.options.sliderMaxHeight),o===S&&s.overflowX!==S&&(a+=d),this.maxSliderTop=l-a,this.contentHeight=e,this.paneHeight=n,this.paneOuterHeight=l,this.sliderHeight=a,this.paneTop=r,this.slider.height(a),this.events.scroll(),this.pane.show(),this.isActive=!0,t.scrollHeight===t.clientHeight||this.pane.outerHeight(!0)>=t.scrollHeight&&o!==S?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===t.scrollHeight&&o===S?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),("static"===(i=this.$content.css("position"))||"relative"===i)&&((c=parseInt(this.$content.css("right"),10))&&this.$content.css({right:"",marginRight:c})),this)},t.prototype.scroll=function(){return this.isActive?(this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this):void 0},t.prototype.scrollBottom=function(t){return this.isActive?(this.$content.scrollTop(this.contentHeight-this.$content.height()-t).trigger(l),this.stop().restore(),this):void 0},t.prototype.scrollTop=function(t){return this.isActive?(this.$content.scrollTop(+t).trigger(l),this.stop().restore(),this):void 0},t.prototype.scrollTo=function(t){return this.isActive?(this.scrollTop(this.$el.find(t).get(0).offsetTop),this):void 0},t.prototype.stop=function(){return y&&this.scrollRAF&&(y(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},t.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),p&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass(this.options.enabledClass)&&(this.$el.removeClass(this.options.enabledClass),this.$content.css({right:""})),this},t.prototype.flash=function(){return!this.iOSNativeScrolling&&this.isActive?(this.reset(),this.pane.addClass(this.options.flashedClass),setTimeout((t=this,function(){t.pane.removeClass(t.options.flashedClass)}),this.options.flashDelay),this):void 0;var t},t}(),s.fn.nanoScroller=function(i){return this.each(function(){var t,e;if((e=this.nanoscroller)||(t=s.extend({},b,i),this.nanoscroller=e=new r(this,t)),i&&"object"==typeof i){if(s.extend(e.options,i),null!=i.scrollBottom)return e.scrollBottom(i.scrollBottom);if(null!=i.scrollTop)return e.scrollTop(i.scrollTop);if(i.scrollTo)return e.scrollTo(i.scrollTo);if("bottom"===i.scroll)return e.scrollBottom(0);if("top"===i.scroll)return e.scrollTop(0);if(i.scroll&&i.scroll instanceof s)return e.scrollTo(i.scroll);if(i.stop)return e.stop();if(i.destroy)return e.destroy();if(i.flash)return e.flash()}return e.reset()})},s.fn.nanoScroller.Constructor=r});
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(n){var e=function(){if(n&&n.fn&&n.fn.mselect2&&n.fn.mselect2.amd)var e=n.fn.mselect2.amd;var t,o,c,u;return e&&e.requirejs||(e?c=e:e={},function(p){function h(e,t){return n.call(e,t)}function s(e,t){var n,i,o,r,s,a,l,c,u,d,p,h=t&&t.split("/"),f=$.map,g=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(s=(e=e.split("/")).length-1,$.nodeIdCompat&&x.test(e[s])&&(e[s]=e[s].replace(x,"")),e=h.slice(0,h.length-1).concat(e),u=0;u<e.length;u+=1)if("."===(p=e[u]))e.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===e[2]||".."===e[0]))break;0<u&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||g)&&f){for(u=(n=e.split("/")).length;0<u;u-=1){if(i=n.slice(0,u).join("/"),h)for(d=h.length;0<d;d-=1)if((o=f[h.slice(0,d).join("/")])&&(o=o[i])){r=o,a=u;break}if(r)break;!l&&g&&g[i]&&(l=g[i],c=u)}!r&&l&&(r=l,a=c),r&&(n.splice(0,a,r),e=n.join("/"))}return e}function f(t,n){return function(){var e=i.call(arguments,0);return"string"!=typeof e[0]&&1===e.length&&e.push(null),l.apply(p,e.concat([t,n]))}}function g(t){return function(e){_[t]=e}}function m(e){if(h(w,e)){var t=w[e];delete w[e],b[e]=!0,r.apply(p,t)}if(!h(_,e)&&!h(b,e))throw new Error("No "+e);return _[e]}function a(e){var t,n=e?e.indexOf("!"):-1;return-1<n&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}var r,l,v,y,_={},w={},$={},b={},n=Object.prototype.hasOwnProperty,i=[].slice,x=/\.js$/;v=function(e,t){var n,i,o=a(e),r=o[0];return e=o[1],r&&(n=m(r=s(r,t))),r?e=n&&n.normalize?n.normalize(e,(i=t,function(e){return s(e,i)})):s(e,t):(r=(o=a(e=s(e,t)))[0],e=o[1],r&&(n=m(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},y={require:function(e){return f(e)},exports:function(e){var t=_[e];return void 0!==t?t:_[e]={}},module:function(e){return{id:e,uri:"",exports:_[e],config:(t=e,function(){return $&&$.config&&$.config[t]||{}})};var t}},r=function(e,t,n,i){var o,r,s,a,l,c,u=[],d=typeof n;if(i=i||e,"undefined"===d||"function"===d){for(t=!t.length&&n.length?["require","exports","module"]:t,l=0;l<t.length;l+=1)if("require"===(r=(a=v(t[l],i)).f))u[l]=y.require(e);else if("exports"===r)u[l]=y.exports(e),c=!0;else if("module"===r)o=u[l]=y.module(e);else if(h(_,r)||h(w,r)||h(b,r))u[l]=m(r);else{if(!a.p)throw new Error(e+" missing "+r);a.p.load(a.n,f(i,!0),g(r),{}),u[l]=_[r]}s=n?n.apply(_[e],u):void 0,e&&(o&&o.exports!==p&&o.exports!==_[e]?_[e]=o.exports:s===p&&c||(_[e]=s))}else e&&(_[e]=n)},o=c=l=function(e,t,n,i,o){if("string"==typeof e)return y[e]?y[e](t):m(v(e,t).f);if(!e.splice){if(($=e).deps&&l($.deps,$.callback),!t)return;t.splice?(e=t,t=n,n=null):e=p}return t=t||function(){},"function"==typeof n&&(n=i,i=o),i?r(p,e,t,n):setTimeout(function(){r(p,e,t,n)},4),l},l.config=function(e){return l(e)},o._defined=_,(u=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),h(_,e)||h(w,e)||(w[e]=[e,t,n])}).amd={jQuery:!0}}(),e.requirejs=o,e.require=c,e.define=u),e.define("almond",function(){}),e.define("jquery",[],function(){var e=n||$;return null==e&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),e}),e.define("select2/utils",["jquery"],function(r){function u(e){var t=e.prototype,n=[];for(var i in t){"function"==typeof t[i]&&"constructor"!==i&&n.push(i)}return n}var e={Extend:function(e,t){function n(){this.constructor=e}var i={}.hasOwnProperty;for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},Decorate:function(i,o){function r(){var e=Array.prototype.unshift,t=o.prototype.constructor.length,n=i.prototype.constructor;0<t&&(e.call(arguments,i.prototype.constructor),n=o.prototype.constructor),n.apply(this,arguments)}var e=u(o),t=u(i);o.displayName=i.displayName,r.prototype=new function(){this.constructor=r};for(var n=0;n<t.length;n++){var s=t[n];r.prototype[s]=i.prototype[s]}for(var a=function(e){var t=function(){};e in r.prototype&&(t=r.prototype[e]);var n=o.prototype[e];return function(){return Array.prototype.unshift.call(arguments,t),n.apply(this,arguments)}},l=0;l<e.length;l++){var c=e[l];r.prototype[c]=a(c)}return r}},t=function(){this.listeners={}};return t.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},t.prototype.trigger=function(e){var t=Array.prototype.slice,n=t.call(arguments,1);this.listeners=this.listeners||{},null==n&&(n=[]),0===n.length&&n.push({}),(n[0]._type=e)in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},t.prototype.invoke=function(e,t){for(var n=0,i=e.length;n<i;n++)e[n].apply(this,t)},e.Observable=t,e.generateChars=function(e){for(var t="",n=0;n<e;n++){t+=Math.floor(36*Math.random()).toString(36)}return t},e.bind=function(e,t){return function(){e.apply(t,arguments)}},e._convertData=function(e){for(var t in e){var n=t.split("-"),i=e;if(1!==n.length){for(var o=0;o<n.length;o++){var r=n[o];(r=r.substring(0,1).toLowerCase()+r.substring(1))in i||(i[r]={}),o==n.length-1&&(i[r]=e[t]),i=i[r]}delete e[t]}}return e},e.hasScroll=function(e,t){var n=r(t),i=t.style.overflowX,o=t.style.overflowY;return(i!==o||"hidden"!==o&&"visible"!==o)&&("scroll"===i||"scroll"===o||(n.innerHeight()<t.scrollHeight||n.innerWidth()<t.scrollWidth))},e.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},e.appendMany=function(e,t){if("1.7"===r.fn.jquery.substr(0,3)){var n=r();r.map(t,function(e){n=n.add(e)}),t=n}e.append(t)},e}),e.define("select2/results",["jquery","./utils"],function(p,e){function i(e,t,n){this.$element=e,this.data=n,this.options=t,i.__super__.constructor.call(this)}return e.Extend(i,e.Observable),i.prototype.render=function(){var e=p('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&e.attr("aria-multiselectable","true"),this.$results=e},i.prototype.clear=function(){this.$results.empty()},i.prototype.displayMessage=function(e){var t=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=p('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),i=this.options.get("translations").get(e.message);n.append(t(i(e.args))),n[0].className+=" select2-results__message",this.$results.append(n)},i.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},i.prototype.append=function(e){this.hideLoading();var t=[];if(null!=e.results&&0!==e.results.length){e.results=this.sort(e.results);for(var n=0;n<e.results.length;n++){var i=e.results[n],o=this.option(i);t.push(o)}this.$results.append(t)}else 0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"})},i.prototype.position=function(e,t){t.find(".select2-results").append(e)},i.prototype.sort=function(e){return this.options.get("sorter")(e)},i.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option[aria-selected]"),t=e.filter("[aria-selected=true]");0<t.length?t.first().trigger("mouseenter"):e.first().trigger("mouseenter"),this.ensureHighlightVisible()},i.prototype.setClasses=function(){var t=this;this.data.current(function(e){var i=p.map(e,function(e){return e.id.toString()});t.$results.find(".select2-results__option[aria-selected]").each(function(){var e=p(this),t=p.data(this,"data"),n=""+t.id;null!=t.element&&t.element.selected||null==t.element&&-1<p.inArray(n,i)?e.attr("aria-selected","true"):e.attr("aria-selected","false")})})},i.prototype.showLoading=function(e){this.hideLoading();var t={disabled:!0,loading:!0,text:this.options.get("translations").get("searching")(e)},n=this.option(t);n.className+=" loading-results",this.$results.prepend(n)},i.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},i.prototype.option=function(e){var t=document.createElement("li");t.className="select2-results__option";var n={role:"treeitem","aria-selected":"false"};for(var i in e.disabled&&(delete n["aria-selected"],n["aria-disabled"]="true"),null==e.id&&delete n["aria-selected"],null!=e._resultId&&(t.id=e._resultId),e.title&&(t.title=e.title),e.children&&(n.role="group",n["aria-label"]=e.text,delete n["aria-selected"]),n){var o=n[i];t.setAttribute(i,o)}if(e.children){var r=p(t),s=document.createElement("strong");s.className="select2-results__group",p(s),this.template(e,s);for(var a=[],l=0;l<e.children.length;l++){var c=e.children[l],u=this.option(c);a.push(u)}var d=p("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});d.append(a),r.append(s),r.append(d)}else this.template(e,t);return p.data(t,"data",e),t},i.prototype.bind=function(t,e){var l=this,n=t.id+"-results";this.$results.attr("id",n),t.on("results:all",function(e){l.clear(),l.append(e.data),t.isOpen()&&(l.setClasses(),l.highlightFirstItem())}),t.on("results:append",function(e){l.append(e.data),t.isOpen()&&l.setClasses()}),t.on("query",function(e){l.hideMessages(),l.showLoading(e)}),t.on("select",function(){t.isOpen()&&(l.setClasses(),l.highlightFirstItem())}),t.on("unselect",function(){t.isOpen()&&(l.setClasses(),l.highlightFirstItem())}),t.on("open",function(){l.$results.attr("aria-expanded","true"),l.$results.attr("aria-hidden","false"),l.setClasses(),l.ensureHighlightVisible()}),t.on("close",function(){l.$results.attr("aria-expanded","false"),l.$results.attr("aria-hidden","true"),l.$results.removeAttr("aria-activedescendant")}),t.on("results:toggle",function(){var e=l.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),t.on("results:select",function(){var e=l.getHighlightedResults();if(0!==e.length){var t=e.data("data");"true"==e.attr("aria-selected")?l.trigger("close",{}):l.trigger("select",{data:t})}}),t.on("results:previous",function(){var e=l.getHighlightedResults(),t=l.$results.find("[aria-selected]"),n=t.index(e);if(0!==n){var i=n-1;0===e.length&&(i=0);var o=t.eq(i);o.trigger("mouseenter");var r=l.$results.offset().top,s=o.offset().top,a=l.$results.scrollTop()+(s-r);0===i?l.$results.scrollTop(0):s-r<0&&l.$results.scrollTop(a)}}),t.on("results:next",function(){var e=l.getHighlightedResults(),t=l.$results.find("[aria-selected]"),n=t.index(e)+1;if(!(n>=t.length)){var i=t.eq(n);i.trigger("mouseenter");var o=l.$results.offset().top+l.$results.outerHeight(!1),r=i.offset().top+i.outerHeight(!1),s=l.$results.scrollTop()+r-o;0===n?l.$results.scrollTop(0):o<r&&l.$results.scrollTop(s)}}),t.on("results:focus",function(e){e.element.addClass("select2-results__option--highlighted")}),t.on("results:message",function(e){l.displayMessage(e)}),p.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=l.$results.scrollTop(),n=l.$results.get(0).scrollHeight-t+e.deltaY,i=0<e.deltaY&&t-e.deltaY<=0,o=e.deltaY<0&&n<=l.$results.height();i?(l.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):o&&(l.$results.scrollTop(l.$results.get(0).scrollHeight-l.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(e){var t=p(this),n=t.data("data");return"true"===t.attr("aria-selected")?void(l.options.get("multiple")?l.trigger("unselect",{originalEvent:e,data:n}):l.trigger("close",{})):void l.trigger("select",{originalEvent:e,data:n})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(e){var t=p(this).data("data");l.getHighlightedResults().removeClass("select2-results__option--highlighted"),l.trigger("results:focus",{data:t,element:p(this)})})},i.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},i.prototype.destroy=function(){this.$results.remove()},i.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(0!==e.length){var t=this.$results.find("[aria-selected]").index(e),n=this.$results.offset().top,i=e.offset().top,o=this.$results.scrollTop()+(i-n),r=i-n;o-=2*e.outerHeight(!1),t<=2?this.$results.scrollTop(0):(r>this.$results.outerHeight()||r<0)&&this.$results.scrollTop(o)}},i.prototype.template=function(e,t){var n=this.options.get("templateResult"),i=this.options.get("escapeMarkup"),o=n(e,t);null==o?t.style.display="none":"string"==typeof o?t.innerHTML=i(o):p(t).append(o)},i}),e.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),e.define("select2/selection/base",["jquery","../utils","../keys"],function(n,e,o){function i(e,t){this.$element=e,this.options=t,i.__super__.constructor.call(this)}return e.Extend(i,e.Observable),i.prototype.render=function(){var e=n('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),e.attr("title",this.$element.attr("title")),e.attr("tabindex",this._tabindex),this.$selection=e},i.prototype.bind=function(e,t){var n=this,i=(e.id,e.id+"-results");this.container=e,this.$selection.on("focus",function(e){n.trigger("focus",e)}),this.$selection.on("blur",function(e){n._handleBlur(e)}),this.$selection.on("keydown",function(e){n.trigger("keypress",e),e.which===o.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){n.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){n.update(e.data)}),e.on("open",function(){n.$selection.attr("aria-expanded","true"),n.$selection.attr("aria-owns",i),n._attachCloseHandler(e)}),e.on("close",function(){n.$selection.attr("aria-expanded","false"),n.$selection.removeAttr("aria-activedescendant"),n.$selection.removeAttr("aria-owns"),n.$selection.focus(),n._detachCloseHandler(e)}),e.on("enable",function(){n.$selection.attr("tabindex",n._tabindex)}),e.on("disable",function(){n.$selection.attr("tabindex","-1")})},i.prototype._handleBlur=function(e){var t=this;window.setTimeout(function(){document.activeElement==t.$selection[0]||n.contains(t.$selection[0],document.activeElement)||t.trigger("blur",e)},1)},i.prototype._attachCloseHandler=function(e){n(document.body).on("mousedown.select2."+e.id,function(e){var t=n(e.target).closest(".select2");n(".select2.select2-container--open").each(function(){var e=n(this);this!=t[0]&&e.data("element").select2("close")})})},i.prototype._detachCloseHandler=function(e){n(document.body).off("mousedown.select2."+e.id)},i.prototype.position=function(e,t){t.find(".selection").append(e)},i.prototype.destroy=function(){this._detachCloseHandler(this.container)},i.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")},i}),e.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,n,i){function o(){o.__super__.constructor.apply(this,arguments)}return n.Extend(o,t),o.prototype.render=function(){var e=o.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},o.prototype.bind=function(t,e){var n=this;o.__super__.bind.apply(this,arguments);var i=t.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",i),this.$selection.attr("aria-labelledby",i),this.$selection.on("mousedown",function(e){1===e.which&&n.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(e){}),this.$selection.on("blur",function(e){}),t.on("focus",function(e){t.isOpen()||n.$selection.focus()}),t.on("selection:update",function(e){n.update(e.data)})},o.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},o.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},o.prototype.selectionContainer=function(){return e("<span></span>")},o.prototype.update=function(e){if(0!==e.length){var t=e[0],n=this.$selection.find(".select2-selection__rendered"),i=this.display(t,n);n.empty().append(i),n.prop("title",t.title||t.text)}else this.clear()},o}),e.define("select2/selection/multiple",["jquery","./base","../utils"],function(i,e,a){function o(e,t){o.__super__.constructor.apply(this,arguments)}return a.Extend(o,e),o.prototype.render=function(){var e=o.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},o.prototype.bind=function(e,t){var n=this;o.__super__.bind.apply(this,arguments),this.$selection.on("click",function(e){n.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(e){if(!n.options.get("disabled")){var t=i(this).parent().data("data");n.trigger("unselect",{originalEvent:e,data:t})}})},o.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},o.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},o.prototype.selectionContainer=function(){return i('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},o.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],n=0;n<e.length;n++){var i=e[n],o=this.selectionContainer(),r=this.display(i,o);o.append(r),o.prop("title",i.title||i.text),o.data("data",i),t.push(o)}var s=this.$selection.find(".select2-selection__rendered");a.appendMany(s,t)}},o}),e.define("select2/selection/placeholder",["../utils"],function(e){function t(e,t,n){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n)}return t.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},t.prototype.createPlaceholder=function(e,t){var n=this.selectionContainer();return n.html(this.display(t)),n.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),n},t.prototype.update=function(e,t){var n=1==t.length&&t[0].id!=this.placeholder.id;if(1<t.length||n)return e.call(this,t);this.clear();var i=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(i)},t}),e.define("select2/selection/allowClear",["jquery","../keys"],function(i,o){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(e){i._handleClear(e)}),t.on("keypress",function(e){i._handleKeyboardClear(e,t)})},e.prototype._handleClear=function(e,t){if(!this.options.get("disabled")){var n=this.$selection.find(".select2-selection__clear");if(0!==n.length){t.stopPropagation();for(var i=n.data("data"),o=0;o<i.length;o++){var r={data:i[o]};if(this.trigger("unselect",r),r.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle",{})}}},e.prototype._handleKeyboardClear=function(e,t,n){n.isOpen()||(t.which==o.DELETE||t.which==o.BACKSPACE)&&this._handleClear(t)},e.prototype.update=function(e,t){if(e.call(this,t),!(0<this.$selection.find(".select2-selection__placeholder").length||0===t.length)){var n=i('<span class="select2-selection__clear">&times;</span>');n.data("data",t),this.$selection.find(".select2-selection__rendered").prepend(n)}},e}),e.define("select2/selection/search",["jquery","../utils","../keys"],function(i,e,s){function t(e,t,n){e.call(this,t,n)}return t.prototype.render=function(e){var t=i('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=t,this.$search=t.find("input");var n=e.call(this);return this._transferTabIndex(),n},t.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("open",function(){i.$search.trigger("focus")}),t.on("close",function(){i.$search.val(""),i.$search.removeAttr("aria-activedescendant"),i.$search.trigger("focus")}),t.on("enable",function(){i.$search.prop("disabled",!1),i._transferTabIndex()}),t.on("disable",function(){i.$search.prop("disabled",!0)}),t.on("focus",function(e){i.$search.trigger("focus")}),t.on("results:focus",function(e){i.$search.attr("aria-activedescendant",e.id)}),this.$selection.on("focusin",".select2-search--inline",function(e){i.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){i._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){if(e.stopPropagation(),i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented(),e.which===s.BACKSPACE&&""===i.$search.val()){var t=i.$searchContainer.prev(".select2-selection__choice");if(0<t.length){var n=t.data("data");i.searchRemoveChoice(n),e.preventDefault()}}});var o=document.documentMode,r=o&&o<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){return r?void i.$selection.off("input.search input.searchcheck"):void i.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){if(r&&"input"===e.type)i.$selection.off("input.search input.searchcheck");else{var t=e.which;t!=s.SHIFT&&t!=s.CTRL&&t!=s.ALT&&t!=s.TAB&&i.handleSearch(e)}})},t.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},t.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},t.prototype.update=function(e,t){var n=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),n&&this.$search.focus()},t.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},t.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},t.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";""!==this.$search.attr("placeholder")?e=this.$selection.find(".select2-selection__rendered").innerWidth():e=.75*(this.$search.val().length+1)+"em";this.$search.css("width",e)},t}),e.define("select2/selection/eventRelay",["jquery"],function(s){function e(){}return e.prototype.bind=function(e,t,n){var i=this,o=["open","opening","close","closing","select","selecting","unselect","unselecting"],r=["opening","closing","selecting","unselecting"];e.call(this,t,n),t.on("*",function(e,t){if(-1!==s.inArray(e,o)){t=t||{};var n=s.Event("select2:"+e,{params:t});i.$element.trigger(n),-1!==s.inArray(e,r)&&(t.prevented=n.isDefaultPrevented())}})},e}),e.define("select2/translation",["jquery","require"],function(t,n){function i(e){this.dict=e||{}}return i.prototype.all=function(){return this.dict},i.prototype.get=function(e){return this.dict[e]},i.prototype.extend=function(e){this.dict=t.extend({},e.all(),this.dict)},i._cache={},i.loadPath=function(e){if(!(e in i._cache)){var t=n(e);i._cache[e]=t}return new i(i._cache[e])},i}),e.define("select2/diacritics",[],function(){return{"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""}}),e.define("select2/data/base",["../utils"],function(i){function n(e,t){n.__super__.constructor.call(this)}return i.Extend(n,i.Observable),n.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")},n.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")},n.prototype.bind=function(e,t){},n.prototype.destroy=function(){},n.prototype.generateResultId=function(e,t){var n=e.id+"-result-";return(n+=i.generateChars(4))+(null!=t.id?"-"+t.id.toString():"-"+i.generateChars(4))},n}),e.define("select2/data/select",["./base","../utils","jquery"],function(e,t,a){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,e),n.prototype.current=function(e){var n=[],i=this;this.$element.find(":selected").each(function(){var e=a(this),t=i.item(e);n.push(t)}),e(n)},n.prototype.select=function(o){var r=this;if(o.selected=!0,a(o.element).is("option"))return o.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(e){var t=[];(o=[o]).push.apply(o,e);for(var n=0;n<o.length;n++){var i=o[n].id;-1===a.inArray(i,t)&&t.push(i)}r.$element.val(t),r.$element.trigger("change")});else{var e=o.id;this.$element.val(e),this.$element.trigger("change")}},n.prototype.unselect=function(o){var r=this;if(this.$element.prop("multiple"))return o.selected=!1,a(o.element).is("option")?(o.element.selected=!1,void this.$element.trigger("change")):void this.current(function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n].id;i!==o.id&&-1===a.inArray(i,t)&&t.push(i)}r.$element.val(t),r.$element.trigger("change")})},n.prototype.bind=function(e,t){var n=this;(this.container=e).on("select",function(e){n.select(e.data)}),e.on("unselect",function(e){n.unselect(e.data)})},n.prototype.destroy=function(){this.$element.find("*").each(function(){a.removeData(this,"data")})},n.prototype.query=function(i,e){var o=[],r=this;this.$element.children().each(function(){var e=a(this);if(e.is("option")||e.is("optgroup")){var t=r.item(e),n=r.matches(i,t);null!==n&&o.push(n)}}),e({results:o})},n.prototype.addOptions=function(e){t.appendMany(this.$element,e)},n.prototype.option=function(e){var t;e.children?(t=document.createElement("optgroup")).label=e.text:void 0!==(t=document.createElement("option")).textContent?t.textContent=e.text:t.innerText=e.text,e.id&&(t.value=e.id),e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),e.title&&(t.title=e.title);var n=a(t),i=this._normalizeItem(e);return i.element=t,a.data(t,"data",i),n},n.prototype.item=function(e){var t={};if(null!=(t=a.data(e[0],"data")))return t;if(e.is("option"))t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){t={text:e.prop("label"),children:[],title:e.prop("title")};for(var n=e.children("option"),i=[],o=0;o<n.length;o++){var r=a(n[o]),s=this.item(r);i.push(s)}t.children=i}return(t=this._normalizeItem(t)).element=e[0],a.data(e[0],"data",t),t},n.prototype._normalizeItem=function(e){a.isPlainObject(e)||(e={id:e,text:e});return null!=(e=a.extend({},{text:""},e)).id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),a.extend({},{selected:!1,disabled:!1},e)},n.prototype.matches=function(e,t){return this.options.get("matcher")(e,t)},n}),e.define("select2/data/array",["./select","../utils","jquery"],function(e,f,g){function i(e,t){var n=t.get("data")||[];i.__super__.constructor.call(this,e,t),this.addOptions(this.convertToOptions(n))}return f.Extend(i,e),i.prototype.select=function(n){var e=this.$element.find("option").filter(function(e,t){return t.value==n.id.toString()});0===e.length&&(e=this.option(n),this.addOptions(e)),i.__super__.select.call(this,n)},i.prototype.convertToOptions=function(e){function t(e){return function(){return g(this).val()==e.id}}for(var n=this,i=this.$element.find("option"),o=i.map(function(){return n.item(g(this)).id}).get(),r=[],s=0;s<e.length;s++){var a=this._normalizeItem(e[s]);if(0<=g.inArray(a.id,o)){var l=i.filter(t(a)),c=this.item(l),u=g.extend(!0,{},a,c),d=this.option(u);l.replaceWith(d)}else{var p=this.option(a);if(a.children){var h=this.convertToOptions(a.children);f.appendMany(p,h)}r.push(p)}}return r},i}),e.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,r){function n(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),n.__super__.constructor.call(this,e,t)}return t.Extend(n,e),n.prototype._applyDefaults=function(e){var t={data:function(e){return r.extend({},e,{q:e.term})},transport:function(e,t,n){var i=r.ajax(e);return i.then(t),i.fail(n),i}};return r.extend({},t,e,!0)},n.prototype.processResults=function(e){return e},n.prototype.query=function(n,i){function e(){var e=t.transport(t,function(e){var t=o.processResults(e,n);o.options.get("debug")&&window.console&&console.error&&(t&&t.results&&r.isArray(t.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),i(t)},function(){e.status&&"0"===e.status||o.trigger("results:message",{message:"errorLoading"})});o._request=e}var o=this;null!=this._request&&(r.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var t=r.extend({type:"GET"},this.ajaxOptions);"function"==typeof t.url&&(t.url=t.url.call(this.$element,n)),"function"==typeof t.data&&(t.data=t.data.call(this.$element,n)),this.ajaxOptions.delay&&null!=n.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(e,this.ajaxOptions.delay)):e()},n}),e.define("select2/data/tags",["jquery"],function(u){function e(e,t,n){var i=n.get("tags"),o=n.get("createTag");void 0!==o&&(this.createTag=o);var r=n.get("insertTag");if(void 0!==r&&(this.insertTag=r),e.call(this,t,n),u.isArray(i))for(var s=0;s<i.length;s++){var a=i[s],l=this._normalizeItem(a),c=this.option(l);this.$element.append(c)}}return e.prototype.query=function(e,c,u){var d=this;return this._removeOldTags(),null==c.term||null!=c.page?void e.call(this,c,u):void e.call(this,c,function e(t,n){for(var i=t.results,o=0;o<i.length;o++){var r=i[o],s=null!=r.children&&!e({results:r.children},!0);if(r.text===c.term||s)return!n&&(t.data=i,void u(t))}if(n)return!0;var a=d.createTag(c);if(null!=a){var l=d.option(a);l.attr("data-select2-tag",!0),d.addOptions([l]),d.insertTag(i,a)}t.results=i,u(t)})},e.prototype.createTag=function(e,t){var n=u.trim(t.term);return""===n?null:{id:n,text:n}},e.prototype.insertTag=function(e,t,n){t.unshift(n)},e.prototype._removeOldTags=function(e){(this._lastTag,this.$element.find("option[data-select2-tag]")).each(function(){this.selected||u(this).remove()})},e}),e.define("select2/data/tokenizer",["jquery"],function(d){function e(e,t,n){var i=n.get("tokenizer");void 0!==i&&(this.tokenizer=i),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){e.call(this,t,n),this.$search=t.dropdown.$search||t.selection.$search||n.find(".select2-search__field")},e.prototype.query=function(e,t,n){var o=this;t.term=t.term||"";var i=this.tokenizer(t,this.options,function(e){var t,n=o._normalizeItem(e);if(!o.$element.find("option").filter(function(){return d(this).val()===n.id}).length){var i=o.option(n);i.attr("data-select2-tag",!0),o._removeOldTags(),o.addOptions([i])}t=n,o.trigger("select",{data:t})});i.term!==t.term&&(this.$search.length&&(this.$search.val(i.term),this.$search.focus()),t.term=i.term),e.call(this,t,n)},e.prototype.tokenizer=function(e,t,n,i){for(var o=n.get("tokenSeparators")||[],r=t.term,s=0,a=this.createTag||function(e){return{id:e.term,text:e.term}};s<r.length;){var l=r[s];if(-1!==d.inArray(l,o)){var c=r.substr(0,s),u=a(d.extend({},t,{term:c}));null!=u?(i(u),r=r.substr(s+1)||"",s=0):s++}else s++}return{term:r}},e}),e.define("select2/data/minimumInputLength",[],function(){function e(e,t,n){this.minimumInputLength=n.get("minimumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){return t.term=t.term||"",t.term.length<this.minimumInputLength?void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}}):void e.call(this,t,n)},e}),e.define("select2/data/maximumInputLength",[],function(){function e(e,t,n){this.maximumInputLength=n.get("maximumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){return t.term=t.term||"",0<this.maximumInputLength&&t.term.length>this.maximumInputLength?void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}}):void e.call(this,t,n)},e}),e.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,n){this.maximumSelectionLength=n.get("maximumSelectionLength"),e.call(this,t,n)}return e.prototype.query=function(n,i,o){var r=this;this.current(function(e){var t=null!=e?e.length:0;return 0<r.maximumSelectionLength&&t>=r.maximumSelectionLength?void r.trigger("results:message",{message:"maximumSelected",args:{maximum:r.maximumSelectionLength}}):void n.call(r,i,o)})},e}),e.define("select2/dropdown",["jquery","./utils"],function(t,e){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return e.Extend(n,e.Observable),n.prototype.render=function(){var e=t('<span class="select2-dropdown"><span class="select2-results"></span></span>');return e.attr("dir",this.options.get("dir")),this.$dropdown=e},n.prototype.bind=function(){},n.prototype.position=function(e,t){},n.prototype.destroy=function(){this.$dropdown.remove()},n}),e.define("select2/dropdown/search",["jquery","../utils"],function(o,e){function t(){}return t.prototype.render=function(e){var t=e.call(this),n=o('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=n,this.$search=n.find("input"),t.prepend(n),t},t.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),this.$search.on("keydown",function(e){i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(e){o(this).off("keyup")}),this.$search.on("keyup input",function(e){i.handleSearch(e)}),t.on("open",function(){i.$search.attr("tabindex",0),i.$search.focus(),window.setTimeout(function(){i.$search.focus()},0)}),t.on("close",function(){i.$search.attr("tabindex",-1),i.$search.val("")}),t.on("focus",function(){t.isOpen()&&i.$search.focus()}),t.on("results:all",function(e){null!=e.query.term&&""!==e.query.term||(i.showSearch(e)?i.$searchContainer.removeClass("select2-search--hide"):i.$searchContainer.addClass("select2-search--hide"))})},t.prototype.handleSearch=function(e){if(!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=!1},t.prototype.showSearch=function(e,t){return!0},t}),e.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,n,i){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n,i)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.removePlaceholder=function(e,t){for(var n=t.slice(0),i=t.length-1;0<=i;i--){var o=t[i];this.placeholder.id===o.id&&n.splice(i,1)}return n},e}),e.define("select2/dropdown/infiniteScroll",["jquery"],function(o){function e(e,t,n,i){this.lastParams={},e.call(this,t,n,i),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return e.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&this.$results.append(this.$loadingMore)},e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("query",function(e){i.lastParams=e,i.loading=!0}),t.on("query:append",function(e){i.lastParams=e,i.loading=!0}),this.$results.on("scroll",function(){var e=o.contains(document.documentElement,i.$loadingMore[0]);if(!i.loading&&e){var t=i.$results.offset().top+i.$results.outerHeight(!1);i.$loadingMore.offset().top+i.$loadingMore.outerHeight(!1)<=t+50&&i.loadMore()}})},e.prototype.loadMore=function(){this.loading=!0;var e=o.extend({},{page:1},this.lastParams);e.page++,this.trigger("query:append",e)},e.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},e.prototype.createLoadingMore=function(){var e=o('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),t=this.options.get("translations").get("loadingMore");return e.html(t(this.lastParams)),e},e}),e.define("select2/dropdown/attachBody",["jquery","../utils"],function(f,a){function e(e,t,n){this.$dropdownParent=n.get("dropdownParent")||f(document.body),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){var i=this,o=!1;e.call(this,t,n),t.on("open",function(){i._showDropdown(),i._attachPositioningHandler(t),o||(o=!0,t.on("results:all",function(){i._positionDropdown(),i._resizeDropdown()}),t.on("results:append",function(){i._positionDropdown(),i._resizeDropdown()}))}),t.on("close",function(){i._hideDropdown(),i._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},e.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},e.prototype.position=function(e,t,n){t.attr("class",n.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=n},e.prototype.render=function(e){var t=f("<span></span>"),n=e.call(this);return t.append(n),this.$dropdownContainer=t},e.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()},e.prototype._attachPositioningHandler=function(e,t){var n=this,i="scroll.select2."+t.id,o="resize.select2."+t.id,r="orientationchange.select2."+t.id,s=this.$container.parents().filter(a.hasScroll);s.each(function(){f(this).data("select2-scroll-position",{x:f(this).scrollLeft(),y:f(this).scrollTop()})}),s.on(i,function(e){var t=f(this).data("select2-scroll-position");f(this).scrollTop(t.y)}),f(window).on(i+" "+o+" "+r,function(e){n._positionDropdown(),n._resizeDropdown()})},e.prototype._detachPositioningHandler=function(e,t){var n="scroll.select2."+t.id,i="resize.select2."+t.id,o="orientationchange.select2."+t.id;this.$container.parents().filter(a.hasScroll).off(n),f(window).off(n+" "+i+" "+o)},e.prototype._positionDropdown=function(){var e=f(window),t=this.$dropdown.hasClass("select2-dropdown--above"),n=this.$dropdown.hasClass("select2-dropdown--below"),i=null,o=this.$container.offset();o.bottom=o.top+this.$container.outerHeight(!1);var r={height:this.$container.outerHeight(!1)};r.top=o.top,r.bottom=o.top+r.height;var s=this.$dropdown.outerHeight(!1),a=e.scrollTop(),l=e.scrollTop()+e.height(),c=a<o.top-s,u=l>o.bottom+s,d={left:o.left,top:r.bottom},p=this.$dropdownParent;"static"===p.css("position")&&(p=p.offsetParent());var h=p.offset();d.top-=h.top,d.left-=h.left,t||n||(i="below"),u||!c||t?!c&&u&&t&&(i="below"):i="above",("above"==i||t&&"below"!==i)&&(d.top=r.top-h.top-s),null!=i&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+i),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+i)),this.$dropdownContainer.css(d)},e.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},e.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},e}),e.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(e,t,n,i){this.minimumResultsForSearch=n.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),e.call(this,t,n,i)}return e.prototype.showSearch=function(e,t){return!(function e(t){for(var n=0,i=0;i<t.length;i++){var o=t[i];o.children?n+=e(o.children):n++}return n}(t.data.results)<this.minimumResultsForSearch)&&e.call(this,t)},e}),e.define("select2/dropdown/selectOnClose",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("close",function(e){i._handleSelectOnClose(e)})},e.prototype._handleSelectOnClose=function(e,t){if(t&&null!=t.originalSelect2Event){var n=t.originalSelect2Event;if("select"===n._type||"unselect"===n._type)return}var i=this.getHighlightedResults();if(!(i.length<1)){var o=i.data("data");null!=o.element&&o.element.selected||null==o.element&&o.selected||this.trigger("select",{data:o})}},e}),e.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("select",function(e){i._selectTriggered(e)}),t.on("unselect",function(e){i._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var n=t.originalEvent;n&&n.ctrlKey||this.trigger("close",{originalEvent:n,originalSelect2Event:t})},e}),e.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,n="Please delete "+t+" character";return 1!=t&&(n+="s"),n},inputTooShort:function(e){return"Please enter "+(e.minimum-e.input.length)+" or more characters"},loadingMore:function(){return"Loading more results"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching"}}}),e.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(f,g,m,v,y,_,w,$,b,x,A,t,C,S,O,E,D,T,q,j,L,k,P,I,M,R,z,H,e){function n(){this.reset()}return n.prototype.apply=function(t){if(null==(t=f.extend(!0,{},this.defaults,t)).dataAdapter){if(null!=t.ajax?t.dataAdapter=O:null!=t.data?t.dataAdapter=S:t.dataAdapter=C,0<t.minimumInputLength&&(t.dataAdapter=x.Decorate(t.dataAdapter,T)),0<t.maximumInputLength&&(t.dataAdapter=x.Decorate(t.dataAdapter,q)),0<t.maximumSelectionLength&&(t.dataAdapter=x.Decorate(t.dataAdapter,j)),t.tags&&(t.dataAdapter=x.Decorate(t.dataAdapter,E)),(null!=t.tokenSeparators||null!=t.tokenizer)&&(t.dataAdapter=x.Decorate(t.dataAdapter,D)),null!=t.query){var e=g(t.amdBase+"compat/query");t.dataAdapter=x.Decorate(t.dataAdapter,e)}if(null!=t.initSelection){var n=g(t.amdBase+"compat/initSelection");t.dataAdapter=x.Decorate(t.dataAdapter,n)}}if(null==t.resultsAdapter&&(t.resultsAdapter=m,null!=t.ajax&&(t.resultsAdapter=x.Decorate(t.resultsAdapter,I)),null!=t.placeholder&&(t.resultsAdapter=x.Decorate(t.resultsAdapter,P)),t.selectOnClose&&(t.resultsAdapter=x.Decorate(t.resultsAdapter,z))),null==t.dropdownAdapter){if(t.multiple)t.dropdownAdapter=L;else{var i=x.Decorate(L,k);t.dropdownAdapter=i}if(0!==t.minimumResultsForSearch&&(t.dropdownAdapter=x.Decorate(t.dropdownAdapter,R)),t.closeOnSelect&&(t.dropdownAdapter=x.Decorate(t.dropdownAdapter,H)),null!=t.dropdownCssClass||null!=t.dropdownCss||null!=t.adaptDropdownCssClass){var o=g(t.amdBase+"compat/dropdownCss");t.dropdownAdapter=x.Decorate(t.dropdownAdapter,o)}t.dropdownAdapter=x.Decorate(t.dropdownAdapter,M)}if(null==t.selectionAdapter){if(t.multiple?t.selectionAdapter=y:t.selectionAdapter=v,null!=t.placeholder&&(t.selectionAdapter=x.Decorate(t.selectionAdapter,_)),t.allowClear&&(t.selectionAdapter=x.Decorate(t.selectionAdapter,w)),t.multiple&&(t.selectionAdapter=x.Decorate(t.selectionAdapter,$)),null!=t.containerCssClass||null!=t.containerCss||null!=t.adaptContainerCssClass){var r=g(t.amdBase+"compat/containerCss");t.selectionAdapter=x.Decorate(t.selectionAdapter,r)}t.selectionAdapter=x.Decorate(t.selectionAdapter,b)}if("string"==typeof t.language)if(0<t.language.indexOf("-")){var s=t.language.split("-")[0];t.language=[t.language,s]}else t.language=[t.language];if(f.isArray(t.language)){var a=new A;t.language.push("en");for(var l=t.language,c=0;c<l.length;c++){var u=l[c],d={};try{d=A.loadPath(u)}catch(e){try{u=this.defaults.amdLanguageBase+u,d=A.loadPath(u)}catch(e){t.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+u+'" could not be automatically loaded. A fallback will be used instead.');continue}}a.extend(d)}t.translations=a}else{var p=A.loadPath(this.defaults.amdLanguageBase+"en"),h=new A(t.language);h.extend(p),t.translations=h}return t},n.prototype.reset=function(){function a(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return t[e]||e})}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:x.escapeMarkup,language:e,matcher:function e(t,n){if(""===f.trim(t.term))return n;if(n.children&&0<n.children.length){for(var i=f.extend(!0,{},n),o=n.children.length-1;0<=o;o--)null==e(t,n.children[o])&&i.children.splice(o,1);return 0<i.children.length?i:e(t,i)}var r=a(n.text).toUpperCase(),s=a(t.term).toUpperCase();return-1<r.indexOf(s)?n:null},minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},n.prototype.set=function(e,t){var n={};n[f.camelCase(e)]=t;var i=x._convertData(n);f.extend(this.defaults,i)},new n}),e.define("select2/options",["require","jquery","./defaults","./utils"],function(i,r,o,s){function e(e,t){if(this.options=e,null!=t&&this.fromElement(t),this.options=o.apply(this.options),t&&t.is("input")){var n=i(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=s.Decorate(this.options.dataAdapter,n)}}return e.prototype.fromElement=function(e){var t=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.language&&(e.prop("lang")?this.options.language=e.prop("lang").toLowerCase():e.closest("[lang]").prop("lang")&&(this.options.language=e.closest("[lang]").prop("lang"))),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),e.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),e.data("data",e.data("select2Tags")),e.data("tags",!0)),e.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",e.data("ajaxUrl")),e.data("ajax--url",e.data("ajaxUrl")));var n;n=r.fn.jquery&&"1."==r.fn.jquery.substr(0,2)&&e[0].dataset?r.extend(!0,{},e[0].dataset,e.data()):e.data();var i=r.extend(!0,{},n);for(var o in i=s._convertData(i))-1<r.inArray(o,t)||(r.isPlainObject(this.options[o])?r.extend(this.options[o],i[o]):this.options[o]=i[o]);return this},e.prototype.get=function(e){return this.options[e]},e.prototype.set=function(e,t){this.options[e]=t},e}),e.define("select2/core",["jquery","./options","./utils","./keys"],function(o,c,n,i){var u=function(e,t){null!=e.data("select2")&&e.data("select2").destroy(),this.$element=e,this.id=this._generateId(e),t=t||{},this.options=new c(t,e),u.__super__.constructor.call(this);var n=e.attr("tabindex")||0;e.data("old-tabindex",n),e.attr("tabindex","-1");var i=this.options.get("dataAdapter");this.dataAdapter=new i(e,this.options);var o=this.render();this._placeContainer(o);var r=this.options.get("selectionAdapter");this.selection=new r(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,o);var s=this.options.get("dropdownAdapter");this.dropdown=new s(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,o);var a=this.options.get("resultsAdapter");this.results=new a(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var l=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){l.trigger("selection:update",{data:e})}),e.addClass("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),e.data("select2",this)};return n.Extend(u,n.Observable),u.prototype._generateId=function(e){return"select2-"+(null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+n.generateChars(2):n.generateChars(4)).replace(/(:|\.|\[|\]|,)/g,"")},u.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},u.prototype._resolveWidth=function(e,t){var n=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var i=this._resolveWidth(e,"style");return null!=i?i:this._resolveWidth(e,"element")}if("element"==t){var o=e.outerWidth(!1);return o<=0?"auto":o+"px"}if("style"!=t)return t;var r=e.attr("style");if("string"!=typeof r)return null;for(var s=r.split(";"),a=0,l=s.length;a<l;a+=1){var c=s[a].replace(/\s/g,"").match(n);if(null!==c&&1<=c.length)return c[1]}return null},u.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},u.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this.$element.on("focus.select2",function(e){t.trigger("focus",e)}),this._syncA=n.bind(this._syncAttributes,this),this._syncS=n.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=e?(this._observer=new e(function(e){o.each(e,t._syncA),o.each(e,t._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",t._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",t._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",t._syncS,!1))},u.prototype._registerDataEvents=function(){var n=this;this.dataAdapter.on("*",function(e,t){n.trigger(e,t)})},u.prototype._registerSelectionEvents=function(){var n=this,i=["toggle","focus"];this.selection.on("toggle",function(){n.toggleDropdown()}),this.selection.on("focus",function(e){n.focus(e)}),this.selection.on("*",function(e,t){-1===o.inArray(e,i)&&n.trigger(e,t)})},u.prototype._registerDropdownEvents=function(){var n=this;this.dropdown.on("*",function(e,t){n.trigger(e,t)})},u.prototype._registerResultsEvents=function(){var n=this;this.results.on("*",function(e,t){n.trigger(e,t)})},u.prototype._registerEvents=function(){var n=this;this.on("open",function(){n.$container.addClass("select2-container--open")}),this.on("close",function(){n.$container.removeClass("select2-container--open")}),this.on("enable",function(){n.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){n.$container.addClass("select2-container--disabled")}),this.on("blur",function(){n.$container.removeClass("select2-container--focus")}),this.on("query",function(t){n.isOpen()||n.trigger("open",{}),this.dataAdapter.query(t,function(e){n.trigger("results:all",{data:e,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(e){n.trigger("results:append",{data:e,query:t})})}),this.on("keypress",function(e){var t=e.which;t===i.ENTER&&(e.ctrlKey||e.metaKey)&&(n.close()||MapSVG.formBuilder.save()),t!==i.ESC||n.isOpen()||n.close()||MapSVG.formBuilder.close(),n.isOpen()?t===i.ESC||t===i.TAB||t===i.UP&&e.altKey?(n.close(),e.preventDefault()):t!==i.ENTER||e.ctrlKey||e.metaKey?t===i.SPACE&&e.ctrlKey?(n.trigger("results:toggle",{}),e.preventDefault()):t===i.UP?(n.trigger("results:previous",{}),e.preventDefault()):t===i.DOWN&&(n.trigger("results:next",{}),e.preventDefault()):(n.trigger("results:select",{}),e.preventDefault()):(t===(i.ENTER&&!e.ctrlKey&&!e.metaKey)||t===i.SPACE||t===i.DOWN&&e.altKey)&&(n.open(),e.preventDefault())})},u.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},u.prototype._syncSubtree=function(e,t){var n=!1,i=this;if(!e||!e.target||"OPTION"===e.target.nodeName||"OPTGROUP"===e.target.nodeName){if(t)if(t.addedNodes&&0<t.addedNodes.length)for(var o=0;o<t.addedNodes.length;o++){t.addedNodes[o].selected&&(n=!0)}else t.removedNodes&&0<t.removedNodes.length&&(n=!0);else n=!0;n&&this.dataAdapter.current(function(e){i.trigger("selection:update",{data:e})})}},u.prototype.trigger=function(e,t){var n=u.__super__.trigger,i={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(void 0===t&&(t={}),e in i){var o=i[e],r={prevented:!1,name:e,args:t};if(n.call(this,o,r),r.prevented)return void(t.prevented=!0)}n.call(this,e,t)},u.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},u.prototype.open=function(){this.isOpen()||this.trigger("query",{})},u.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},u.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},u.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},u.prototype.focus=function(e){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},u.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),(null==e||0===e.length)&&(e=[!0]);var t=!e[0];this.$element.prop("disabled",t)},u.prototype.data=function(){this.options.get("debug")&&0<arguments.length&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var t=[];return this.dataAdapter.current(function(e){t=e}),t},u.prototype.val=function(e){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==e||0===e.length)return this.$element.val();var t=e[0];o.isArray(t)&&(t=o.map(t,function(e){return e.toString()})),this.$element.val(t).trigger("change")},u.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},u.prototype.render=function(){var e=o('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return e.attr("dir",this.options.get("dir")),this.$container=e,this.$container.addClass("select2-container--"+this.options.get("theme")),e.data("element",this.$element),e},u}),e.define("select2/compat/utils",["jquery"],function(s){return{syncCssClasses:function(e,t,n){var i,o,r=[];(i=s.trim(e.attr("class")))&&s((i=""+i).split(/\s+/)).each(function(){0===this.indexOf("select2-")&&r.push(this)}),(i=s.trim(t.attr("class")))&&s((i=""+i).split(/\s+/)).each(function(){0!==this.indexOf("select2-")&&null!=(o=n(this))&&r.push(o)}),e.attr("class",r.join(" "))}}}),e.define("select2/compat/containerCss",["jquery","./utils"],function(s,a){function l(e){return null}function e(){}return e.prototype.render=function(e){var t=e.call(this),n=this.options.get("containerCssClass")||"";s.isFunction(n)&&(n=n(this.$element));var i=this.options.get("adaptContainerCssClass");if(i=i||l,-1!==n.indexOf(":all:")){n=n.replace(":all:","");var o=i;i=function(e){var t=o(e);return null!=t?t+" "+e:e}}var r=this.options.get("containerCss")||{};return s.isFunction(r)&&(r=r(this.$element)),a.syncCssClasses(t,this.$element,i),t.css(r),t.addClass(n),t},e}),e.define("select2/compat/dropdownCss",["jquery","./utils"],function(s,a){function l(e){return null}function e(){}return e.prototype.render=function(e){var t=e.call(this),n=this.options.get("dropdownCssClass")||"";s.isFunction(n)&&(n=n(this.$element));var i=this.options.get("adaptDropdownCssClass");if(i=i||l,-1!==n.indexOf(":all:")){n=n.replace(":all:","");var o=i;i=function(e){var t=o(e);return null!=t?t+" "+e:e}}var r=this.options.get("dropdownCss")||{};return s.isFunction(r)&&(r=r(this.$element)),a.syncCssClasses(t,this.$element,i),t.css(r),t.addClass(n),t},e}),e.define("select2/compat/initSelection",["jquery"],function(i){function e(e,t,n){n.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `initSelection` option has been deprecated in favor of a custom data adapter that overrides the `current` method. This method is now called multiple times instead of a single time when the instance is initialized. Support will be removed for the `initSelection` option in future versions of Select2"),this.initSelection=n.get("initSelection"),this._isInitialized=!1,e.call(this,t,n)}return e.prototype.current=function(e,t){var n=this;return this._isInitialized?void e.call(this,t):void this.initSelection.call(null,this.$element,function(e){n._isInitialized=!0,i.isArray(e)||(e=[e]),t(e)})},e}),e.define("select2/compat/inputData",["jquery"],function(s){function e(e,t,n){this._currentData=[],this._valueSeparator=n.get("valueSeparator")||",","hidden"===t.prop("type")&&n.get("debug")&&console&&console.warn&&console.warn("Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead."),e.call(this,t,n)}return e.prototype.current=function(e,t){function i(e,t){var n=[];return e.selected||-1!==s.inArray(e.id,t)?(e.selected=!0,n.push(e)):e.selected=!1,e.children&&n.push.apply(n,i(e.children,t)),n}for(var n=[],o=0;o<this._currentData.length;o++){var r=this._currentData[o];n.push.apply(n,i(r,this.$element.val().split(this._valueSeparator)))}t(n)},e.prototype.select=function(e,t){if(this.options.get("multiple")){var n=this.$element.val();n+=this._valueSeparator+t.id,this.$element.val(n),this.$element.trigger("change")}else this.current(function(e){s.map(e,function(e){e.selected=!1})}),this.$element.val(t.id),this.$element.trigger("change")},e.prototype.unselect=function(e,o){var r=this;o.selected=!1,this.current(function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];o.id!=i.id&&t.push(i.id)}r.$element.val(t.join(r._valueSeparator)),r.$element.trigger("change")})},e.prototype.query=function(e,t,n){for(var i=[],o=0;o<this._currentData.length;o++){var r=this._currentData[o],s=this.matches(t,r);null!==s&&i.push(s)}n({results:i})},e.prototype.addOptions=function(e,t){var n=s.map(t,function(e){return s.data(e[0],"data")});this._currentData.push.apply(this._currentData,n)},e}),e.define("select2/compat/matcher",["jquery"],function(s){return function(r){return function(e,t){var n=s.extend(!0,{},t);if(null==e.term||""===s.trim(e.term))return n;if(t.children){for(var i=t.children.length-1;0<=i;i--){var o=t.children[i];r(e.term,o.text,o)||n.children.splice(i,1)}if(0<n.children.length)return n}return r(e.term,t.text,t)?n:null}}}),e.define("select2/compat/query",[],function(){function e(e,t,n){n.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `query` option has been deprecated in favor of a custom data adapter that overrides the `query` method. Support will be removed for the `query` option in future versions of Select2."),e.call(this,t,n)}return e.prototype.query=function(e,t,n){t.callback=n,this.options.get("query").call(null,t)},e}),e.define("select2/dropdown/attachContainer",[],function(){function e(e,t,n){e.call(this,t,n)}return e.prototype.position=function(e,t,n){n.find(".dropdown-wrapper").append(t),t.addClass("select2-dropdown--below"),n.addClass("select2-container--below")},e}),e.define("select2/dropdown/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,n){e.call(this,t,n);this.$dropdown.on(["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"].join(" "),function(e){e.stopPropagation()})},e}),e.define("select2/selection/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,n){e.call(this,t,n);this.$selection.on(["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"].join(" "),function(e){e.stopPropagation()})},e}),t=function(p){function t(e){var t=e||window.event,n=v.call(arguments,1),i=0,o=0,r=0,s=0,a=0,l=0;if((e=p.event.fix(t)).type="mousewheel","detail"in t&&(r=-1*t.detail),"wheelDelta"in t&&(r=t.wheelDelta),"wheelDeltaY"in t&&(r=t.wheelDeltaY),"wheelDeltaX"in t&&(o=-1*t.wheelDeltaX),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(o=-1*r,r=0),i=0===r?o:r,"deltaY"in t&&(i=r=-1*t.deltaY),"deltaX"in t&&(o=t.deltaX,0===r&&(i=-1*o)),0!==r||0!==o){if(1===t.deltaMode){var c=p.data(this,"mousewheel-line-height");i*=c,r*=c,o*=c}else if(2===t.deltaMode){var u=p.data(this,"mousewheel-page-height");i*=u,r*=u,o*=u}if(s=Math.max(Math.abs(r),Math.abs(o)),(!m||s<m)&&(f(t,m=s)&&(m/=40)),f(t,s)&&(i/=40,o/=40,r/=40),i=Math[1<=i?"floor":"ceil"](i/m),o=Math[1<=o?"floor":"ceil"](o/m),r=Math[1<=r?"floor":"ceil"](r/m),y.settings.normalizeOffset&&this.getBoundingClientRect){var d=this.getBoundingClientRect();a=e.clientX-d.left,l=e.clientY-d.top}return e.deltaX=o,e.deltaY=r,e.deltaFactor=m,e.offsetX=a,e.offsetY=l,e.deltaMode=0,n.unshift(e,i,o,r),g&&clearTimeout(g),g=setTimeout(h,200),(p.event.dispatch||p.event.handle).apply(this,n)}}function h(){m=null}function f(e,t){return y.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}var g,m,e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],n="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],v=Array.prototype.slice;if(p.event.fixHooks)for(var i=e.length;i;)p.event.fixHooks[e[--i]]=p.event.mouseHooks;var y=p.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t;p.data(this,"mousewheel-line-height",y.getLineHeight(this)),p.data(this,"mousewheel-page-height",y.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null;p.removeData(this,"mousewheel-line-height"),p.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var t=p(e),n=t["offsetParent"in p.fn?"offsetParent":"parent"]();return n.length||(n=p("body")),parseInt(n.css("fontSize"),10)||parseInt(t.css("fontSize"),10)||16},getPageHeight:function(e){return p(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};p.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})},"function"==typeof e.define&&e.define.amd?e.define("jquery-mousewheel",["jquery"],t):"object"==typeof exports?module.exports=t:t(n),e.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(o,e,r,t){if(null==o.fn.mselect2){var s=["open","close","destroy"];o.fn.mselect2=function(t){if("object"==typeof(t=t||{}))return this.each(function(){var e=o.extend(!0,{},t);new r(o(this),e)}),this;if("string"!=typeof t)throw new Error("Invalid arguments for Select2: "+t);var n,i=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=o(this).data("select2");null==e&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2."),n=e[t].apply(e,i)}),-1<o.inArray(t,s)?this:n}}return null==o.fn.mselect2.defaults&&(o.fn.mselect2.defaults=t),r}),{define:e.define,require:e.require}}(),t=e.require("jquery.select2");return n.fn.mselect2.amd=e,t});